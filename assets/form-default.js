/*! For license information please see form-default.js.LICENSE.txt */
var Sr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function td(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function rd(e){if(Object.prototype.hasOwnProperty.call(e,"__esModule"))return e;var t=e.default;if("function"==typeof t){var n=function e(){var n=!1;try{n=this instanceof e}catch{}return n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach(function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})}),n}var Qa,bi={},Ur={};function nd(){if(Qa)return Ur;Qa=1,Ur.byteLength=function(e){var t=s(e),n=t[0],r=t[1];return 3*(n+r)/4-r},Ur.toByteArray=function(e){var r,i,o=s(e),a=o[0],l=o[1],c=new n(function(e,t,n){return 3*(t+n)/4-n}(0,a,l)),u=0,d=l>0?a-4:a;for(i=0;i<d;i+=4)r=t[e.charCodeAt(i)]<<18|t[e.charCodeAt(i+1)]<<12|t[e.charCodeAt(i+2)]<<6|t[e.charCodeAt(i+3)],c[u++]=r>>16&255,c[u++]=r>>8&255,c[u++]=255&r;return 2===l&&(r=t[e.charCodeAt(i)]<<2|t[e.charCodeAt(i+1)]>>4,c[u++]=255&r),1===l&&(r=t[e.charCodeAt(i)]<<10|t[e.charCodeAt(i+1)]<<4|t[e.charCodeAt(i+2)]>>2,c[u++]=r>>8&255,c[u++]=255&r),c},Ur.fromByteArray=function(t){for(var n,r=t.length,i=r%3,s=[],o=16383,l=0,c=r-i;l<c;l+=o)s.push(a(t,l,l+o>c?c:l+o));return 1===i?(n=t[r-1],s.push(e[n>>2]+e[n<<4&63]+"==")):2===i&&(n=(t[r-2]<<8)+t[r-1],s.push(e[n>>10]+e[n>>4&63]+e[n<<2&63]+"=")),s.join("")};for(var e=[],t=[],n=typeof Uint8Array<"u"?Uint8Array:Array,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",i=0;i<64;++i)e[i]=r[i],t[r.charCodeAt(i)]=i;function s(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function o(t){return e[t>>18&63]+e[t>>12&63]+e[t>>6&63]+e[63&t]}function a(e,t,n){for(var r,i=[],s=t;s<n;s+=3)r=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),i.push(o(r));return i.join("")}return t[45]=62,t[95]=63,Ur}var Xa,Ja,jn={};function id(){return Xa||(Xa=1,jn.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,l=(1<<a)-1,c=l>>1,u=-7,d=n?i-1:0,h=n?-1:1,p=e[t+d];for(d+=h,s=p&(1<<-u)-1,p>>=-u,u+=a;u>0;s=256*s+e[t+d],d+=h,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=r;u>0;o=256*o+e[t+d],d+=h,u-=8);if(0===s)s=1-c;else{if(s===l)return o?NaN:1/0*(p?-1:1);o+=Math.pow(2,r),s-=c}return(p?-1:1)*o*Math.pow(2,s-r)},jn.write=function(e,t,n,r,i,s){var o,a,l,c=8*s-i-1,u=(1<<c)-1,d=u>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:s-1,f=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=u):(o=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-o))<1&&(o--,l*=2),(t+=o+d>=1?h/l:h*Math.pow(2,1-d))*l>=2&&(o++,l/=2),o+d>=u?(a=0,o=u):o+d>=1?(a=(t*l-1)*Math.pow(2,i),o+=d):(a=t*Math.pow(2,d-1)*Math.pow(2,i),o=0));i>=8;e[n+p]=255&a,p+=f,a/=256,i-=8);for(o=o<<i|a,c+=i;c>0;e[n+p]=255&o,p+=f,o/=256,c-=8);e[n+p-f]|=128*g}),jn}function Ct(){return Ja||(Ja=1,function(e){const t=nd(),n=id(),r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=o,e.SlowBuffer=function(e){return+e!=e&&(e=0),o.alloc(+e)},e.INSPECT_MAX_BYTES=50;const i=2147483647;function s(e){if(e>i)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,o.prototype),t}function o(e,t,n){if("number"==typeof e){if("string"==typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return c(e)}return a(e,t,n)}function a(e,t,n){if("string"==typeof e)return function(e,t){if(("string"!=typeof t||""===t)&&(t="utf8"),!o.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|p(e,t);let r=s(n);const i=r.write(e,t);return i!==n&&(r=r.slice(0,i)),r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(z(e,Uint8Array)){const t=new Uint8Array(e);return d(t.buffer,t.byteOffset,t.byteLength)}return u(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(z(e,ArrayBuffer)||e&&z(e.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(z(e,SharedArrayBuffer)||e&&z(e.buffer,SharedArrayBuffer)))return d(e,t,n);if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return o.from(r,t,n);const i=function(e){if(o.isBuffer(e)){const t=0|h(e.length),n=s(t);return 0===n.length||e.copy(n,0,0,t),n}return void 0!==e.length?"number"!=typeof e.length||J(e.length)?s(0):u(e):"Buffer"===e.type&&Array.isArray(e.data)?u(e.data):void 0}(e);if(i)return i;if(typeof Symbol<"u"&&null!=Symbol.toPrimitive&&"function"==typeof e[Symbol.toPrimitive])return o.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!=typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function c(e){return l(e),s(e<0?0:0|h(e))}function u(e){const t=e.length<0?0:0|h(e.length),n=s(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function d(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,o.prototype),r}function h(e){if(e>=i)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+i.toString(16)+" bytes");return 0|e}function p(e,t){if(o.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||z(e,ArrayBuffer))return e.byteLength;if("string"!=typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return V(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return W(e).length;default:if(i)return r?-1:V(e).length;t=(""+t).toLowerCase(),i=!0}}function f(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length||((void 0===n||n>this.length)&&(n=this.length),n<=0)||(n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return N(this,t,n);case"utf8":case"utf-8":return E(this,t,n);case"ascii":return j(this,t,n);case"latin1":case"binary":return T(this,t,n);case"base64":return S(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return k(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function g(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function m(e,t,n,r,i){if(0===e.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),J(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"==typeof t&&(t=o.from(t,r)),o.isBuffer(t))return 0===t.length?-1:b(e,t,n,r,i);if("number"==typeof t)return t&=255,"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):b(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function b(e,t,n,r,i){let s,o=1,a=e.length,l=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,l/=2,n/=2}function c(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let r=-1;for(s=n;s<a;s++)if(c(e,s)===c(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===l)return r*o}else-1!==r&&(s-=s-r),r=-1}else for(n+l>a&&(n=a-l),s=n;s>=0;s--){let n=!0;for(let r=0;r<l;r++)if(c(e,s+r)!==c(t,r)){n=!1;break}if(n)return s}return-1}function y(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const s=t.length;let o;for(r>s/2&&(r=s/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(J(r))return o;e[n+o]=r}return o}function v(e,t,n,r){return G(V(t,e.length-n),e,n,r)}function w(e,t,n,r){return G(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function _(e,t,n,r){return G(W(t),e,n,r)}function x(e,t,n,r){return G(function(e,t){let n,r,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function S(e,n,r){return 0===n&&r===e.length?t.fromByteArray(e):t.fromByteArray(e.slice(n,r))}function E(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,r,a,l;switch(o){case 1:t<128&&(s=t);break;case 2:n=e[i+1],128==(192&n)&&(l=(31&t)<<6|63&n,l>127&&(s=l));break;case 3:n=e[i+1],r=e[i+2],128==(192&n)&&128==(192&r)&&(l=(15&t)<<12|(63&n)<<6|63&r,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(l=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,l>65535&&l<1114112&&(s=l))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=o}return function(e){const t=e.length;if(t<=I)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=I));return n}(r)}e.kMaxLength=i,o.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch{return!1}}(),!o.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&"function"==typeof console.error&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(o.prototype,"parent",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.buffer}}),Object.defineProperty(o.prototype,"offset",{enumerable:!0,get:function(){if(o.isBuffer(this))return this.byteOffset}}),o.poolSize=8192,o.from=function(e,t,n){return a(e,t,n)},Object.setPrototypeOf(o.prototype,Uint8Array.prototype),Object.setPrototypeOf(o,Uint8Array),o.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?s(e):void 0!==t?"string"==typeof n?s(e).fill(t,n):s(e).fill(t):s(e)}(e,t,n)},o.allocUnsafe=function(e){return c(e)},o.allocUnsafeSlow=function(e){return c(e)},o.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==o.prototype},o.compare=function(e,t){if(z(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),z(t,Uint8Array)&&(t=o.from(t,t.offset,t.byteLength)),!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=o.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(z(t,Uint8Array))i+t.length>r.length?(o.isBuffer(t)||(t=o.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!o.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},o.byteLength=p,o.prototype._isBuffer=!0,o.prototype.swap16=function(){const e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)g(this,t,t+1);return this},o.prototype.swap32=function(){const e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)g(this,t,t+3),g(this,t+1,t+2);return this},o.prototype.swap64=function(){const e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)g(this,t,t+7),g(this,t+1,t+6),g(this,t+2,t+5),g(this,t+3,t+4);return this},o.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?E(this,0,e):f.apply(this,arguments)},o.prototype.toLocaleString=o.prototype.toString,o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){let t="";const n=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(t+=" ... "),"<Buffer "+t+">"},r&&(o.prototype[r]=o.prototype.inspect),o.prototype.compare=function(e,t,n,r,i){if(z(e,Uint8Array)&&(e=o.from(e,e.offset,e.byteLength)),!o.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0);const l=Math.min(s,a),c=this.slice(r,i),u=e.slice(t,n);for(let e=0;e<l;++e)if(c[e]!==u[e]){s=c[e],a=u[e];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},o.prototype.indexOf=function(e,t,n){return m(this,e,t,n,!0)},o.prototype.lastIndexOf=function(e,t,n){return m(this,e,t,n,!1)},o.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"==typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return y(this,e,t,n);case"utf8":case"utf-8":return v(this,e,t,n);case"ascii":case"latin1":case"binary":return w(this,e,t,n);case"base64":return _(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const I=4096;function j(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function T(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function N(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let r=t;r<n;++r)i+=Q[e[r]];return i}function k(e,t,n){const r=e.slice(t,n);let i="";for(let e=0;e<r.length-1;e+=2)i+=String.fromCharCode(r[e]+256*r[e+1]);return i}function R(e,t,n){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function C(e,t,n,r,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function A(e,t,n,r,i){B(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function O(e,t,n,r,i){B(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function L(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function $(e,t,r,i,s){return t=+t,r>>>=0,s||L(e,0,r,4),n.write(e,t,r,i,23,4),r+4}function D(e,t,r,i,s){return t=+t,r>>>=0,s||L(e,0,r,8),n.write(e,t,r,i,52,8),r+8}o.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,o.prototype),r},o.prototype.readUintLE=o.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},o.prototype.readUintBE=o.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},o.prototype.readUint8=o.prototype.readUInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),this[e]},o.prototype.readUint16LE=o.prototype.readUInt16LE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUint16BE=o.prototype.readUInt16BE=function(e,t){return e>>>=0,t||R(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUint32LE=o.prototype.readUInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUint32BE=o.prototype.readUInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readBigUInt64LE=X(function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];(void 0===t||void 0===n)&&q(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))}),o.prototype.readBigUInt64BE=X(function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];(void 0===t||void 0===n)&&q(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)}),o.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},o.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||R(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},o.prototype.readInt8=function(e,t){return e>>>=0,t||R(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){e>>>=0,t||R(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt16BE=function(e,t){e>>>=0,t||R(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},o.prototype.readInt32LE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return e>>>=0,t||R(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readBigInt64LE=X(function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];(void 0===t||void 0===n)&&q(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)}),o.prototype.readBigInt64BE=X(function(e){U(e>>>=0,"offset");const t=this[e],n=this[e+7];(void 0===t||void 0===n)&&q(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)}),o.prototype.readFloatLE=function(e,t){return e>>>=0,t||R(e,4,this.length),n.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return e>>>=0,t||R(e,4,this.length),n.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return e>>>=0,t||R(e,8,this.length),n.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return e>>>=0,t||R(e,8,this.length),n.read(this,e,!1,52,8)},o.prototype.writeUintLE=o.prototype.writeUIntLE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||C(this,e,t,n,Math.pow(2,8*n)-1,0);let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},o.prototype.writeUintBE=o.prototype.writeUIntBE=function(e,t,n,r){e=+e,t>>>=0,n>>>=0,r||C(this,e,t,n,Math.pow(2,8*n)-1,0);let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},o.prototype.writeUint8=o.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,1,255,0),this[t]=255&e,t+1},o.prototype.writeUint16LE=o.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeUint16BE=o.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeUint32LE=o.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},o.prototype.writeUint32BE=o.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigUInt64LE=X(function(e,t=0){return A(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeBigUInt64BE=X(function(e,t=0){return O(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))}),o.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);C(this,e,t,n,r-1,-r)}let i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);C(this,e,t,n,r-1,-r)}let i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s|0)-o&255;return t+n},o.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},o.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},o.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},o.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||C(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},o.prototype.writeBigInt64LE=X(function(e,t=0){return A(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeBigInt64BE=X(function(e,t=0){return O(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),o.prototype.writeFloatLE=function(e,t,n){return $(this,e,t,!0,n)},o.prototype.writeFloatBE=function(e,t,n){return $(this,e,t,!1,n)},o.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},o.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},o.prototype.copy=function(e,t,n,r){if(!o.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!r&&0!==r&&(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n||0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},o.prototype.fill=function(e,t,n,r){if("string"==typeof e){if("string"==typeof t?(r=t,t=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!o.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"==typeof e?e&=255:"boolean"==typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"==typeof e)for(i=t;i<n;++i)this[i]=e;else{const s=o.isBuffer(e)?e:o.from(e,r),a=s.length;if(0===a)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%a]}return this};const P={};function M(e,t,n){P[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function F(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function B(e,t,n,r,i,s){if(e>n||e<t){const n="bigint"==typeof t?"n":"";let r;throw r=0===t||t===BigInt(0)?`>= 0${n} and < 2${n} ** ${8*(s+1)}${n}`:`>= -(2${n} ** ${8*(s+1)-1}${n}) and < 2 ** ${8*(s+1)-1}${n}`,new P.ERR_OUT_OF_RANGE("value",r,e)}!function(e,t,n){U(t,"offset"),(void 0===e[t]||void 0===e[t+n])&&q(t,e.length-(n+1))}(r,i,s)}function U(e,t){if("number"!=typeof e)throw new P.ERR_INVALID_ARG_TYPE(t,"number",e)}function q(e,t,n){throw Math.floor(e)!==e?(U(e,n),new P.ERR_OUT_OF_RANGE("offset","an integer",e)):t<0?new P.ERR_BUFFER_OUT_OF_BOUNDS:new P.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${t}`,e)}M("ERR_BUFFER_OUT_OF_BOUNDS",function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),M("ERR_INVALID_ARG_TYPE",function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`},TypeError),M("ERR_OUT_OF_RANGE",function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=F(String(n)):"bigint"==typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=F(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r},RangeError);const H=/[^+/0-9A-Za-z-_]/g;function V(e,t){let n;t=t||1/0;const r=e.length;let i=null;const s=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function W(e){return t.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(H,"")).length<2)return"";for(;e.length%4!=0;)e+="=";return e}(e))}function G(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function z(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function J(e){return e!=e}const Q=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function X(e){return typeof BigInt>"u"?K:e}function K(){throw new Error("BigInt not supported")}}(bi)),bi}var sd=Ct();const Hr="http://www.w3.org/1999/02/22-rdf-syntax-ns#",Vr="http://www.w3.org/2001/XMLSchema#",$n="http://www.w3.org/2000/10/swap/",Ke={xsd:{decimal:`${Vr}decimal`,boolean:`${Vr}boolean`,double:`${Vr}double`,integer:`${Vr}integer`,string:`${Vr}string`},rdf:{type:`${Hr}type`,nil:`${Hr}nil`,first:`${Hr}first`,rest:`${Hr}rest`,langString:`${Hr}langString`},owl:{sameAs:"http://www.w3.org/2002/07/owl#sameAs"},r:{forSome:`${$n}reify#forSome`,forAll:`${$n}reify#forAll`},log:{implies:`${$n}log#implies`,isImpliedBy:`${$n}log#isImpliedBy`}},{xsd:Fn}=Ke,ad=/\\u([a-fA-F0-9]{4})|\\U([a-fA-F0-9]{8})|\\([^])/g,Ka={"\\":"\\","'":"'",'"':'"',n:"\n",r:"\r",t:"\t",f:"\f",b:"\b",_:"_","~":"~",".":".","-":"-","!":"!",$:"$","&":"&","(":"(",")":")","*":"*","+":"+",",":",",";":";","=":"=","/":"/","?":"?","#":"#","@":"@","%":"%"},od=/[\x00-\x20<>\\"\{\}\|\^\`]/,ld={_iri:!0,_unescapedIri:!0,_simpleQuotedString:!0,_langcode:!0,_blank:!0,_newline:!0,_comment:!0,_whitespace:!0,_endOfFile:!0},ud=/$0^/;class cd{constructor(e){if(this._iri=/^<((?:[^ <>{}\\]|\\[uU])+)>[ \t]*/,this._unescapedIri=/^<([^\x00-\x20<>\\"\{\}\|\^\`]*)>[ \t]*/,this._simpleQuotedString=/^"([^"\\\r\n]*)"(?=[^"])/,this._simpleApostropheString=/^'([^'\\\r\n]*)'(?=[^'])/,this._langcode=/^@([a-z]+(?:-[a-z0-9]+)*)(?=[^a-z0-9\-])/i,this._prefix=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:(?=[#\s<])/,this._prefixed=/^((?:[A-Za-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)?:((?:(?:[0-:A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])(?:(?:[\.\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~])*(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff]|%[0-9a-fA-F]{2}|\\[!#-\/;=?\-@_~]))?)?)(?:[ \t]+|(?=\.?[,;!\^\s#()\[\]\{\}"'<>]))/,this._variable=/^\?(?:(?:[A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:[\-0-:A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?=[.,;!\^\s#()\[\]\{\}"'<>])/,this._blank=/^_:((?:[0-9A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-\u02ff\u0370-\u037d\u037f-\u1fff\u200c\u200d\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])(?:\.?[\-0-9A-Z_a-z\xb7\xc0-\xd6\xd8-\xf6\xf8-\u037d\u037f-\u1fff\u200c\u200d\u203f\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]|[\ud800-\udb7f][\udc00-\udfff])*)(?:[ \t]+|(?=\.?[,;:\s#()\[\]\{\}"'<>]))/,this._number=/^[\-+]?(?:(\d+\.\d*|\.?\d+)[eE][\-+]?|\d*(\.)?)\d+(?=\.?[,;:\s#()\[\]\{\}"'<>])/,this._boolean=/^(?:true|false)(?=[.,;\s#()\[\]\{\}"'<>])/,this._keyword=/^@[a-z]+(?=[\s#<:])/i,this._sparqlKeyword=/^(?:PREFIX|BASE|GRAPH)(?=[\s#<])/i,this._shortPredicates=/^a(?=[\s#()\[\]\{\}"'<>])/,this._newline=/^[ \t]*(?:#[^\n\r]*)?(?:\r\n|\n|\r)[ \t]*/,this._comment=/#([^\n\r]*)/,this._whitespace=/^[ \t]+/,this._endOfFile=/^(?:#[^\n\r]*)?$/,e=e||{},this._isImpliedBy=e.isImpliedBy,this._lineMode=!!e.lineMode){this._n3Mode=!1;for(const e in this)!(e in ld)&&this[e]instanceof RegExp&&(this[e]=ud)}else this._n3Mode=!1!==e.n3;this.comments=!!e.comments,this._literalClosingPos=0}_tokenizeToEnd(e,t){let n=this._input,r=n.length;for(;;){let e,o;for(;e=this._newline.exec(n);)this.comments&&(o=this._comment.exec(e[0]))&&i("comment",o[1],"",this._line,e[0].length),n=n.substr(e[0].length,n.length),r=n.length,this._line++;if(!e&&(e=this._whitespace.exec(n))&&(n=n.substr(e[0].length,n.length)),this._endOfFile.test(n))return t&&(this.comments&&(o=this._comment.exec(n))&&i("comment",o[1],"",this._line,n.length),n=null,i("eof","","",this._line,0)),this._input=n;const a=this._line,l=n[0];let c="",u="",d="",h=null,p=0,f=!1;switch(l){case"^":if(n.length<3)break;if("^"!==n[1]){this._n3Mode&&(p=1,c="^");break}if(this._previousMarker="^^",n=n.substr(2),"<"!==n[0]){f=!0;break}case"<":if(h=this._unescapedIri.exec(n))c="IRI",u=h[1];else if(h=this._iri.exec(n)){if(u=this._unescape(h[1]),null===u||od.test(u))return s(this);c="IRI"}else n.length>1&&"<"===n[1]?(c="<<",p=2):this._n3Mode&&n.length>1&&"="===n[1]&&(p=2,this._isImpliedBy?(c="abbreviation",u="<"):(c="inverse",u=">"));break;case">":n.length>1&&">"===n[1]&&(c=">>",p=2);break;case"_":((h=this._blank.exec(n))||t&&(h=this._blank.exec(`${n} `)))&&(c="blank",d="_",u=h[1]);break;case'"':if(h=this._simpleQuotedString.exec(n))u=h[1];else if(({value:u,matchLength:p}=this._parseLiteral(n)),null===u)return s(this);(null!==h||0!==p)&&(c="literal",this._literalClosingPos=0);break;case"'":if(!this._lineMode){if(h=this._simpleApostropheString.exec(n))u=h[1];else if(({value:u,matchLength:p}=this._parseLiteral(n)),null===u)return s(this);(null!==h||0!==p)&&(c="literal",this._literalClosingPos=0)}break;case"?":this._n3Mode&&(h=this._variable.exec(n))&&(c="var",u=h[0]);break;case"@":"literal"===this._previousMarker&&(h=this._langcode.exec(n))?(c="langcode",u=h[1]):(h=this._keyword.exec(n))&&(c=h[0]);break;case".":if(1===n.length?t:n[1]<"0"||n[1]>"9"){c=".",p=1;break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"+":case"-":(h=this._number.exec(n)||t&&(h=this._number.exec(`${n} `)))&&(c="literal",u=h[0],d="string"==typeof h[1]?Fn.double:"string"==typeof h[2]?Fn.decimal:Fn.integer);break;case"B":case"b":case"p":case"P":case"G":case"g":(h=this._sparqlKeyword.exec(n))?c=h[0].toUpperCase():f=!0;break;case"f":case"t":(h=this._boolean.exec(n))?(c="literal",u=h[0],d=Fn.boolean):f=!0;break;case"a":(h=this._shortPredicates.exec(n))?(c="abbreviation",u="a"):f=!0;break;case"=":this._n3Mode&&n.length>1&&(c="abbreviation",">"!==n[1]?(p=1,u="="):(p=2,u=">"));break;case"!":if(!this._n3Mode)break;case",":case";":case"[":case"]":case"(":case")":case"}":this._lineMode||(p=1,c=l);break;case"{":!this._lineMode&&n.length>=2&&("|"===n[1]?(c="{|",p=2):(c=l,p=1));break;case"|":n.length>=2&&"}"===n[1]&&(c="|}",p=2);break;default:f=!0}if(f&&("@prefix"!==this._previousMarker&&"PREFIX"!==this._previousMarker||!(h=this._prefix.exec(n))?((h=this._prefixed.exec(n))||t&&(h=this._prefixed.exec(`${n} `)))&&(c="prefixed",d=h[1]||"",u=this._unescape(h[2])):(c="prefix",u=h[1]||"")),"^^"===this._previousMarker)switch(c){case"prefixed":c="type";break;case"IRI":c="typeIRI";break;default:c=""}if(!c)return t||!/^'''|^"""/.test(n)&&/\n|\r/.test(n)?s(this):this._input=n;const g=p||h[0].length,m=i(c,u,d,a,g);this.previousToken=m,this._previousMarker=c,n=n.substr(g,n.length)}function i(t,i,s,o,a){const l=n?r-n.length:r,c={type:t,value:i,prefix:s,line:o,start:l,end:l+a};return e(null,c),c}function s(t){e(t._syntaxError(/^\S*/.exec(n)[0]))}}_unescape(e){let t=!1;const n=e.replace(ad,(e,n,r,i)=>{if("string"==typeof n)return String.fromCharCode(Number.parseInt(n,16));if("string"==typeof r){let e=Number.parseInt(r,16);return e<=65535?String.fromCharCode(Number.parseInt(r,16)):String.fromCharCode(55296+((e-=65536)>>10),56320+(1023&e))}return i in Ka?Ka[i]:(t=!0,"")});return t?null:n}_parseLiteral(e){if(e.length>=3){const t=e.match(/^(?:"""|"|'''|'|)/)[0],n=t.length;let r=Math.max(this._literalClosingPos,n);for(;(r=e.indexOf(t,r))>0;){let t=0;for(;"\\"===e[r-t-1];)t++;if(t%2==0){const t=e.substring(n,r),i=t.split(/\r\n|\r|\n/).length-1,s=r+n;if(1===n&&0!==i||3===n&&this._lineMode)break;return this._line+=i,{value:this._unescape(t),matchLength:s}}r++}this._literalClosingPos=e.length-n+1}return{value:"",matchLength:0}}_syntaxError(e){this._input=null;const t=new Error(`Unexpected "${e}" on line ${this._line}.`);return t.context={token:void 0,line:this._line,previousToken:this.previousToken},t}_readStartingBom(e){return e.startsWith("\ufeff")?e.substr(1):e}tokenize(e,t){if(this._line=1,"string"==typeof e){if(this._input=this._readStartingBom(e),"function"!=typeof t){const e=[];let t;if(this._tokenizeToEnd((n,r)=>n?t=n:e.push(r),!0),t)throw t;return e}queueMicrotask(()=>this._tokenizeToEnd(t,!0))}else this._pendingBuffer=null,"function"==typeof e.setEncoding&&e.setEncoding("utf8"),e.on("data",e=>{null!==this._input&&0!==e.length&&(this._pendingBuffer&&(e=sd.Buffer.concat([this._pendingBuffer,e]),this._pendingBuffer=null),128&e[e.length-1]?this._pendingBuffer=e:(typeof this._input>"u"?this._input=this._readStartingBom("string"==typeof e?e:e.toString()):this._input+=e,this._tokenizeToEnd(t,!1)))}),e.on("end",()=>{"string"==typeof this._input&&this._tokenizeToEnd(t,!0)}),e.on("error",t)}}const{rdf:dd,xsd:ar}=Ke;let Cr,hd=0;const Ne={namedNode:Wu,blankNode:zu,variable:Xu,literal:Qu,defaultGraph:md,quad:na,triple:na,fromTerm:hn,fromQuad:Ju};class wt{constructor(e){this.id=e}get value(){return this.id}equals(e){return e instanceof wt?this.id===e.id:!!e&&this.termType===e.termType&&this.value===e.value}hashCode(){return 0}toJSON(){return{termType:this.termType,value:this.value}}}let vn=class extends wt{get termType(){return"NamedNode"}},ct=class e extends wt{get termType(){return"Literal"}get value(){return this.id.substring(1,this.id.lastIndexOf('"'))}get language(){const e=this.id;let t=e.lastIndexOf('"')+1;return t<e.length&&"@"===e[t++]?e.substr(t).toLowerCase():""}get datatype(){return new vn(this.datatypeString)}get datatypeString(){const e=this.id,t=e.lastIndexOf('"')+1,n=t<e.length?e[t]:"";return"^"===n?e.substr(t+2):"@"!==n?ar.string:dd.langString}equals(t){return t instanceof e?this.id===t.id:!!t&&!!t.datatype&&this.termType===t.termType&&this.value===t.value&&this.language===t.language&&this.datatype.value===t.datatype.value}toJSON(){return{termType:this.termType,value:this.value,language:this.language,datatype:{termType:"NamedNode",value:this.datatypeString}}}},fd=class extends wt{constructor(e){super(`_:${e}`)}get termType(){return"BlankNode"}get value(){return this.id.substr(2)}},pd=class extends wt{constructor(e){super(`?${e}`)}get termType(){return"Variable"}get value(){return this.id.substr(1)}},gd=class extends wt{constructor(){return super(""),Cr||this}get termType(){return"DefaultGraph"}equals(e){return this===e||!!e&&this.termType===e.termType}};function dn(e,t,n){if(t=t||Ne,!e)return t.defaultGraph();switch(e[0]){case"?":return t.variable(e.substr(1));case"_":return t.blankNode(e.substr(2));case'"':if(t===Ne)return new ct(e);if('"'===e[e.length-1])return t.literal(e.substr(1,e.length-2));const r=e.lastIndexOf('"',e.length-1);return t.literal(e.substr(1,r-1),"@"===e[r+1]?e.substr(r+2):t.namedNode(e.substr(r+3)));case"[":e=JSON.parse(e);break;default:if(!n||!Array.isArray(e))return t.namedNode(e)}return t.quad(dn(e[0],t,!0),dn(e[1],t,!0),dn(e[2],t,!0),e[3]&&dn(e[3],t,!0))}function Ir(e,t){if("string"==typeof e)return e;if(e instanceof wt&&"Quad"!==e.termType)return e.id;if(!e)return Cr.id;switch(e.termType){case"NamedNode":return e.value;case"BlankNode":return`_:${e.value}`;case"Variable":return`?${e.value}`;case"DefaultGraph":return"";case"Literal":return`"${e.value}"${e.language?`@${e.language}`:e.datatype&&e.datatype.value!==ar.string?`^^${e.datatype.value}`:""}`;case"Quad":const n=[Ir(e.subject,!0),Ir(e.predicate,!0),Ir(e.object,!0)];return e.graph&&"DefaultGraph"!==e.graph.termType&&n.push(Ir(e.graph,!0)),t?n:JSON.stringify(n);default:throw new Error(`Unexpected termType: ${e.termType}`)}}Cr=new gd;let si=class extends wt{constructor(e,t,n,r){super(""),this._subject=e,this._predicate=t,this._object=n,this._graph=r||Cr}get termType(){return"Quad"}get subject(){return this._subject}get predicate(){return this._predicate}get object(){return this._object}get graph(){return this._graph}toJSON(){return{termType:this.termType,subject:this._subject.toJSON(),predicate:this._predicate.toJSON(),object:this._object.toJSON(),graph:this._graph.toJSON()}}equals(e){return!!e&&this._subject.equals(e.subject)&&this._predicate.equals(e.predicate)&&this._object.equals(e.object)&&this._graph.equals(e.graph)}};function Wu(e){return new vn(e)}function zu(e){return new fd(e||"n3-"+hd++)}function Qu(e,t){if("string"==typeof t)return new ct(`"${e}"@${t.toLowerCase()}`);let n=t?t.value:"";return""===n&&("boolean"==typeof e?n=ar.boolean:"number"==typeof e&&(Number.isFinite(e)?n=Number.isInteger(e)?ar.integer:ar.double:(n=ar.double,Number.isNaN(e)||(e=e>0?"INF":"-INF")))),""===n||n===ar.string?new ct(`"${e}"`):new ct(`"${e}"^^${n}`)}function Xu(e){return new pd(e)}function md(){return Cr}function na(e,t,n,r){return new si(e,t,n,r)}function hn(e){if(e instanceof wt)return e;switch(e.termType){case"NamedNode":return Wu(e.value);case"BlankNode":return zu(e.value);case"Variable":return Xu(e.value);case"DefaultGraph":return Cr;case"Literal":return Qu(e.value,e.language||e.datatype);case"Quad":return Ju(e);default:throw new Error(`Unexpected termType: ${e.termType}`)}}function Ju(e){if(e instanceof si)return e;if("Quad"!==e.termType)throw new Error(`Unexpected termType: ${e.termType}`);return na(hn(e.subject),hn(e.predicate),hn(e.object),hn(e.graph))}let Ya=0;class Ku{constructor(e){this._contextStack=[],this._graph=null,e=e||{},this._setBase(e.baseIRI),e.factory&&Yu(this,e.factory);const t="string"==typeof e.format?e.format.match(/\w*$/)[0].toLowerCase():"",n=/turtle/.test(t),r=/trig/.test(t),i=/triple/.test(t),s=/quad/.test(t),o=this._n3Mode=/n3/.test(t),a=i||s;(this._supportsNamedGraphs=!(n||o))||(this._readPredicateOrNamedGraph=this._readPredicate),this._supportsQuads=!(n||r||i||o),this._isImpliedBy=e.isImpliedBy,this._supportsRDFStar=""===t||/star|\*$/.test(t),a&&(this._resolveRelativeIRI=e=>null),this._blankNodePrefix="string"!=typeof e.blankNodePrefix?"":e.blankNodePrefix.replace(/^(?!_:)/,"_:"),this._lexer=e.lexer||new cd({lineMode:a,n3:o,isImpliedBy:this._isImpliedBy}),this._explicitQuantifiers=!!e.explicitQuantifiers}static _resetBlankNodePrefix(){Ya=0}_setBase(e){if(e){const t=e.indexOf("#");t>=0&&(e=e.substr(0,t)),this._base=e,this._basePath=e.indexOf("/")<0?e:e.replace(/[^\/?]*(?:\?.*)?$/,""),e=e.match(/^(?:([a-z][a-z0-9+.-]*:))?(?:\/\/[^\/]*)?/i),this._baseRoot=e[0],this._baseScheme=e[1]}else this._base="",this._basePath=""}_saveContext(e,t,n,r,i){const s=this._n3Mode;this._contextStack.push({type:e,subject:n,predicate:r,object:i,graph:t,inverse:!!s&&this._inversePredicate,blankPrefix:s?this._prefixes._:"",quantified:s?this._quantified:null}),s&&(this._inversePredicate=!1,this._prefixes._=this._graph?`${this._graph.value}.`:".",this._quantified=Object.create(this._quantified))}_restoreContext(e,t){const n=this._contextStack.pop();if(!n||n.type!==e)return this._error(`Unexpected ${t.type}`,t);this._subject=n.subject,this._predicate=n.predicate,this._object=n.object,this._graph=n.graph,this._n3Mode&&(this._inversePredicate=n.inverse,this._prefixes._=n.blankPrefix,this._quantified=n.quantified)}_readInTopContext(e){switch(e.type){case"eof":return null!==this._graph?this._error("Unclosed graph",e):(delete this._prefixes._,this._callback(null,null,this._prefixes));case"PREFIX":this._sparqlStyle=!0;case"@prefix":return this._readPrefix;case"BASE":this._sparqlStyle=!0;case"@base":return this._readBaseIRI;case"{":if(this._supportsNamedGraphs)return this._graph="",this._subject=null,this._readSubject;case"GRAPH":if(this._supportsNamedGraphs)return this._readNamedGraphLabel;default:return this._readSubject(e)}}_readEntity(e,t){let n;switch(e.type){case"IRI":case"typeIRI":const t=this._resolveIRI(e.value);if(null===t)return this._error("Invalid IRI",e);n=this._factory.namedNode(t);break;case"type":case"prefixed":const r=this._prefixes[e.prefix];if(void 0===r)return this._error(`Undefined prefix "${e.prefix}:"`,e);n=this._factory.namedNode(r+e.value);break;case"blank":n=this._factory.blankNode(this._prefixes[e.prefix]+e.value);break;case"var":n=this._factory.variable(e.value.substr(1));break;default:return this._error(`Expected entity but got ${e.type}`,e)}return!t&&this._n3Mode&&n.id in this._quantified&&(n=this._quantified[n.id]),n}_readSubject(e){switch(this._predicate=null,e.type){case"[":return this._saveContext("blank",this._graph,this._subject=this._factory.blankNode(),null,null),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this.RDF_NIL,null,null),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._graph=this._factory.blankNode(),null,null),this._readSubject):this._error("Unexpected graph",e);case"}":return this._readPunctuation(e);case"@forSome":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORSOME,this._quantifier="blankNode",this._readQuantifierList):this._error('Unexpected "@forSome"',e);case"@forAll":return this._n3Mode?(this._subject=null,this._predicate=this.N3_FORALL,this._quantifier="variable",this._readQuantifierList):this._error('Unexpected "@forAll"',e);case"literal":if(!this._n3Mode)return this._error("Unexpected literal",e);if(0===e.prefix.length)return this._literalValue=e.value,this._completeSubjectLiteral;this._subject=this._factory.literal(e.value,this._factory.namedNode(e.prefix));break;case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,null,null,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if(void 0===(this._subject=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._readPredicateOrNamedGraph)}return this._readPredicateOrNamedGraph}_readPredicate(e){const t=e.type;switch(t){case"inverse":this._inversePredicate=!0;case"abbreviation":this._predicate=this.ABBREVIATIONS[e.value];break;case".":case"]":case"}":return null===this._predicate?this._error(`Unexpected ${t}`,e):(this._subject=null,"]"===t?this._readBlankNodeTail(e):this._readPunctuation(e));case";":return null!==this._predicate?this._readPredicate:this._error("Expected predicate but got ;",e);case"[":if(this._n3Mode)return this._saveContext("blank",this._graph,this._subject,this._subject=this._factory.blankNode(),null),this._readBlankNodeHead;case"blank":if(!this._n3Mode)return this._error("Disallowed blank node as predicate",e);default:if(void 0===(this._predicate=this._readEntity(e)))return}return this._readObject}_readObject(e){switch(e.type){case"literal":if(0===e.prefix.length)return this._literalValue=e.value,this._readDataTypeOrLang;this._object=this._factory.literal(e.value,this._factory.namedNode(e.prefix));break;case"[":return this._saveContext("blank",this._graph,this._subject,this._predicate,this._subject=this._factory.blankNode()),this._readBlankNodeHead;case"(":return this._saveContext("list",this._graph,this._subject,this._predicate,this.RDF_NIL),this._subject=null,this._readListItem;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",e);case"<<":return this._supportsRDFStar?(this._saveContext("<<",this._graph,this._subject,this._predicate,null),this._graph=null,this._readSubject):this._error("Unexpected RDF-star syntax",e);default:if(void 0===(this._object=this._readEntity(e)))return;if(this._n3Mode)return this._getPathReader(this._getContextEndReader())}return this._getContextEndReader()}_readPredicateOrNamedGraph(e){return"{"===e.type?this._readGraph(e):this._readPredicate(e)}_readGraph(e){return"{"!==e.type?this._error(`Expected graph but got ${e.type}`,e):(this._graph=this._subject,this._subject=null,this._readSubject)}_readBlankNodeHead(e){return"]"===e.type?(this._subject=null,this._readBlankNodeTail(e)):(this._predicate=null,this._readPredicate(e))}_readBlankNodeTail(e){if("]"!==e.type)return this._readBlankNodePunctuation(e);null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph);const t=null===this._predicate;return this._restoreContext("blank",e),null!==this._object?this._getContextEndReader():null!==this._predicate?this._readObject:t?this._readPredicateOrNamedGraph:this._readPredicateAfterBlank}_readPredicateAfterBlank(e){switch(e.type){case".":case"}":return this._subject=null,this._readPunctuation(e);default:return this._readPredicate(e)}}_readListItem(e){let t=null,n=null,r=this._readListItem;const i=this._subject,s=this._contextStack,o=s[s.length-1];switch(e.type){case"[":this._saveContext("blank",this._graph,n=this._factory.blankNode(),this.RDF_FIRST,this._subject=t=this._factory.blankNode()),r=this._readBlankNodeHead;break;case"(":this._saveContext("list",this._graph,n=this._factory.blankNode(),this.RDF_FIRST,this.RDF_NIL),this._subject=null;break;case")":if(this._restoreContext("list",e),0!==s.length&&"list"===s[s.length-1].type&&this._emit(this._subject,this._predicate,this._object,this._graph),null===this._predicate){if(r=this._readPredicate,this._subject===this.RDF_NIL)return r}else if(r=this._getContextEndReader(),this._object===this.RDF_NIL)return r;n=this.RDF_NIL;break;case"literal":0===e.prefix.length?(this._literalValue=e.value,r=this._readListItemDataTypeOrLang):(t=this._factory.literal(e.value,this._factory.namedNode(e.prefix)),r=this._getContextEndReader());break;case"{":return this._n3Mode?(this._saveContext("formula",this._graph,this._subject,this._predicate,this._graph=this._factory.blankNode()),this._readSubject):this._error("Unexpected graph",e);default:if(void 0===(t=this._readEntity(e)))return}if(null===n&&(this._subject=n=this._factory.blankNode()),null===i?null===o.predicate?o.subject=n:o.object=n:this._emit(i,this.RDF_REST,n,this._graph),null!==t){if(this._n3Mode&&("IRI"===e.type||"prefixed"===e.type))return this._saveContext("item",this._graph,n,this.RDF_FIRST,t),this._subject=t,this._predicate=null,this._getPathReader(this._readListItem);this._emit(n,this.RDF_FIRST,t,this._graph)}return r}_readDataTypeOrLang(e){return this._completeObjectLiteral(e,!1)}_readListItemDataTypeOrLang(e){return this._completeObjectLiteral(e,!0)}_completeLiteral(e){let t=this._factory.literal(this._literalValue);switch(e.type){case"type":case"typeIRI":const n=this._readEntity(e);if(void 0===n)return;t=this._factory.literal(this._literalValue,n),e=null;break;case"langcode":t=this._factory.literal(this._literalValue,e.value),e=null}return{token:e,literal:t}}_completeSubjectLiteral(e){return this._subject=this._completeLiteral(e).literal,this._readPredicateOrNamedGraph}_completeObjectLiteral(e,t){const n=this._completeLiteral(e);if(n)return this._object=n.literal,t&&this._emit(this._subject,this.RDF_FIRST,this._object,this._graph),null===n.token?this._getContextEndReader():(this._readCallback=this._getContextEndReader(),this._readCallback(n.token))}_readFormulaTail(e){return"}"!==e.type?this._readPunctuation(e):(null!==this._subject&&this._emit(this._subject,this._predicate,this._object,this._graph),this._restoreContext("formula",e),null===this._object?this._readPredicate:this._getContextEndReader())}_readPunctuation(e){let t,n=this._graph;const r=this._subject,i=this._inversePredicate;switch(e.type){case"}":if(null===this._graph)return this._error("Unexpected graph closing",e);if(this._n3Mode)return this._readFormulaTail(e);this._graph=null;case".":this._subject=null,t=this._contextStack.length?this._readSubject:this._readInTopContext,i&&(this._inversePredicate=!1);break;case";":t=this._readPredicate;break;case",":t=this._readObject;break;case"{|":if(!this._supportsRDFStar)return this._error("Unexpected RDF-star syntax",e);const s=this._predicate,o=this._object;this._subject=this._factory.quad(r,s,o,this.DEFAULTGRAPH),t=this._readPredicate;break;case"|}":if("Quad"!==this._subject.termType)return this._error("Unexpected asserted triple closing",e);this._subject=null,t=this._readPunctuation;break;default:if(this._supportsQuads&&null===this._graph&&void 0!==(n=this._readEntity(e))){t=this._readQuadPunctuation;break}return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}if(null!==r){const e=this._predicate,t=this._object;i?this._emit(t,e,r,n):this._emit(r,e,t,n)}return t}_readBlankNodePunctuation(e){let t;switch(e.type){case";":t=this._readPredicate;break;case",":t=this._readObject;break;default:return this._error(`Expected punctuation to follow "${this._object.id}"`,e)}return this._emit(this._subject,this._predicate,this._object,this._graph),t}_readQuadPunctuation(e){return"."!==e.type?this._error("Expected dot to follow quad",e):this._readInTopContext}_readPrefix(e){return"prefix"!==e.type?this._error("Expected prefix to follow @prefix",e):(this._prefix=e.value,this._readPrefixIRI)}_readPrefixIRI(e){if("IRI"!==e.type)return this._error(`Expected IRI to follow prefix "${this._prefix}:"`,e);const t=this._readEntity(e);return this._prefixes[this._prefix]=t.value,this._prefixCallback(this._prefix,t),this._readDeclarationPunctuation}_readBaseIRI(e){const t="IRI"===e.type&&this._resolveIRI(e.value);return t?(this._setBase(t),this._readDeclarationPunctuation):this._error("Expected valid IRI to follow base declaration",e)}_readNamedGraphLabel(e){switch(e.type){case"IRI":case"blank":case"prefixed":return this._readSubject(e),this._readGraph;case"[":return this._readNamedGraphBlankLabel;default:return this._error("Invalid graph label",e)}}_readNamedGraphBlankLabel(e){return"]"!==e.type?this._error("Invalid graph label",e):(this._subject=this._factory.blankNode(),this._readGraph)}_readDeclarationPunctuation(e){return this._sparqlStyle?(this._sparqlStyle=!1,this._readInTopContext(e)):"."!==e.type?this._error("Expected declaration to end with a dot",e):this._readInTopContext}_readQuantifierList(e){let t;switch(e.type){case"IRI":case"prefixed":if(void 0!==(t=this._readEntity(e,!0)))break;default:return this._error(`Unexpected ${e.type}`,e)}return this._explicitQuantifiers?(null===this._subject?this._emit(this._graph||this.DEFAULTGRAPH,this._predicate,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH):this._emit(this._subject,this.RDF_REST,this._subject=this._factory.blankNode(),this.QUANTIFIERS_GRAPH),this._emit(this._subject,this.RDF_FIRST,t,this.QUANTIFIERS_GRAPH)):this._quantified[t.id]=this._factory[this._quantifier](this._factory.blankNode().value),this._readQuantifierPunctuation}_readQuantifierPunctuation(e){return","===e.type?this._readQuantifierList:(this._explicitQuantifiers&&(this._emit(this._subject,this.RDF_REST,this.RDF_NIL,this.QUANTIFIERS_GRAPH),this._subject=null),this._readCallback=this._getContextEndReader(),this._readCallback(e))}_getPathReader(e){return this._afterPath=e,this._readPath}_readPath(e){switch(e.type){case"!":return this._readForwardPath;case"^":return this._readBackwardPath;default:const t=this._contextStack,n=t.length&&t[t.length-1];if(n&&"item"===n.type){const t=this._subject;this._restoreContext("item",e),this._emit(this._subject,this.RDF_FIRST,t,this._graph)}return this._afterPath(e)}}_readForwardPath(e){let t,n;const r=this._factory.blankNode();if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(t=this._subject,this._subject=r):(t=this._object,this._object=r),this._emit(t,n,r,this._graph),this._readPath}_readBackwardPath(e){const t=this._factory.blankNode();let n,r;if(void 0!==(n=this._readEntity(e)))return null===this._predicate?(r=this._subject,this._subject=t):(r=this._object,this._object=t),this._emit(t,n,r,this._graph),this._readPath}_readRDFStarTailOrGraph(e){return">>"!==e.type?this._supportsQuads&&null===this._graph&&void 0!==(this._graph=this._readEntity(e))?this._readRDFStarTail:this._error(`Expected >> to follow "${this._object.id}"`,e):this._readRDFStarTail(e)}_readRDFStarTail(e){if(">>"!==e.type)return this._error(`Expected >> but got ${e.type}`,e);const t=this._factory.quad(this._subject,this._predicate,this._object,this._graph||this.DEFAULTGRAPH);return this._restoreContext("<<",e),null===this._subject?(this._subject=t,this._readPredicate):(this._object=t,this._getContextEndReader())}_getContextEndReader(){const e=this._contextStack;if(!e.length)return this._readPunctuation;switch(e[e.length-1].type){case"blank":return this._readBlankNodeTail;case"list":return this._readListItem;case"formula":return this._readFormulaTail;case"<<":return this._readRDFStarTailOrGraph}}_emit(e,t,n,r){this._callback(null,this._factory.quad(e,t,n,r||this.DEFAULTGRAPH))}_error(e,t){const n=new Error(`${e} on line ${t.line}.`);n.context={token:t,line:t.line,previousToken:this._lexer.previousToken},this._callback(n),this._callback=kn}_resolveIRI(e){return/^[a-z][a-z0-9+.-]*:/i.test(e)?e:this._resolveRelativeIRI(e)}_resolveRelativeIRI(e){if(!e.length)return this._base;switch(e[0]){case"#":return this._base+e;case"?":return this._base.replace(/(?:\?.*)?$/,e);case"/":return("/"===e[1]?this._baseScheme:this._baseRoot)+this._removeDotSegments(e);default:return/^[^/:]*:/.test(e)?null:this._removeDotSegments(this._basePath+e)}}_removeDotSegments(e){if(!/(^|\/)\.\.?($|[/#?])/.test(e))return e;const t=e.length;let n="",r=-1,i=-1,s=0,o="/";for(;r<t;){switch(o){case":":if(i<0&&"/"===e[++r]&&"/"===e[++r])for(;(i=r+1)<t&&"/"!==e[i];)r=i;break;case"?":case"#":r=t;break;case"/":if("."===e[r+1])switch(o=e[1+ ++r],o){case"/":n+=e.substring(s,r-1),s=r+1;break;case void 0:case"?":case"#":return n+e.substring(s,r)+e.substr(r+1);case".":if(o=e[1+ ++r],void 0===o||"/"===o||"?"===o||"#"===o){if(n+=e.substring(s,r-2),(s=n.lastIndexOf("/"))>=i&&(n=n.substr(0,s)),"/"!==o)return`${n}/${e.substr(r+1)}`;s=r+1}}}o=e[++r]}return n+e.substring(s)}parse(e,t,n){let r,i,s;if(t&&(t.onQuad||t.onPrefix||t.onComment)?(r=t.onQuad,i=t.onPrefix,s=t.onComment):(r=t,i=n),this._readCallback=this._readInTopContext,this._sparqlStyle=!1,this._prefixes=Object.create(null),this._prefixes._=this._blankNodePrefix?this._blankNodePrefix.substr(2):`b${Ya++}_`,this._prefixCallback=i||kn,this._inversePredicate=!1,this._quantified=Object.create(null),!r){const t=[];let n;if(this._callback=(e,r)=>{e?n=e:r&&t.push(r)},this._lexer.tokenize(e).every(e=>this._readCallback=this._readCallback(e)),n)throw n;return t}let o=(e,t)=>{null!==e?(this._callback(e),this._callback=kn):this._readCallback&&(this._readCallback=this._readCallback(t))};s&&(this._lexer.comments=!0,o=(e,t)=>{null!==e?(this._callback(e),this._callback=kn):this._readCallback&&("comment"===t.type?s(t.value):this._readCallback=this._readCallback(t))}),this._callback=r,this._lexer.tokenize(e,o)}}function kn(){}function Yu(e,t){e._factory=t,e.DEFAULTGRAPH=t.defaultGraph(),e.RDF_FIRST=t.namedNode(Ke.rdf.first),e.RDF_REST=t.namedNode(Ke.rdf.rest),e.RDF_NIL=t.namedNode(Ke.rdf.nil),e.N3_FORALL=t.namedNode(Ke.r.forAll),e.N3_FORSOME=t.namedNode(Ke.r.forSome),e.ABBREVIATIONS={a:t.namedNode(Ke.rdf.type),"=":t.namedNode(Ke.owl.sameAs),">":t.namedNode(Ke.log.implies),"<":t.namedNode(Ke.log.isImpliedBy)},e.QUANTIFIERS_GRAPH=t.namedNode("urn:n3:quantifiers")}function ia(e){return!!e&&"DefaultGraph"===e.termType}function Gn(e){return e.replace(/[\]\/\(\)\*\+\?\.\\\$]/g,"\\$&")}Yu(Ku.prototype,Ne);const yd=/^:?[^:?#]*(?:[?#]|$)|^file:|^[^:]*:\/*[^?#]+?\/(?:\.\.?(?:\/|$)|\/)/i,bd=/^(?:(?:[^/?#]{3,}|\.?[^/?#.]\.?)(?:\/[^/?#]{3,}|\.?[^/?#.]\.?)*\/?)?(?:[?#]|$)/,Za="./",_d="../",_i="?",eo="#";class ga{constructor(e){this.base=e,this._baseLength=0,this._baseMatcher=null,this._pathReplacements=new Array(e.length+1)}static supports(e){return!yd.test(e)}_getBaseMatcher(){if(this._baseMatcher)return this._baseMatcher;if(!ga.supports(this.base))return this._baseMatcher=/.^/;const e=/^[^:]*:\/*/.exec(this.base)[0],t=["^",Gn(e)],n=[],r=[],i=/[^/?#]*([/?#])/y;let s,o=0,a=0,l=i.lastIndex=e.length;for(;!o&&!a&&(s=i.exec(this.base));)s[1]===eo?a=i.lastIndex-1:(t.push(Gn(s[0]),"(?:"),n.push(")?"),s[1]!==_i?r.push(l=i.lastIndex):(o=l=i.lastIndex,a=this.base.indexOf(eo,o),this._pathReplacements[o]=_i));for(let e=0;e<r.length;e++)this._pathReplacements[r[e]]=_d.repeat(r.length-e-1);return this._pathReplacements[r[r.length-1]]=Za,this._baseLength=a>0?a:this.base.length,t.push(Gn(this.base.substring(l,this._baseLength)),o?"(?:#|$)":"(?:[?#]|$)"),this._baseMatcher=new RegExp([...t,...n].join(""))}toRelative(e){const t=this._getBaseMatcher().exec(e);if(!t)return e;const n=t[0].length;if(n===this._baseLength&&n===e.length)return"";const r=this._pathReplacements[n];if(r){const t=e.substring(n);return r===_i||bd.test(t)?r===Za&&/^[^?#]/.test(t)?t:r+t:e}return e.substring(n-1)}}const Gr=Ne.defaultGraph(),{rdf:wd,xsd:wr}=Ke,to=/["\\\t\n\r\b\f\u0000-\u0019\ud800-\udbff]/,ro=/["\\\t\n\r\b\f\u0000-\u0019]|[\ud800-\udbff][\udc00-\udfff]/g,vd={"\\":"\\\\",'"':'\\"',"\t":"\\t","\n":"\\n","\r":"\\r","\b":"\\b","\f":"\\f"};class Wr extends wt{equals(e){return e===this}}class ma{constructor(e,t){if(this._prefixRegex=/$0^/,e&&"function"!=typeof e.write&&(t=e,e=null),t=t||{},this._lists=t.lists,e)this._outputStream=e,this._endStream=void 0===t.end||!!t.end;else{let e="";this._outputStream={write(t,n,r){e+=t,r&&r()},end:t=>{t&&t(null,e)}},this._endStream=!0}this._subject=null,/triple|quad/i.test(t.format)?(this._lineMode=!0,this._writeQuad=this._writeQuadLine):(this._lineMode=!1,this._graph=Gr,this._prefixIRIs=Object.create(null),t.prefixes&&this.addPrefixes(t.prefixes),t.baseIRI&&(this._baseIri=new ga(t.baseIRI)))}get _inDefaultGraph(){return Gr.equals(this._graph)}_write(e,t){this._outputStream.write(e,"utf8",t)}_writeQuad(e,t,n,r,i){try{r.equals(this._graph)||(this._write((null===this._subject?"":this._inDefaultGraph?".\n":"\n}\n")+(Gr.equals(r)?"":`${this._encodeIriOrBlank(r)} {\n`)),this._graph=r,this._subject=null),e.equals(this._subject)?t.equals(this._predicate)?this._write(`, ${this._encodeObject(n)}`,i):this._write(`;\n    ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,i):this._write(`${(null===this._subject?"":".\n")+this._encodeSubject(this._subject=e)} ${this._encodePredicate(this._predicate=t)} ${this._encodeObject(n)}`,i)}catch(e){i&&i(e)}}_writeQuadLine(e,t,n,r,i){delete this._prefixMatch,this._write(this.quadToString(e,t,n,r),i)}quadToString(e,t,n,r){return`${this._encodeSubject(e)} ${this._encodeIriOrBlank(t)} ${this._encodeObject(n)}${r&&r.value?` ${this._encodeIriOrBlank(r)} .\n`:" .\n"}`}quadsToString(e){let t="";for(const n of e)t+=this.quadToString(n.subject,n.predicate,n.object,n.graph);return t}_encodeSubject(e){return"Quad"===e.termType?this._encodeQuad(e):this._encodeIriOrBlank(e)}_encodeIriOrBlank(e){if("NamedNode"!==e.termType)return this._lists&&e.value in this._lists&&(e=this.list(this._lists[e.value])),"id"in e?e.id:`_:${e.value}`;let t=e.value;this._baseIri&&(t=this._baseIri.toRelative(t)),to.test(t)&&(t=t.replace(ro,no));const n=this._prefixRegex.exec(t);return n?n[1]?this._prefixIRIs[n[1]]+n[2]:t:`<${t}>`}_encodeLiteral(e){let t=e.value;if(to.test(t)&&(t=t.replace(ro,no)),e.language)return`"${t}"@${e.language}`;if(this._lineMode){if(e.datatype.value===wr.string)return`"${t}"`}else switch(e.datatype.value){case wr.string:return`"${t}"`;case wr.boolean:if("true"===t||"false"===t)return t;break;case wr.integer:if(/^[+-]?\d+$/.test(t))return t;break;case wr.decimal:if(/^[+-]?\d*\.\d+$/.test(t))return t;break;case wr.double:if(/^[+-]?(?:\d+\.\d*|\.?\d+)[eE][+-]?\d+$/.test(t))return t}return`"${t}"^^${this._encodeIriOrBlank(e.datatype)}`}_encodePredicate(e){return e.value===wd.type?"a":this._encodeIriOrBlank(e)}_encodeObject(e){switch(e.termType){case"Quad":return this._encodeQuad(e);case"Literal":return this._encodeLiteral(e);default:return this._encodeIriOrBlank(e)}}_encodeQuad({subject:e,predicate:t,object:n,graph:r}){return`<<${this._encodeSubject(e)} ${this._encodePredicate(t)} ${this._encodeObject(n)}${ia(r)?"":` ${this._encodeIriOrBlank(r)}`}>>`}_blockedWrite(){throw new Error("Cannot write because the writer has been closed.")}addQuad(e,t,n,r,i){void 0===n?this._writeQuad(e.subject,e.predicate,e.object,e.graph,t):"function"==typeof r?this._writeQuad(e,t,n,Gr,r):this._writeQuad(e,t,n,r||Gr,i)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}addPrefix(e,t,n){const r={};r[e]=t,this.addPrefixes(r,n)}addPrefixes(e,t){if(!this._prefixIRIs)return t&&t();let n=!1;for(let t in e){let r=e[t];"string"!=typeof r&&(r=r.value),n=!0,null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null,this._graph=""),this._prefixIRIs[r]=t+=":",this._write(`@prefix ${t} <${r}>.\n`)}if(n){let e="",t="";for(const n in this._prefixIRIs)e+=e?`|${n}`:n,t+=(t?"|":"")+this._prefixIRIs[n];e=Gn(e),this._prefixRegex=new RegExp(`^(?:${t})[^/]*$|^(${e})([_a-zA-Z0-9][\\-_a-zA-Z0-9]*)$`)}this._write(n?"\n":"",t)}blank(e,t){let n,r,i=e;switch(void 0===e?i=[]:e.termType?i=[{predicate:e,object:t}]:"length"in e||(i=[e]),r=i.length){case 0:return new Wr("[]");case 1:if(n=i[0],!(n.object instanceof Wr))return new Wr(`[ ${this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)} ]`);default:let t="[";for(let s=0;s<r;s++)n=i[s],n.predicate.equals(e)?t+=`, ${this._encodeObject(n.object)}`:(t+=`${(s?";\n  ":"\n  ")+this._encodePredicate(n.predicate)} ${this._encodeObject(n.object)}`,e=n.predicate);return new Wr(`${t}\n]`)}}list(e){const t=e&&e.length||0,n=new Array(t);for(let r=0;r<t;r++)n[r]=this._encodeObject(e[r]);return new Wr(`(${n.join(" ")})`)}end(e){null!==this._subject&&(this._write(this._inDefaultGraph?".\n":"\n}\n"),this._subject=null),this._write=this._blockedWrite;let t=e&&((n,r)=>{t=null,e(n,r)});if(this._endStream)try{return this._outputStream.end(t)}catch{}t&&t()}}function no(e){let t=vd[e];return void 0===t&&(1===e.length?(t=e.charCodeAt(0).toString(16),t="\\u0000".substr(0,6-t.length)+t):(t=(1024*(e.charCodeAt(0)-55296)+e.charCodeAt(1)+9216).toString(16),t="\\U00000000".substr(0,10-t.length)+t)),t}var xi,io,wi={exports:{}},vi={exports:{}};function Be(){if(io)return xi;io=1;class e extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError("Expected input to be an Array, got "+typeof e);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}\n`;super(t),this.name="AggregateError",this.errors=e}}return xi={AggregateError:e,ArrayIsArray:e=>Array.isArray(e),ArrayPrototypeIncludes:(e,t)=>e.includes(t),ArrayPrototypeIndexOf:(e,t)=>e.indexOf(t),ArrayPrototypeJoin:(e,t)=>e.join(t),ArrayPrototypeMap:(e,t)=>e.map(t),ArrayPrototypePop:(e,t)=>e.pop(t),ArrayPrototypePush:(e,t)=>e.push(t),ArrayPrototypeSlice:(e,t,n)=>e.slice(t,n),Error,FunctionPrototypeCall:(e,t,...n)=>e.call(t,...n),FunctionPrototypeSymbolHasInstance:(e,t)=>Function.prototype[Symbol.hasInstance].call(e,t),MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties:(e,t)=>Object.defineProperties(e,t),ObjectDefineProperty:(e,t,n)=>Object.defineProperty(e,t,n),ObjectGetOwnPropertyDescriptor:(e,t)=>Object.getOwnPropertyDescriptor(e,t),ObjectKeys:e=>Object.keys(e),ObjectSetPrototypeOf:(e,t)=>Object.setPrototypeOf(e,t),Promise,PromisePrototypeCatch:(e,t)=>e.catch(t),PromisePrototypeThen:(e,t,n)=>e.then(t,n),PromiseReject:e=>Promise.reject(e),PromiseResolve:e=>Promise.resolve(e),ReflectApply:Reflect.apply,RegExpPrototypeTest:(e,t)=>e.test(t),SafeSet:Set,String,StringPrototypeSlice:(e,t,n)=>e.slice(t,n),StringPrototypeToLowerCase:e=>e.toLowerCase(),StringPrototypeToUpperCase:e=>e.toUpperCase(),StringPrototypeTrim:e=>e.trim(),Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet:(e,t,n)=>e.set(t,n),Boolean,Uint8Array}}var Si,so,Ii,ao,Ei={exports:{}};function Zu(){return so||(so=1,Si={format:(e,...t)=>e.replace(/%([sdifj])/g,function(...[e,n]){const r=t.shift();return"f"===n?r.toFixed(6):"j"===n?JSON.stringify(r):"s"===n&&"object"==typeof r?`${r.constructor!==Object?r.constructor.name:""} {}`.trim():r.toString()}),inspect(e){switch(typeof e){case"string":if(e.includes("'")){if(!e.includes('"'))return`"${e}"`;if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),Si}function it(){if(ao)return Ii;ao=1;const{format:e,inspect:t}=Zu(),{AggregateError:n}=Be(),r=globalThis.AggregateError||n,i=Symbol("kIsNodeError"),s=["string","function","number","object","Function","Object","boolean","bigint","symbol"],o=/^([A-Z][a-z0-9]*)+$/,a={};function l(e,t){if(!e)throw new a.ERR_INTERNAL_ASSERTION(t)}function c(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function u(t,n,r){r||(r=Error);class s extends r{constructor(...r){super(function(t,n,r){if("function"==typeof n)return l(n.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n.length}).`),n(...r);const i=(n.match(/%[dfijoOs]/g)||[]).length;return l(i===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${i}).`),0===r.length?n:e(n,...r)}(t,n,r))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(s.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),s.prototype.code=t,s.prototype[i]=!0,a[t]=s}function d(e){const t="__node_internal_"+e.name;return Object.defineProperty(e,"name",{value:t}),e}class h extends Error{constructor(e="The operation was aborted",t=void 0){if(void 0!==t&&"object"!=typeof t)throw new a.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}}return u("ERR_ASSERTION","%s",Error),u("ERR_INVALID_ARG_TYPE",(e,n,r)=>{l("string"==typeof e,"'name' must be a string"),Array.isArray(n)||(n=[n]);let i="The ";e.endsWith(" argument")?i+=`${e} `:i+=`"${e}" ${e.includes(".")?"property":"argument"} `,i+="must be ";const a=[],c=[],u=[];for(const e of n)l("string"==typeof e,"All expected entries have to be of type string"),s.includes(e)?a.push(e.toLowerCase()):o.test(e)?c.push(e):(l("object"!==e,'The value "object" should be written as "Object"'),u.push(e));if(c.length>0){const e=a.indexOf("object");-1!==e&&(a.splice(a,e,1),c.push("Object"))}if(a.length>0){switch(a.length){case 1:i+=`of type ${a[0]}`;break;case 2:i+=`one of type ${a[0]} or ${a[1]}`;break;default:{const e=a.pop();i+=`one of type ${a.join(", ")}, or ${e}`}}(c.length>0||u.length>0)&&(i+=" or ")}if(c.length>0){switch(c.length){case 1:i+=`an instance of ${c[0]}`;break;case 2:i+=`an instance of ${c[0]} or ${c[1]}`;break;default:{const e=c.pop();i+=`an instance of ${c.join(", ")}, or ${e}`}}u.length>0&&(i+=" or ")}switch(u.length){case 0:break;case 1:u[0].toLowerCase()!==u[0]&&(i+="an "),i+=`${u[0]}`;break;case 2:i+=`one of ${u[0]} or ${u[1]}`;break;default:{const e=u.pop();i+=`one of ${u.join(", ")}, or ${e}`}}if(null==r)i+=`. Received ${r}`;else if("function"==typeof r&&r.name)i+=`. Received function ${r.name}`;else if("object"==typeof r){var d;null!==(d=r.constructor)&&void 0!==d&&d.name?i+=`. Received an instance of ${r.constructor.name}`:i+=`. Received ${t(r,{depth:-1})}`}else{let e=t(r,{colors:!1});e.length>25&&(e=`${e.slice(0,25)}...`),i+=`. Received type ${typeof r} (${e})`}return i},TypeError),u("ERR_INVALID_ARG_VALUE",(e,n,r="is invalid")=>{let i=t(n);return i.length>128&&(i=i.slice(0,128)+"..."),`The ${e.includes(".")?"property":"argument"} '${e}' ${r}. Received ${i}`},TypeError),u("ERR_INVALID_RETURN_VALUE",(e,t,n)=>{var r;return`Expected ${e} to be returned from the "${t}" function but got ${null!=n&&null!==(r=n.constructor)&&void 0!==r&&r.name?`instance of ${n.constructor.name}`:"type "+typeof n}.`},TypeError),u("ERR_MISSING_ARGS",(...e)=>{let t;l(e.length>0,"At least one arg needs to be specified");const n=e.length;switch(e=(Array.isArray(e)?e:[e]).map(e=>`"${e}"`).join(" or "),n){case 1:t+=`The ${e[0]} argument`;break;case 2:t+=`The ${e[0]} and ${e[1]} arguments`;break;default:{const n=e.pop();t+=`The ${e.join(", ")}, and ${n} arguments`}}return`${t} must be specified`},TypeError),u("ERR_OUT_OF_RANGE",(e,n,r)=>{let i;if(l(n,'Missing "range" argument'),Number.isInteger(r)&&Math.abs(r)>2**32)i=c(String(r));else if("bigint"==typeof r){i=String(r);const e=BigInt(2)**BigInt(32);(r>e||r<-e)&&(i=c(i)),i+="n"}else i=t(r);return`The value of "${e}" is out of range. It must be ${n}. Received ${i}`},RangeError),u("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),u("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),u("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),u("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),u("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),u("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),u("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),u("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),u("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),u("ERR_STREAM_WRITE_AFTER_END","write after end",Error),u("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),Ii={AbortError:h,aggregateTwoErrors:d(function(e,t){if(e&&t&&e!==t){if(Array.isArray(t.errors))return t.errors.push(e),t;const n=new r([t,e],t.message);return n.code=t.code,n}return e||t}),hideStackFrames:d,codes:a}}var oo,zr={exports:{}};function xn(){if(oo)return zr.exports;oo=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return zr.exports=e,zr.exports.AbortSignal=t,zr.exports.default=e,zr.exports}var lo,uo,Pn={exports:{}};function ai(){if(lo)return Pn.exports;lo=1;var e,t="object"==typeof Reflect?Reflect:null,n=t&&"function"==typeof t.apply?t.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)};e=t&&"function"==typeof t.ownKeys?t.ownKeys:Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function(e){return Object.getOwnPropertyNames(e)};var r=Number.isNaN||function(e){return e!=e};function i(){i.init.call(this)}Pn.exports=i,Pn.exports.once=function(e,t){return new Promise(function(n,r){function i(n){e.removeListener(t,s),r(n)}function s(){"function"==typeof e.removeListener&&e.removeListener("error",i),n([].slice.call(arguments))}f(e,t,s,{once:!0}),"error"!==t&&function(e,t){"function"==typeof e.on&&f(e,"error",t,{once:!0})}(e,i)})},i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var s=10;function o(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function a(e){return void 0===e._maxListeners?i.defaultMaxListeners:e._maxListeners}function l(e,t,n,r){var i,s,l;if(o(n),void 0===(s=e._events)?(s=e._events=Object.create(null),e._eventsCount=0):(void 0!==s.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),s=e._events),l=s[t]),void 0===l)l=s[t]=n,++e._eventsCount;else if("function"==typeof l?l=s[t]=r?[n,l]:[l,n]:r?l.unshift(n):l.push(n),(i=a(e))>0&&l.length>i&&!l.warned){l.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+l.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=l.length,function(e){console&&console.warn&&console.warn(e)}(c)}return e}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function u(e,t,n){var r={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=c.bind(r);return i.listener=n,r.wrapFn=i,i}function d(e,t,n){var r=e._events;if(void 0===r)return[];var i=r[t];return void 0===i?[]:"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):p(i,i.length)}function h(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function p(e,t){for(var n=new Array(t),r=0;r<t;++r)n[r]=e[r];return n}function f(e,t,n,r){if("function"==typeof e.on)r.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,function i(s){r.once&&e.removeEventListener(t,i),n(s)})}}return Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return s},set:function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");s=e}}),i.init=function(){(void 0===this._events||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||r(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},i.prototype.getMaxListeners=function(){return a(this)},i.prototype.emit=function(e){for(var t=[],r=1;r<arguments.length;r++)t.push(arguments[r]);var i="error"===e,s=this._events;if(void 0!==s)i=i&&void 0===s.error;else if(!i)return!1;if(i){var o;if(t.length>0&&(o=t[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[e];if(void 0===l)return!1;if("function"==typeof l)n(l,this,t);else{var c=l.length,u=p(l,c);for(r=0;r<c;++r)n(u[r],this,t)}return!0},i.prototype.addListener=function(e,t){return l(this,e,t,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(e,t){return l(this,e,t,!0)},i.prototype.once=function(e,t){return o(t),this.on(e,u(this,e,t)),this},i.prototype.prependOnceListener=function(e,t){return o(t),this.prependListener(e,u(this,e,t)),this},i.prototype.removeListener=function(e,t){var n,r,i,s,a;if(o(t),void 0===(r=this._events))return this;if(void 0===(n=r[e]))return this;if(n===t||n.listener===t)0===--this._eventsCount?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(i=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,i=s;break}if(i<0)return this;0===i?n.shift():function(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,i),1===n.length&&(r[e]=n[0]),void 0!==r.removeListener&&this.emit("removeListener",e,a||t)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(e){var t,n,r;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0===--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var i,s=Object.keys(n);for(r=0;r<s.length;++r)"removeListener"!==(i=s[r])&&this.removeAllListeners(i);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(r=t.length-1;r>=0;r--)this.removeListener(e,t[r]);return this},i.prototype.listeners=function(e){return d(this,e,!0)},i.prototype.rawListeners=function(e){return d(this,e,!1)},i.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):h.call(e,t)},i.prototype.listenerCount=h,i.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]},Pn.exports}function at(){return uo||(uo=1,function(e){const t=Ct(),{format:n,inspect:r}=Zu(),{codes:{ERR_INVALID_ARG_TYPE:i}}=it(),{kResistStopPropagation:s,AggregateError:o,SymbolDispose:a}=Be(),l=globalThis.AbortSignal||xn().AbortSignal,c=globalThis.AbortController||xn().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(e){return e instanceof d}:function(e){return!1},p=(e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new i(t,"AbortSignal",e)};e.exports={AggregateError:o,kEmptyObject:Object.freeze({}),once(e){let t=!1;return function(...n){t||(t=!0,e.apply(this,n))}},createDeferredPromise:function(){let e,t;return{promise:new Promise((n,r)=>{e=n,t=r}),resolve:e,reject:t}},promisify:e=>new Promise((t,n)=>{e((e,...r)=>e?n(e):t(...r))}),debuglog:()=>function(){},format:n,inspect:r,types:{isAsyncFunction:e=>e instanceof u,isArrayBufferView:e=>ArrayBuffer.isView(e)},isBlob:h,deprecate:(e,t)=>e,addAbortListener:ai().addAbortListener||function(e,t){if(void 0===e)throw new i("signal","AbortSignal",e);let n;return p(e,"signal"),(e=>{if("function"!=typeof e)throw new i("listener","Function",e)})(t),e.aborted?queueMicrotask(()=>t()):(e.addEventListener("abort",t,{__proto__:null,once:!0,[s]:!0}),n=()=>{e.removeEventListener("abort",t)}),{__proto__:null,[a](){var e;null===(e=n)||void 0===e||e()}}},AbortSignalAny:l.any||function(e){if(1===e.length)return e[0];const t=new c,n=()=>t.abort();return e.forEach(e=>{p(e,"signals"),e.addEventListener("abort",n,{once:!0})}),t.signal.addEventListener("abort",()=>{e.forEach(e=>e.removeEventListener("abort",n))},{once:!0}),t.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(Ei)),Ei.exports}var Ni,co,Mn={};function Nn(){if(co)return Ni;co=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:i,NumberIsNaN:s,NumberMAX_SAFE_INTEGER:o,NumberMIN_SAFE_INTEGER:a,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:p}=Be(),{hideStackFrames:f,codes:{ERR_SOCKET_BAD_PORT:g,ERR_INVALID_ARG_TYPE:m,ERR_INVALID_ARG_VALUE:b,ERR_OUT_OF_RANGE:y,ERR_UNKNOWN_SIGNAL:v}}=it(),{normalizeEncoding:w}=at(),{isAsyncFunction:_,isArrayBufferView:x}=at().types,S={},E=/^[0-7]+$/,I=f((e,t,n=a,r=o)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!i(e))throw new y(t,"an integer",e);if(e<n||e>r)throw new y(t,`>= ${n} && <= ${r}`,e)}),j=f((e,t,n=-2147483648,r=2147483647)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!i(e))throw new y(t,"an integer",e);if(e<n||e>r)throw new y(t,`>= ${n} && <= ${r}`,e)}),T=f((e,t,n=!1)=>{if("number"!=typeof e)throw new m(t,"number",e);if(!i(e))throw new y(t,"an integer",e);const r=n?1:0,s=4294967295;if(e<r||e>s)throw new y(t,`>= ${r} && <= ${s}`,e)});function N(e,t){if("string"!=typeof e)throw new m(t,"string",e)}const k=f((e,i,s)=>{if(!t(s,e)){const t="must be one of: "+n(r(s,e=>"string"==typeof e?`'${e}'`:d(e)),", ");throw new b(i,e,t)}});function R(e,t){if("boolean"!=typeof e)throw new m(t,"boolean",e)}function C(e,t,n){return null!=e&&c(e,t)?e[t]:n}const A=f((t,n,r=null)=>{const i=C(r,"allowArray",!1),s=C(r,"allowFunction",!1);if(!C(r,"nullable",!1)&&null===t||!i&&e(t)||"object"!=typeof t&&(!s||"function"!=typeof t))throw new m(n,"Object",t)}),O=f((e,t)=>{if(null!=e&&"object"!=typeof e&&"function"!=typeof e)throw new m(t,"a dictionary",e)}),L=f((t,n,r=0)=>{if(!e(t))throw new m(n,"Array",t);if(t.length<r)throw new b(n,t,`must be longer than ${r}`)}),$=f((e,t="buffer")=>{if(!x(e))throw new m(t,["Buffer","TypedArray","DataView"],e)}),D=f((e,t)=>{if(void 0!==e&&(null===e||"object"!=typeof e||!("aborted"in e)))throw new m(t,"AbortSignal",e)}),P=f((e,t)=>{if("function"!=typeof e)throw new m(t,"Function",e)}),M=f((e,t)=>{if("function"!=typeof e||_(e))throw new m(t,"Function",e)}),F=f((e,t)=>{if(void 0!==e)throw new m(t,"undefined",e)}),B=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function U(e,t){if(typeof e>"u"||!u(B,e))throw new b(t,e,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return Ni={isInt32:function(e){return e===(0|e)},isUint32:function(e){return e===e>>>0},parseFileMode:function(e,t,n){if(typeof e>"u"&&(e=n),"string"==typeof e){if(null===u(E,e))throw new b(t,e,"must be a 32-bit unsigned integer or an octal string");e=l(e,8)}return T(e,t),e},validateArray:L,validateStringArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++)N(e[n],`${t}[${n}]`)},validateBooleanArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++)R(e[n],`${t}[${n}]`)},validateAbortSignalArray:function(e,t){L(e,t);for(let n=0;n<e.length;n++){const r=e[n],i=`${t}[${n}]`;if(null==r)throw new m(i,"AbortSignal",r);D(r,i)}},validateBoolean:R,validateBuffer:$,validateDictionary:O,validateEncoding:function(e,t){const n=w(t),r=e.length;if("hex"===n&&r%2!=0)throw new b("encoding",t,`is invalid for data of length ${r}`)},validateFunction:P,validateInt32:j,validateInteger:I,validateNumber:function(e,t,n=void 0,r){if("number"!=typeof e)throw new m(t,"number",e);if(null!=n&&e<n||null!=r&&e>r||(null!=n||null!=r)&&s(e))throw new y(t,`${null!=n?`>= ${n}`:""}${null!=n&&null!=r?" && ":""}${null!=r?`<= ${r}`:""}`,e)},validateObject:A,validateOneOf:k,validatePlainFunction:M,validatePort:function(e,t="Port",n=!0){if("number"!=typeof e&&"string"!=typeof e||"string"==typeof e&&0===p(e).length||+e!==+e>>>0||e>65535||0===e&&!n)throw new g(t,e,n);return 0|e},validateSignalName:function(e,t="signal"){if(N(e,t),void 0===S[e])throw void 0!==S[h(e)]?new v(e+" (signals must use all capital letters)"):new v(e)},validateString:N,validateUint32:T,validateUndefined:F,validateUnion:function(e,r,i){if(!t(i,e))throw new m(r,`('${n(i,"|")}')`,e)},validateAbortSignal:D,validateLinkHeaderValue:function(t){if("string"==typeof t)return U(t,"hints"),t;if(e(t)){const e=t.length;let n="";if(0===e)return n;for(let r=0;r<e;r++){const i=t[r];U(i,"hints"),n+=i,r!==e-1&&(n+=", ")}return n}throw new b("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}}}var ho,Ti,fo,po,Ai,go,Di,mo,Bn={exports:{}},Ri={exports:{}};function pr(){if(ho)return Ri.exports;ho=1;var e,t,n=Ri.exports={};function r(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function s(t){if(e===setTimeout)return setTimeout(t,0);if((e===r||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch{try{return e.call(null,t,0)}catch{return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:r}catch{e=r}try{t="function"==typeof clearTimeout?clearTimeout:i}catch{t=i}}();var o,a=[],l=!1,c=-1;function u(){!l||!o||(l=!1,o.length?a=o.concat(a):c=-1,a.length&&d())}function d(){if(!l){var e=s(u);l=!0;for(var n=a.length;n;){for(o=a,a=[];++c<n;)o&&o[c].run();c=-1,n=a.length}o=null,l=!1,function(e){if(t===clearTimeout)return clearTimeout(e);if((t===i||!t)&&clearTimeout)return t=clearTimeout,clearTimeout(e);try{return t(e)}catch{try{return t.call(null,e)}catch{return t.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function p(){}return n.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];a.push(new h(e,t)),1===a.length&&!l&&s(d)},h.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.browser=!0,n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(e){return[]},n.binding=function(e){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(e){throw new Error("process.chdir is not supported")},n.umask=function(){return 0},Ri.exports}function jt(){if(fo)return Ti;fo=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=Be(),r=n("nodejs.stream.destroyed"),i=n("nodejs.stream.errored"),s=n("nodejs.stream.readable"),o=n("nodejs.stream.writable"),a=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(e,t=!1){var n;return!(!e||"function"!=typeof e.pipe||"function"!=typeof e.on||t&&("function"!=typeof e.pause||"function"!=typeof e.resume)||e._writableState&&!1===(null===(n=e._readableState)||void 0===n?void 0:n.readable)||e._writableState&&!e._readableState)}function d(e){var t;return!(!e||"function"!=typeof e.write||"function"!=typeof e.on||e._readableState&&!1===(null===(t=e._writableState)||void 0===t?void 0:t.writable))}function h(e){return e&&(e._readableState||e._writableState||"function"==typeof e.write&&"function"==typeof e.on||"function"==typeof e.pipe&&"function"==typeof e.on)}function p(e){return!(!e||h(e)||"function"!=typeof e.pipeThrough||"function"!=typeof e.getReader||"function"!=typeof e.cancel)}function f(e){return!(!e||h(e)||"function"!=typeof e.getWriter||"function"!=typeof e.abort)}function g(e){return!(!e||h(e)||"object"!=typeof e.readable||"object"!=typeof e.writable)}function m(e){if(!h(e))return null;const t=e._writableState,n=e._readableState,i=t||n;return!!(e.destroyed||e[r]||null!=i&&i.destroyed)}function b(e){if(!d(e))return null;if(!0===e.writableEnded)return!0;const t=e._writableState;return(null==t||!t.errored)&&("boolean"!=typeof t?.ended?null:t.ended)}function y(e,t){if(!u(e))return null;const n=e._readableState;return(null==n||!n.errored)&&("boolean"!=typeof n?.endEmitted?null:!!(n.endEmitted||!1===t&&!0===n.ended&&0===n.length))}function v(e){return e&&null!=e[s]?e[s]:"boolean"!=typeof e?.readable?null:!m(e)&&u(e)&&e.readable&&!y(e)}function w(e){return e&&null!=e[o]?e[o]:"boolean"!=typeof e?.writable?null:!m(e)&&d(e)&&e.writable&&!b(e)}function _(e){return"boolean"==typeof e._closed&&"boolean"==typeof e._defaultKeepAlive&&"boolean"==typeof e._removedConnection&&"boolean"==typeof e._removedContLen}function x(e){return"boolean"==typeof e._sent100&&_(e)}return Ti={isDestroyed:m,kIsDestroyed:r,isDisturbed:function(e){var t;return!(!e||!(null!==(t=e[a])&&void 0!==t?t:e.readableDidRead||e.readableAborted))},kIsDisturbed:a,isErrored:function(e){var t,n,r,s,o,a,l,c,u,d;return!(!e||!(null!==(t=null!==(n=null!==(r=null!==(s=null!==(o=null!==(a=e[i])&&void 0!==a?a:e.readableErrored)&&void 0!==o?o:e.writableErrored)&&void 0!==s?s:null===(l=e._readableState)||void 0===l?void 0:l.errorEmitted)&&void 0!==r?r:null===(c=e._writableState)||void 0===c?void 0:c.errorEmitted)&&void 0!==n?n:null===(u=e._readableState)||void 0===u?void 0:u.errored)&&void 0!==t?t:null!==(d=e._writableState)&&void 0!==d&&d.errored))},kIsErrored:i,isReadable:v,kIsReadable:s,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:o,isClosed:function(e){if(!h(e))return null;if("boolean"==typeof e.closed)return e.closed;const t=e._writableState,n=e._readableState;return"boolean"==typeof t?.closed||"boolean"==typeof n?.closed?t?.closed||n?.closed:"boolean"==typeof e._closed&&_(e)?e._closed:null},isDuplexNodeStream:function(e){return!(!e||"function"!=typeof e.pipe||!e._readableState||"function"!=typeof e.on||"function"!=typeof e.write)},isFinished:function(e,t){return h(e)?!!m(e)||!(!1!==t?.readable&&v(e)||!1!==t?.writable&&w(e)):null},isIterable:function(n,r){return null!=n&&(!0===r?"function"==typeof n[e]:!1===r?"function"==typeof n[t]:"function"==typeof n[e]||"function"==typeof n[t])},isReadableNodeStream:u,isReadableStream:p,isReadableEnded:function(e){if(!u(e))return null;if(!0===e.readableEnded)return!0;const t=e._readableState;return!(!t||t.errored)&&("boolean"!=typeof t?.ended?null:t.ended)},isReadableFinished:y,isReadableErrored:function(e){var t,n;return h(e)?e.readableErrored?e.readableErrored:null!==(t=null===(n=e._readableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isNodeStream:h,isWebStream:function(e){return p(e)||f(e)||g(e)},isWritable:w,isWritableNodeStream:d,isWritableStream:f,isWritableEnded:b,isWritableFinished:function(e,t){if(!d(e))return null;if(!0===e.writableFinished)return!0;const n=e._writableState;return(null==n||!n.errored)&&("boolean"!=typeof n?.finished?null:!!(n.finished||!1===t&&!0===n.ended&&0===n.length))},isWritableErrored:function(e){var t,n;return h(e)?e.writableErrored?e.writableErrored:null!==(t=null===(n=e._writableState)||void 0===n?void 0:n.errored)&&void 0!==t?t:null:null},isServerRequest:function(e){var t;return"boolean"==typeof e._consuming&&"boolean"==typeof e._dumped&&void 0===(null===(t=e.req)||void 0===t?void 0:t.upgradeOrConnect)},isServerResponse:x,willEmitClose:function(e){if(!h(e))return null;const t=e._writableState,n=e._readableState,r=t||n;return!r&&x(e)||!!(r&&r.autoDestroy&&r.emitClose&&!1===r.closed)},isTransformStream:g}}function zt(){if(po)return Bn.exports;po=1;const e=pr(),{AbortError:t,codes:n}=it(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:i}=n,{kEmptyObject:s,once:o}=at(),{validateAbortSignal:a,validateFunction:l,validateObject:c,validateBoolean:u}=Nn(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:p}=Be(),{isClosed:f,isReadable:g,isReadableNodeStream:m,isReadableStream:b,isReadableFinished:y,isReadableErrored:v,isWritable:w,isWritableNodeStream:_,isWritableStream:x,isWritableFinished:S,isWritableErrored:E,isNodeStream:I,willEmitClose:j,kIsClosedPromise:T}=jt();let N;const k=()=>{};function R(n,u,d){var R,C;if(2===arguments.length?(d=u,u=s):null==u?u=s:c(u,"options"),l(d,"callback"),a(u.signal,"options.signal"),d=o(d),b(n)||x(n))return function(n,r,i){let s=!1,a=k;if(r.signal)if(a=()=>{s=!0,i.call(n,new t(void 0,{cause:r.signal.reason}))},r.signal.aborted)e.nextTick(a);else{N=N||at().addAbortListener;const e=N(r.signal,a),t=i;i=o((...r)=>{e[p](),t.apply(n,r)})}const l=(...t)=>{s||e.nextTick(()=>i.apply(n,t))};return h(n[T].promise,l,l),k}(n,u,d);if(!I(n))throw new r("stream",["ReadableStream","WritableStream","Stream"],n);const A=null!==(R=u.readable)&&void 0!==R?R:m(n),O=null!==(C=u.writable)&&void 0!==C?C:_(n),L=n._writableState,$=n._readableState,D=()=>{n.writable||F()};let P=j(n)&&m(n)===A&&_(n)===O,M=S(n,!1);const F=()=>{M=!0,n.destroyed&&(P=!1),(!P||n.readable&&!A)&&(!A||B)&&d.call(n)};let B=y(n,!1);const U=()=>{B=!0,n.destroyed&&(P=!1),(!P||n.writable&&!O)&&(!O||M)&&d.call(n)},q=e=>{d.call(n,e)};let H=f(n);const V=()=>{H=!0;const e=E(n)||v(n);return e&&"boolean"!=typeof e?d.call(n,e):A&&!B&&m(n,!0)&&!y(n,!1)?d.call(n,new i):!O||M||S(n,!1)?void d.call(n):d.call(n,new i)},W=()=>{H=!0;const e=E(n)||v(n);if(e&&"boolean"!=typeof e)return d.call(n,e);d.call(n)},G=()=>{n.req.on("finish",F)};!function(e){return e.setHeader&&"function"==typeof e.abort}(n)?O&&!L&&(n.on("end",D),n.on("close",D)):(n.on("complete",F),P||n.on("abort",V),n.req?G():n.on("request",G)),!P&&"boolean"==typeof n.aborted&&n.on("aborted",V),n.on("end",U),n.on("finish",F),!1!==u.error&&n.on("error",q),n.on("close",V),H?e.nextTick(V):null!=L&&L.errorEmitted||null!=$&&$.errorEmitted?P||e.nextTick(W):(!A&&(!P||g(n))&&(M||!1===w(n))||!O&&(!P||w(n))&&(B||!1===g(n))||$&&n.req&&n.aborted)&&e.nextTick(W);const z=()=>{d=k,n.removeListener("aborted",V),n.removeListener("complete",F),n.removeListener("abort",V),n.removeListener("request",G),n.req&&n.req.removeListener("finish",F),n.removeListener("end",D),n.removeListener("close",D),n.removeListener("finish",F),n.removeListener("end",U),n.removeListener("error",q),n.removeListener("close",V)};if(u.signal&&!H){const r=()=>{const e=d;z(),e.call(n,new t(void 0,{cause:u.signal.reason}))};if(u.signal.aborted)e.nextTick(r);else{N=N||at().addAbortListener;const e=N(u.signal,r),t=d;d=o((...r)=>{e[p](),t.apply(n,r)})}}return z}return Bn.exports=R,Bn.exports.finished=function(e,t){var n;let r=!1;return null===t&&(t=s),null!==(n=t)&&void 0!==n&&n.cleanup&&(u(t.cleanup,"cleanup"),r=t.cleanup),new d((n,i)=>{const s=R(e,t,e=>{r&&s(),e?i(e):n()})})},Bn.exports}function jr(){if(go)return Ai;go=1;const e=pr(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=it(),{Symbol:i}=Be(),{kIsDestroyed:s,isDestroyed:o,isFinished:a,isServerRequest:l}=jt(),c=i("kDestroy"),u=i("kConstruct");function d(e,t,n){e&&(e.stack,t&&!t.errored&&(t.errored=e),n&&!n.errored&&(n.errored=e))}function h(t,n,r){let i=!1;function s(n){if(i)return;i=!0;const s=t._readableState,o=t._writableState;d(n,o,s),o&&(o.closed=!0),s&&(s.closed=!0),"function"==typeof r&&r(n),n?e.nextTick(p,t,n):e.nextTick(f,t)}try{t._destroy(n||null,s)}catch(e){s(e)}}function p(e,t){g(e,t),f(e)}function f(e){const t=e._readableState,n=e._writableState;n&&(n.closeEmitted=!0),t&&(t.closeEmitted=!0),(null!=n&&n.emitClose||null!=t&&t.emitClose)&&e.emit("close")}function g(e,t){const n=e._readableState,r=e._writableState;null!=r&&r.errorEmitted||null!=n&&n.errorEmitted||(r&&(r.errorEmitted=!0),n&&(n.errorEmitted=!0),e.emit("error",t))}function m(t,n,r){const i=t._readableState,s=t._writableState;if(null!=s&&s.destroyed||null!=i&&i.destroyed)return this;null!=i&&i.autoDestroy||null!=s&&s.autoDestroy?t.destroy(n):n&&(n.stack,s&&!s.errored&&(s.errored=n),i&&!i.errored&&(i.errored=n),r?e.nextTick(g,t,n):g(t,n))}function b(t){let r=!1;function i(i){if(r)return void m(t,i??new n);r=!0;const s=t._readableState,o=t._writableState,a=o||s;s&&(s.constructed=!0),o&&(o.constructed=!0),a.destroyed?t.emit(c,i):i?m(t,i,!0):e.nextTick(y,t)}try{t._construct(t=>{e.nextTick(i,t)})}catch(t){e.nextTick(i,t)}}function y(e){e.emit(u)}function v(e){return e?.setHeader&&"function"==typeof e.abort}function w(e){e.emit("close")}function _(t,n){t.emit("error",n),e.nextTick(w,t)}return Ai={construct:function(t,n){if("function"!=typeof t._construct)return;const r=t._readableState,i=t._writableState;r&&(r.constructed=!1),i&&(i.constructed=!1),t.once(u,n),!(t.listenerCount(u)>1)&&e.nextTick(b,t)},destroyer:function(t,n){!t||o(t)||(!n&&!a(t)&&(n=new r),l(t)?(t.socket=null,t.destroy(n)):v(t)?t.abort():v(t.req)?t.req.abort():"function"==typeof t.destroy?t.destroy(n):"function"==typeof t.close?t.close():n?e.nextTick(_,t,n):e.nextTick(w,t),t.destroyed||(t[s]=!0))},destroy:function(e,n){const r=this._readableState,i=this._writableState,s=i||r;return null!=i&&i.destroyed||null!=r&&r.destroyed?("function"==typeof n&&n(),this):(d(e,i,r),i&&(i.destroyed=!0),r&&(r.destroyed=!0),s.constructed?h(this,e,n):this.once(c,function(r){h(this,t(r,e),n)}),this)},undestroy:function(){const e=this._readableState,t=this._writableState;e&&(e.constructed=!0,e.closed=!1,e.closeEmitted=!1,e.destroyed=!1,e.errored=null,e.errorEmitted=!1,e.reading=!1,e.ended=!1===e.readable,e.endEmitted=!1===e.readable),t&&(t.constructed=!0,t.destroyed=!1,t.closed=!1,t.closeEmitted=!1,t.errored=null,t.errorEmitted=!1,t.finalCalled=!1,t.prefinished=!1,t.ended=!1===t.writable,t.ending=!1===t.writable,t.finished=!1===t.writable)},errorOrDestroy:m}}function ya(){if(mo)return Di;mo=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=Be(),{EventEmitter:n}=ai();function r(e){n.call(this,e)}function i(t,n,r){if("function"==typeof t.prependListener)return t.prependListener(n,r);t._events&&t._events[n]?e(t._events[n])?t._events[n].unshift(r):t._events[n]=[r,t._events[n]]:t.on(n,r)}return t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(e,t){const r=this;function s(t){e.writable&&!1===e.write(t)&&r.pause&&r.pause()}function o(){r.readable&&r.resume&&r.resume()}r.on("data",s),e.on("drain",o),!e._isStdio&&(!t||!1!==t.end)&&(r.on("end",l),r.on("close",c));let a=!1;function l(){a||(a=!0,e.end())}function c(){a||(a=!0,"function"==typeof e.destroy&&e.destroy())}function u(e){d(),0===n.listenerCount(this,"error")&&this.emit("error",e)}function d(){r.removeListener("data",s),e.removeListener("drain",o),r.removeListener("end",l),r.removeListener("close",c),r.removeListener("error",u),e.removeListener("error",u),r.removeListener("end",d),r.removeListener("close",d),e.removeListener("close",d)}return i(r,"error",u),i(e,"error",u),r.on("end",d),r.on("close",d),e.on("close",d),e.emit("pipe",r),e},Di={Stream:r,prependListener:i}}var yo,Oi,bo,Ci,_o,Li={exports:{}};function oi(){return yo||(yo=1,function(e){const{SymbolDispose:t}=Be(),{AbortError:n,codes:r}=it(),{isNodeStream:i,isWebStream:s,kControllerErrorFunction:o}=jt(),a=zt(),{ERR_INVALID_ARG_TYPE:l}=r;let c;e.exports.addAbortSignal=function(t,n){if((e=>{if("object"!=typeof e||!("aborted"in e))throw new l("signal","AbortSignal",e)})(t),!i(n)&&!s(n))throw new l("stream",["ReadableStream","WritableStream","Stream"],n);return e.exports.addAbortSignalNoValidate(t,n)},e.exports.addAbortSignalNoValidate=function(e,r){if("object"!=typeof e||!("aborted"in e))return r;const s=i(r)?()=>{r.destroy(new n(void 0,{cause:e.reason}))}:()=>{r[o](new n(void 0,{cause:e.reason}))};if(e.aborted)s();else{c=c||at().addAbortListener;const n=c(e,s);a(r,n[t])}return r}}(Li)),Li.exports}function xd(){if(bo)return Oi;bo=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=Be(),{Buffer:i}=Ct(),{inspect:s}=at();return Oi=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){const t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){const t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length}shift(){if(0===this.length)return;const e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(0===this.length)return"";let t=this.head,n=""+t.data;for(;null!==(t=t.next);)n+=e+t.data;return n}concat(e){if(0===this.length)return i.alloc(0);const t=i.allocUnsafe(e>>>0);let r=this.head,s=0;for(;r;)n(t,r.data,s),s+=r.data.length,r=r.next;return t}consume(e,t){const n=this.head.data;if(e<n.length){const t=n.slice(0,e);return this.head.data=n.slice(e),t}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[t](){for(let e=this.head;e;e=e.next)yield e.data}_getString(t){let n="",r=this.head,i=0;do{const s=r.data;if(!(t>s.length)){t===s.length?(n+=s,++i,r.next?this.head=r.next:this.head=this.tail=null):(n+=e(s,0,t),this.head=r,r.data=e(s,t));break}n+=s,t-=s.length,++i}while(null!==(r=r.next));return this.length-=i,n}_getBuffer(e){const t=i.allocUnsafe(e),s=e;let o=this.head,a=0;do{const i=o.data;if(!(e>i.length)){e===i.length?(n(t,i,s-e),++a,o.next?this.head=o.next:this.head=this.tail=null):(n(t,new r(i.buffer,i.byteOffset,e),s-e),this.head=o,o.data=i.slice(e));break}n(t,i,s-e),e-=i.length,++a}while(null!==(o=o.next));return this.length-=a,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return s(this,{...t,depth:0,customInspect:!1})}}}function li(){if(_o)return Ci;_o=1;const{MathFloor:e,NumberIsInteger:t}=Be(),{validateInteger:n}=Nn(),{ERR_INVALID_ARG_VALUE:r}=it().codes;let i=16384,s=16;function o(e){return e?s:i}return Ci={getHighWaterMark:function(n,i,s,a){const l=function(e,t,n){return null!=e.highWaterMark?e.highWaterMark:t?e[n]:null}(i,a,s);if(null!=l){if(!t(l)||l<0)throw new r(a?`options.${s}`:"options.highWaterMark",l);return e(l)}return o(n.objectMode)},getDefaultHighWaterMark:o,setDefaultHighWaterMark:function(e,t){n(t,"value",0),e?s=t:i=t}}}var wo,vo,$i,xo,Fi,Eo,ki,So,Pi,Io,Mi,No,Bi,Ro,qi,To,Ui,Ao,Hi,Do,Lo,Vi,Oo,Co,jo,ji={},qn={exports:{}};function Ed(){return wo||(wo=1,function(e,t){var n=Ct(),r=n.Buffer;function i(e,t){for(var n in e)t[n]=e[n]}function s(e,t,n){return r(e,t,n)}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(i(n,t),t.Buffer=s),s.prototype=Object.create(r.prototype),i(r,s),s.from=function(e,t,n){if("number"==typeof e)throw new TypeError("Argument must not be a number");return r(e,t,n)},s.alloc=function(e,t,n){if("number"!=typeof e)throw new TypeError("Argument must be a number");var i=r(e);return void 0!==t?"string"==typeof n?i.fill(t,n):i.fill(t):i.fill(0),i},s.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return r(e)},s.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return n.SlowBuffer(e)}}(qn,qn.exports)),qn.exports}function Sd(){if(vo)return ji;vo=1;var e=Ed().Buffer,t=e.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(n){var r;switch(this.encoding=function(n){var r=function(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}(n);if("string"!=typeof r&&(e.isEncoding===t||!t(n)))throw new Error("Unknown encoding: "+n);return r||n}(n),this.encoding){case"utf16le":this.text=s,this.end=o,r=4;break;case"utf8":this.fillLast=i,r=4;break;case"base64":this.text=a,this.end=l,r=3;break;default:return this.write=c,void(this.end=u)}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(r)}function r(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:e>>6==2?-1:-2}function i(e){var t=this.lastTotal-this.lastNeed,n=function(e,t){if(128!=(192&t[0]))return e.lastNeed=0,"�";if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"�";if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"�"}}(this,e);return void 0!==n?n:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function s(e,t){if((e.length-t)%2==0){var n=e.toString("utf16le",t);if(n){var r=n.charCodeAt(n.length-1);if(r>=55296&&r<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],n.slice(0,-1)}return n}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function o(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var n=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,n)}return t}function a(e,t){var n=(e.length-t)%3;return 0===n?e.toString("base64",t):(this.lastNeed=3-n,this.lastTotal=3,1===n?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-n))}function l(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function c(e){return e.toString(this.encoding)}function u(e){return e&&e.length?this.write(e):""}return ji.StringDecoder=n,n.prototype.write=function(e){if(0===e.length)return"";var t,n;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";n=this.lastNeed,this.lastNeed=0}else n=0;return n<e.length?t?t+this.text(e,n):this.text(e,n):t||""},n.prototype.end=function(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"�":t},n.prototype.text=function(e,t){var n=function(e,t,n){var i=t.length-1;if(i<n)return 0;var s=r(t[i]);return s>=0?(s>0&&(e.lastNeed=s-1),s):--i<n||-2===s?0:(s=r(t[i]))>=0?(s>0&&(e.lastNeed=s-2),s):--i<n||-2===s?0:(s=r(t[i]))>=0?(s>0&&(2===s?s=0:e.lastNeed=s-3),s):0}(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=n;var i=e.length-(n-this.lastNeed);return e.copy(this.lastChar,0,i),e.toString("utf8",t,i)},n.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length},ji}function ec(){if(xo)return $i;xo=1;const e=pr(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=Be(),{Buffer:i}=Ct(),{ERR_INVALID_ARG_TYPE:s,ERR_STREAM_NULL_VALUES:o}=it().codes;return $i=function(a,l,c){let u,d;if("string"==typeof l||l instanceof i)return new a({objectMode:!0,...c,read(){this.push(l),this.push(null)}});if(l&&l[n])d=!0,u=l[n]();else{if(!l||!l[r])throw new s("iterable",["Iterable"],l);d=!1,u=l[r]()}const h=new a({objectMode:!0,highWaterMark:1,...c});let p=!1;return h._read=function(){p||(p=!0,async function(){for(;;){try{const{value:e,done:t}=d?await u.next():u.next();if(t)h.push(null);else{const t=e&&"function"==typeof e.then?await e:e;if(null===t)throw p=!1,new o;if(h.push(t))continue;p=!1}}catch(e){h.destroy(e)}break}}())},h._destroy=function(n,r){t(async function(e){const t=null!=e,n="function"==typeof u.throw;if(t&&n){const{value:t,done:n}=await u.throw(e);if(await t,n)return}if("function"==typeof u.return){const{value:e}=await u.return();await e}}(n),()=>e.nextTick(r,n),t=>e.nextTick(r,t||n))},h}}function ui(){if(Eo)return Fi;Eo=1;const e=pr(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:i,ObjectDefineProperties:s,ObjectKeys:o,ObjectSetPrototypeOf:a,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=Be();Fi=V,V.ReadableState=H;const{EventEmitter:p}=ai(),{Stream:f,prependListener:g}=ya(),{Buffer:m}=Ct(),{addAbortSignal:b}=oi(),y=zt();let v=at().debuglog("stream",e=>{v=e});const w=xd(),_=jr(),{getHighWaterMark:x,getDefaultHighWaterMark:S}=li(),{aggregateTwoErrors:E,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:j,ERR_OUT_OF_RANGE:T,ERR_STREAM_PUSH_AFTER_EOF:N,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:k},AbortError:R}=it(),{validateObject:C}=Nn(),A=h("kPaused"),{StringDecoder:O}=Sd(),L=ec();a(V.prototype,f.prototype),a(V,f);const $=()=>{},{errorOrDestroy:D}=_,P=1,M=16,F=32,B=2048,U=4096;function q(e){return{enumerable:!1,get(){return 0!==(this.state&e)},set(t){t?this.state|=e:this.state&=~e}}}function H(e,t,n){"boolean"!=typeof n&&(n=t instanceof Lt()),this.state=B|U|M|F,e&&e.objectMode&&(this.state|=P),n&&e&&e.readableObjectMode&&(this.state|=P),this.highWaterMark=e?x(this,e,"readableHighWaterMark",n):S(!1),this.buffer=new w,this.length=0,this.pipes=[],this.flowing=null,this[A]=null,e&&!1===e.emitClose&&(this.state&=~B),e&&!1===e.autoDestroy&&(this.state&=~U),this.errored=null,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,e&&e.encoding&&(this.decoder=new O(e.encoding),this.encoding=e.encoding)}function V(e){if(!(this instanceof V))return new V(e);const t=this instanceof Lt();this._readableState=new H(e,this,t),e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&!t&&b(e.signal,this)),f.call(this,e),_.construct(this,()=>{this._readableState.needReadable&&X(this,this._readableState)})}function W(e,t,n,r){v("readableAddChunk",t);const i=e._readableState;let s;if(0===(i.state&P)&&("string"==typeof t?(n=n||i.defaultEncoding,i.encoding!==n&&(r&&i.encoding?t=m.from(t,n).toString(i.encoding):(t=m.from(t,n),n=""))):t instanceof m?n="":f._isUint8Array(t)?(t=f._uint8ArrayToBuffer(t),n=""):null!=t&&(s=new I("chunk",["string","Buffer","Uint8Array"],t))),s)D(e,s);else if(null===t)i.state&=-9,function(e,t){if(v("onEofChunk"),!t.ended){if(t.decoder){const e=t.decoder.end();e&&e.length&&(t.buffer.push(e),t.length+=t.objectMode?1:e.length)}t.ended=!0,t.sync?J(e):(t.needReadable=!1,t.emittedReadable=!0,Q(e))}}(e,i);else if(0!==(i.state&P)||t&&t.length>0)if(r)if(4&i.state)D(e,new k);else{if(i.destroyed||i.errored)return!1;G(e,i,t,!0)}else if(i.ended)D(e,new N);else{if(i.destroyed||i.errored)return!1;i.state&=-9,i.decoder&&!n?(t=i.decoder.write(t),i.objectMode||0!==t.length?G(e,i,t,!1):X(e,i)):G(e,i,t,!1)}else r||(i.state&=-9,X(e,i));return!i.ended&&(i.length<i.highWaterMark||0===i.length)}function G(e,t,n,r){t.flowing&&0===t.length&&!t.sync&&e.listenerCount("data")>0?(65536&t.state?t.awaitDrainWriters.clear():t.awaitDrainWriters=null,t.dataEmitted=!0,e.emit("data",n)):(t.length+=t.objectMode?1:n.length,r?t.buffer.unshift(n):t.buffer.push(n),!!(64&t.state)&&J(e)),X(e,t)}function z(e,t){return e<=0||0===t.length&&t.ended?0:0!==(t.state&P)?1:r(e)?t.flowing&&t.length?t.buffer.first().length:t.length:e<=t.length?e:t.ended?t.length:0}function J(t){const n=t._readableState;v("emitReadable",n.needReadable,n.emittedReadable),n.needReadable=!1,n.emittedReadable||(v("emitReadable",n.flowing),n.emittedReadable=!0,e.nextTick(Q,t))}function Q(e){const t=e._readableState;v("emitReadable_",t.destroyed,t.length,t.ended),!t.destroyed&&!t.errored&&(t.length||t.ended)&&(e.emit("readable"),t.emittedReadable=!1),t.needReadable=!t.flowing&&!t.ended&&t.length<=t.highWaterMark,te(e)}function X(t,n){!n.readingMore&&n.constructed&&(n.readingMore=!0,e.nextTick(K,t,n))}function K(e,t){for(;!t.reading&&!t.ended&&(t.length<t.highWaterMark||t.flowing&&0===t.length);){const n=t.length;if(v("maybeReadMore read 0"),e.read(0),n===t.length)break}t.readingMore=!1}function Y(e){const t=e._readableState;t.readableListening=e.listenerCount("readable")>0,t.resumeScheduled&&!1===t[A]?t.flowing=!0:e.listenerCount("data")>0?e.resume():t.readableListening||(t.flowing=null)}function Z(e){v("readable nexttick read 0"),e.read(0)}function ee(e,t){v("resume",t.reading),t.reading||e.read(0),t.resumeScheduled=!1,e.emit("resume"),te(e),t.flowing&&!t.reading&&e.read(0)}function te(e){const t=e._readableState;for(v("flow",t.flowing);t.flowing&&null!==e.read(););}function ne(e,t){"function"!=typeof e.read&&(e=V.wrap(e,{objectMode:!0}));const n=async function*(e,t){let n,r=$;function i(t){this===e?(r(),r=$):r=t}e.on("readable",i);const s=y(e,{writable:!1},e=>{n=e?E(n,e):null,r(),r=$});try{for(;;){const t=e.destroyed?null:e.read();if(null!==t)yield t;else{if(n)throw n;if(null===n)return;await new l(i)}}}catch(e){throw n=E(n,e),n}finally{!n&&!1===t?.destroyOnReturn||void 0!==n&&!e._readableState.autoDestroy?(e.off("readable",i),s()):_.destroyer(e,null)}}(e,t);return n.stream=e,n}function re(e,t){if(0===t.length)return null;let n;return t.objectMode?n=t.buffer.shift():!e||e>=t.length?(n=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.first():t.buffer.concat(t.length),t.buffer.clear()):n=t.buffer.consume(e,t.decoder),n}function ie(t){const n=t._readableState;v("endReadable",n.endEmitted),n.endEmitted||(n.ended=!0,e.nextTick(se,n,t))}function se(t,n){if(v("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&0===t.length)if(t.endEmitted=!0,n.emit("end"),n.writable&&!1===n.allowHalfOpen)e.nextTick(oe,n);else if(t.autoDestroy){const e=n._writableState;(!e||e.autoDestroy&&(e.finished||!1===e.writable))&&n.destroy()}}function oe(e){e.writable&&!e.writableEnded&&!e.destroyed&&e.end()}let ae;function le(){return void 0===ae&&(ae={}),ae}return s(H.prototype,{objectMode:q(P),ended:q(2),endEmitted:q(4),reading:q(8),constructed:q(M),sync:q(F),needReadable:q(64),emittedReadable:q(128),readableListening:q(256),resumeScheduled:q(512),errorEmitted:q(1024),emitClose:q(B),autoDestroy:q(U),destroyed:q(8192),closed:q(16384),closeEmitted:q(32768),multiAwaitDrain:q(65536),readingMore:q(1<<17),dataEmitted:q(1<<18)}),V.prototype.destroy=_.destroy,V.prototype._undestroy=_.undestroy,V.prototype._destroy=function(e,t){t(e)},V.prototype[p.captureRejectionSymbol]=function(e){this.destroy(e)},V.prototype[u]=function(){let e;return this.destroyed||(e=this.readableEnded?null:new R,this.destroy(e)),new l((t,n)=>y(this,r=>r&&r!==e?n(r):t(null)))},V.prototype.push=function(e,t){return W(this,e,t,!1)},V.prototype.unshift=function(e,t){return W(this,e,t,!0)},V.prototype.isPaused=function(){const e=this._readableState;return!0===e[A]||!1===e.flowing},V.prototype.setEncoding=function(e){const t=new O(e);this._readableState.decoder=t,this._readableState.encoding=this._readableState.decoder.encoding;const n=this._readableState.buffer;let r="";for(const e of n)r+=t.write(e);return n.clear(),""!==r&&n.push(r),this._readableState.length=r.length,this},V.prototype.read=function(e){v("read",e),void 0===e?e=NaN:n(e)||(e=i(e,10));const t=this._readableState,r=e;if(e>t.highWaterMark&&(t.highWaterMark=function(e){if(e>1073741824)throw new T("size","<= 1GiB",e);return e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,++e}(e)),0!==e&&(t.state&=-129),0===e&&t.needReadable&&((0!==t.highWaterMark?t.length>=t.highWaterMark:t.length>0)||t.ended))return v("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?ie(this):J(this),null;if(0===(e=z(e,t))&&t.ended)return 0===t.length&&ie(this),null;let s,o=!!(64&t.state);if(v("need readable",o),(0===t.length||t.length-e<t.highWaterMark)&&(o=!0,v("length less than watermark",o)),t.ended||t.reading||t.destroyed||t.errored||!t.constructed)o=!1,v("reading, ended or constructing",o);else if(o){v("do read"),t.state|=8|F,0===t.length&&(t.state|=64);try{this._read(t.highWaterMark)}catch(e){D(this,e)}t.state&=~F,t.reading||(e=z(r,t))}return s=e>0?re(e,t):null,null===s?(t.needReadable=t.length<=t.highWaterMark,e=0):(t.length-=e,t.multiAwaitDrain?t.awaitDrainWriters.clear():t.awaitDrainWriters=null),0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&ie(this)),null!==s&&!t.errorEmitted&&!t.closeEmitted&&(t.dataEmitted=!0,this.emit("data",s)),s},V.prototype._read=function(e){throw new j("_read()")},V.prototype.pipe=function(t,n){const r=this,i=this._readableState;1===i.pipes.length&&(i.multiAwaitDrain||(i.multiAwaitDrain=!0,i.awaitDrainWriters=new c(i.awaitDrainWriters?[i.awaitDrainWriters]:[]))),i.pipes.push(t),v("pipe count=%d opts=%j",i.pipes.length,n);const s=n&&!1===n.end||t===e.stdout||t===e.stderr?m:o;function o(){v("onend"),t.end()}i.endEmitted?e.nextTick(s):r.once("end",s),t.on("unpipe",function e(n,s){v("onunpipe"),n===r&&s&&!1===s.hasUnpiped&&(s.hasUnpiped=!0,v("cleanup"),t.removeListener("close",p),t.removeListener("finish",f),a&&t.removeListener("drain",a),t.removeListener("error",h),t.removeListener("unpipe",e),r.removeListener("end",o),r.removeListener("end",m),r.removeListener("data",d),l=!0,a&&i.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&a())});let a,l=!1;function u(){l||(1===i.pipes.length&&i.pipes[0]===t?(v("false write response, pause",0),i.awaitDrainWriters=t,i.multiAwaitDrain=!1):i.pipes.length>1&&i.pipes.includes(t)&&(v("false write response, pause",i.awaitDrainWriters.size),i.awaitDrainWriters.add(t)),r.pause()),a||(a=function(e,t){return function(){const n=e._readableState;n.awaitDrainWriters===t?(v("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(v("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(t)),(!n.awaitDrainWriters||0===n.awaitDrainWriters.size)&&e.listenerCount("data")&&e.resume()}}(r,t),t.on("drain",a))}function d(e){v("ondata");const n=t.write(e);v("dest.write",n),!1===n&&u()}function h(e){if(v("onerror",e),m(),t.removeListener("error",h),0===t.listenerCount("error")){const n=t._writableState||t._readableState;n&&!n.errorEmitted?D(t,e):t.emit("error",e)}}function p(){t.removeListener("finish",f),m()}function f(){v("onfinish"),t.removeListener("close",p),m()}function m(){v("unpipe"),r.unpipe(t)}return r.on("data",d),g(t,"error",h),t.once("close",p),t.once("finish",f),t.emit("pipe",r),!0===t.writableNeedDrain?u():i.flowing||(v("pipe resume"),r.resume()),t},V.prototype.unpipe=function(e){const n=this._readableState;if(0===n.pipes.length)return this;if(!e){const e=n.pipes;n.pipes=[],this.pause();for(let t=0;t<e.length;t++)e[t].emit("unpipe",this,{hasUnpiped:!1});return this}const r=t(n.pipes,e);return-1===r||(n.pipes.splice(r,1),0===n.pipes.length&&this.pause(),e.emit("unpipe",this,{hasUnpiped:!1})),this},V.prototype.on=function(t,n){const r=f.prototype.on.call(this,t,n),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&!i.endEmitted&&!i.readableListening&&(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,v("on readable",i.length,i.reading),i.length?J(this):i.reading||e.nextTick(Z,this)),r},V.prototype.addListener=V.prototype.on,V.prototype.removeListener=function(t,n){const r=f.prototype.removeListener.call(this,t,n);return"readable"===t&&e.nextTick(Y,this),r},V.prototype.off=V.prototype.removeListener,V.prototype.removeAllListeners=function(t){const n=f.prototype.removeAllListeners.apply(this,arguments);return("readable"===t||void 0===t)&&e.nextTick(Y,this),n},V.prototype.resume=function(){const t=this._readableState;return t.flowing||(v("resume"),t.flowing=!t.readableListening,function(t,n){n.resumeScheduled||(n.resumeScheduled=!0,e.nextTick(ee,t,n))}(this,t)),t[A]=!1,this},V.prototype.pause=function(){return v("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(v("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[A]=!0,this},V.prototype.wrap=function(e){let t=!1;e.on("data",n=>{!this.push(n)&&e.pause&&(t=!0,e.pause())}),e.on("end",()=>{this.push(null)}),e.on("error",e=>{D(this,e)}),e.on("close",()=>{this.destroy()}),e.on("destroy",()=>{this.destroy()}),this._read=()=>{t&&e.resume&&(t=!1,e.resume())};const n=o(e);for(let t=1;t<n.length;t++){const r=n[t];void 0===this[r]&&"function"==typeof e[r]&&(this[r]=e[r].bind(e))}return this},V.prototype[d]=function(){return ne(this)},V.prototype.iterator=function(e){return void 0!==e&&C(e,"options"),ne(this,e)},s(V.prototype,{readable:{__proto__:null,get(){const e=this._readableState;return!(!e||!1===e.readable||e.destroyed||e.errorEmitted||e.endEmitted)},set(e){this._readableState&&(this._readableState.readable=!!e)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._readableState.readable||!this._readableState.destroyed&&!this._readableState.errored||this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.objectMode}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return!!this._readableState&&this._readableState.closed}},destroyed:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.destroyed},set(e){this._readableState&&(this._readableState.destroyed=e)}},readableEnded:{__proto__:null,enumerable:!1,get(){return!!this._readableState&&this._readableState.endEmitted}}}),s(H.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return!1!==this[A]},set(e){this[A]=!!e}}}),V._fromList=re,V.from=function(e,t){return L(V,e,t)},V.fromWeb=function(e,t){return le().newStreamReadableFromReadableStream(e,t)},V.toWeb=function(e,t){return le().newReadableStreamFromStreamReadable(e,t)},V.wrap=function(e,t){var n,r;return new V({objectMode:null===(n=null!==(r=e.readableObjectMode)&&void 0!==r?r:e.objectMode)||void 0===n||n,...t,destroy(t,n){_.destroyer(e,t),n(t)}}).wrap(e)},Fi}function ba(){if(So)return ki;So=1;const e=pr(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:i,ObjectDefineProperties:s,ObjectSetPrototypeOf:o,StringPrototypeToLowerCase:a,Symbol:l,SymbolHasInstance:c}=Be();ki=C,C.WritableState=k;const{EventEmitter:u}=ai(),d=ya().Stream,{Buffer:h}=Ct(),p=jr(),{addAbortSignal:f}=oi(),{getHighWaterMark:g,getDefaultHighWaterMark:m}=li(),{ERR_INVALID_ARG_TYPE:b,ERR_METHOD_NOT_IMPLEMENTED:y,ERR_MULTIPLE_CALLBACK:v,ERR_STREAM_CANNOT_PIPE:w,ERR_STREAM_DESTROYED:_,ERR_STREAM_ALREADY_FINISHED:x,ERR_STREAM_NULL_VALUES:S,ERR_STREAM_WRITE_AFTER_END:E,ERR_UNKNOWN_ENCODING:I}=it().codes,{errorOrDestroy:j}=p;function T(){}o(C.prototype,d.prototype),o(C,d);const N=l("kOnFinished");function k(e,t,n){"boolean"!=typeof n&&(n=t instanceof Lt()),this.objectMode=!(!e||!e.objectMode),n&&(this.objectMode=this.objectMode||!(!e||!e.writableObjectMode)),this.highWaterMark=e?g(this,e,"writableHighWaterMark",n):m(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const r=!(!e||!1!==e.decodeStrings);this.decodeStrings=!r,this.defaultEncoding=e&&e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=$.bind(void 0,t),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,R(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!e||!1!==e.emitClose,this.autoDestroy=!e||!1!==e.autoDestroy,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[N]=[]}function R(e){e.buffered=[],e.bufferedIndex=0,e.allBuffers=!0,e.allNoop=!0}function C(e){const t=this instanceof Lt();if(!t&&!r(C,this))return new C(e);this._writableState=new k(e,this,t),e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final),"function"==typeof e.construct&&(this._construct=e.construct),e.signal&&f(e.signal,this)),d.call(this,e),p.construct(this,()=>{const e=this._writableState;e.writing||F(this,e),U(this,e)})}function A(t,n,r,i){const s=t._writableState;if("function"==typeof r)i=r,r=s.defaultEncoding;else{if(r){if("buffer"!==r&&!h.isEncoding(r))throw new I(r)}else r=s.defaultEncoding;"function"!=typeof i&&(i=T)}if(null===n)throw new S;if(!s.objectMode)if("string"==typeof n)!1!==s.decodeStrings&&(n=h.from(n,r),r="buffer");else if(n instanceof h)r="buffer";else{if(!d._isUint8Array(n))throw new b("chunk",["string","Buffer","Uint8Array"],n);n=d._uint8ArrayToBuffer(n),r="buffer"}let o;return s.ending?o=new E:s.destroyed&&(o=new _("write")),o?(e.nextTick(i,o),j(t,o,!0),o):(s.pendingcb++,function(e,t,n,r,i){const s=t.objectMode?1:n.length;t.length+=s;const o=t.length<t.highWaterMark;return o||(t.needDrain=!0),t.writing||t.corked||t.errored||!t.constructed?(t.buffered.push({chunk:n,encoding:r,callback:i}),t.allBuffers&&"buffer"!==r&&(t.allBuffers=!1),t.allNoop&&i!==T&&(t.allNoop=!1)):(t.writelen=s,t.writecb=i,t.writing=!0,t.sync=!0,e._write(n,r,t.onwrite),t.sync=!1),o&&!t.errored&&!t.destroyed}(t,s,n,r,i))}function O(e,t,n,r,i,s,o){t.writelen=r,t.writecb=o,t.writing=!0,t.sync=!0,t.destroyed?t.onwrite(new _("write")):n?e._writev(i,t.onwrite):e._write(i,s,t.onwrite),t.sync=!1}function L(e,t,n,r){--t.pendingcb,r(n),M(t),j(e,n)}function $(t,n){const r=t._writableState,i=r.sync,s=r.writecb;"function"==typeof s?(r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,n?(n.stack,r.errored||(r.errored=n),t._readableState&&!t._readableState.errored&&(t._readableState.errored=n),i?e.nextTick(L,t,r,n,s):L(t,r,n,s)):(r.buffered.length>r.bufferedIndex&&F(t,r),i?null!==r.afterWriteTickInfo&&r.afterWriteTickInfo.cb===s?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:s,stream:t,state:r},e.nextTick(D,r.afterWriteTickInfo)):P(t,r,1,s))):j(t,new v)}function D({stream:e,state:t,count:n,cb:r}){return t.afterWriteTickInfo=null,P(e,t,n,r)}function P(e,t,n,r){for(!t.ending&&!e.destroyed&&0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"));n-- >0;)t.pendingcb--,r();t.destroyed&&M(t),U(e,t)}function M(e){if(e.writing)return;for(let n=e.bufferedIndex;n<e.buffered.length;++n){var t;const{chunk:r,callback:i}=e.buffered[n],s=e.objectMode?1:r.length;e.length-=s,i(null!==(t=e.errored)&&void 0!==t?t:new _("write"))}const n=e[N].splice(0);for(let t=0;t<n.length;t++){var r;n[t](null!==(r=e.errored)&&void 0!==r?r:new _("end"))}R(e)}function F(e,n){if(n.corked||n.bufferProcessing||n.destroyed||!n.constructed)return;const{buffered:r,bufferedIndex:i,objectMode:s}=n,o=r.length-i;if(!o)return;let a=i;if(n.bufferProcessing=!0,o>1&&e._writev){n.pendingcb-=o-1;const i=n.allNoop?T:e=>{for(let t=a;t<r.length;++t)r[t].callback(e)},s=n.allNoop&&0===a?r:t(r,a);s.allBuffers=n.allBuffers,O(e,n,!0,n.length,s,"",i),R(n)}else{do{const{chunk:t,encoding:i,callback:o}=r[a];r[a++]=null,O(e,n,!1,s?1:t.length,t,i,o)}while(a<r.length&&!n.writing);a===r.length?R(n):a>256?(r.splice(0,a),n.bufferedIndex=0):n.bufferedIndex=a}n.bufferProcessing=!1}function B(e){return e.ending&&!e.destroyed&&e.constructed&&0===e.length&&!e.errored&&0===e.buffered.length&&!e.finished&&!e.writing&&!e.errorEmitted&&!e.closeEmitted}function U(t,n,r){B(n)&&(function(t,n){!n.prefinished&&!n.finalCalled&&("function"!=typeof t._final||n.destroyed?(n.prefinished=!0,t.emit("prefinish")):(n.finalCalled=!0,function(t,n){let r=!1;function i(i){if(r)j(t,i??v());else if(r=!0,n.pendingcb--,i){const e=n[N].splice(0);for(let t=0;t<e.length;t++)e[t](i);j(t,i,n.sync)}else B(n)&&(n.prefinished=!0,t.emit("prefinish"),n.pendingcb++,e.nextTick(q,t,n))}n.sync=!0,n.pendingcb++;try{t._final(i)}catch(e){i(e)}n.sync=!1}(t,n)))}(t,n),0===n.pendingcb&&(r?(n.pendingcb++,e.nextTick((e,t)=>{B(t)?q(e,t):t.pendingcb--},t,n)):B(n)&&(n.pendingcb++,q(t,n))))}function q(e,t){t.pendingcb--,t.finished=!0;const n=t[N].splice(0);for(let e=0;e<n.length;e++)n[e]();if(e.emit("finish"),t.autoDestroy){const t=e._readableState;(!t||t.autoDestroy&&(t.endEmitted||!1===t.readable))&&e.destroy()}}k.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},i(k.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}}),i(C,c,{__proto__:null,value:function(e){return!!r(this,e)||this===C&&e&&e._writableState instanceof k}}),C.prototype.pipe=function(){j(this,new w)},C.prototype.write=function(e,t,n){return!0===A(this,e,t,n)},C.prototype.cork=function(){this._writableState.corked++},C.prototype.uncork=function(){const e=this._writableState;e.corked&&(e.corked--,e.writing||F(this,e))},C.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=a(e)),!h.isEncoding(e))throw new I(e);return this._writableState.defaultEncoding=e,this},C.prototype._write=function(e,t,n){if(!this._writev)throw new y("_write()");this._writev([{chunk:e,encoding:t}],n)},C.prototype._writev=null,C.prototype.end=function(t,r,i){const s=this._writableState;let o;if("function"==typeof t?(i=t,t=null,r=null):"function"==typeof r&&(i=r,r=null),null!=t){const e=A(this,t,r);e instanceof n&&(o=e)}return s.corked&&(s.corked=1,this.uncork()),o||(s.errored||s.ending?s.finished?o=new x("end"):s.destroyed&&(o=new _("end")):(s.ending=!0,U(this,s,!0),s.ended=!0)),"function"==typeof i&&(o||s.finished?e.nextTick(i,o):s[N].push(i)),this},s(C.prototype,{closed:{__proto__:null,get(){return!!this._writableState&&this._writableState.closed}},destroyed:{__proto__:null,get(){return!!this._writableState&&this._writableState.destroyed},set(e){this._writableState&&(this._writableState.destroyed=e)}},writable:{__proto__:null,get(){const e=this._writableState;return!(!e||!1===e.writable||e.destroyed||e.errored||e.ending||e.ended)},set(e){this._writableState&&(this._writableState.writable=!!e)}},writableFinished:{__proto__:null,get(){return!!this._writableState&&this._writableState.finished}},writableObjectMode:{__proto__:null,get(){return!!this._writableState&&this._writableState.objectMode}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return!!this._writableState&&this._writableState.ending}},writableNeedDrain:{__proto__:null,get(){const e=this._writableState;return!!e&&!e.destroyed&&!e.ending&&e.needDrain}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!(!1===this._writableState.writable||!this._writableState.destroyed&&!this._writableState.errored||this._writableState.finished)}}});const H=p.destroy;let V;function W(){return void 0===V&&(V={}),V}return C.prototype.destroy=function(t,n){const r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[N].length)&&e.nextTick(M,r),H.call(this,t,n),this},C.prototype._undestroy=p.undestroy,C.prototype._destroy=function(e,t){t(e)},C.prototype[u.captureRejectionSymbol]=function(e){this.destroy(e)},C.fromWeb=function(e,t){return W().newStreamWritableFromWritableStream(e,t)},C.toWeb=function(e){return W().newWritableStreamFromStreamWritable(e)},ki}function Id(){if(Io)return Pi;Io=1;const e=pr(),t=Ct(),{isReadable:n,isWritable:r,isIterable:i,isNodeStream:s,isReadableNodeStream:o,isWritableNodeStream:a,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=jt(),d=zt(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:p,ERR_INVALID_RETURN_VALUE:f}}=it(),{destroyer:g}=jr(),m=Lt(),b=ui(),y=ba(),{createDeferredPromise:v}=at(),w=ec(),_=globalThis.Blob||t.Blob,x=typeof _<"u"?function(e){return e instanceof _}:function(e){return!1},S=globalThis.AbortController||xn().AbortController,{FunctionPrototypeCall:E}=Be();class I extends m{constructor(e){super(e),!1===e?.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e?.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}function j(e){const t=e.readable&&"function"!=typeof e.readable.read?b.wrap(e.readable):e.readable,i=e.writable;let s,o,a,l,c,u=!!n(t),p=!!r(i);function f(e){const t=l;l=null,t?t(e):e&&c.destroy(e)}return c=new I({readableObjectMode:!(null==t||!t.readableObjectMode),writableObjectMode:!(null==i||!i.writableObjectMode),readable:u,writable:p}),p&&(d(i,e=>{p=!1,e&&g(t,e),f(e)}),c._write=function(e,t,n){i.write(e,t)?n():s=n},c._final=function(e){i.end(),o=e},i.on("drain",function(){if(s){const e=s;s=null,e()}}),i.on("finish",function(){if(o){const e=o;o=null,e()}})),u&&(d(t,e=>{u=!1,e&&g(t,e),f(e)}),t.on("readable",function(){if(a){const e=a;a=null,e()}}),t.on("end",function(){c.push(null)}),c._read=function(){for(;;){const e=t.read();if(null===e)return void(a=c._read);if(!c.push(e))return}}),c._destroy=function(e,n){!e&&null!==l&&(e=new h),a=null,s=null,o=null,null===l?n(e):(l=n,g(i,e),g(t,e))},c}return Pi=function t(n,r){if(l(n))return n;if(o(n))return j({readable:n});if(a(n))return j({writable:n});if(s(n))return j({writable:!1,readable:!1});if(c(n))return j({readable:b.fromWeb(n)});if(u(n))return j({writable:y.fromWeb(n)});if("function"==typeof n){const{value:t,write:s,final:o,destroy:a}=function(t){let{promise:n,resolve:r}=v();const i=new S,s=i.signal;return{value:t(async function*(){for(;;){const t=n;n=null;const{chunk:i,done:o,cb:a}=await t;if(e.nextTick(a),o)return;if(s.aborted)throw new h(void 0,{cause:s.reason});({promise:n,resolve:r}=v()),yield i}}(),{signal:s}),write(e,t,n){const i=r;r=null,i({chunk:e,done:!1,cb:n})},final(e){const t=r;r=null,t({done:!0,cb:e})},destroy(e,t){i.abort(),t(e)}}}(n);if(i(t))return w(I,t,{objectMode:!0,write:s,final:o,destroy:a});const l=t?.then;if("function"==typeof l){let n;const r=E(l,t,e=>{if(null!=e)throw new f("nully","body",e)},e=>{g(n,e)});return n=new I({objectMode:!0,readable:!1,write:s,final(t){o(async()=>{try{await r,e.nextTick(t,null)}catch(n){e.nextTick(t,n)}})},destroy:a})}throw new f("Iterable, AsyncIterable or AsyncFunction",r,t)}if(x(n))return t(n.arrayBuffer());if(i(n))return w(I,n,{objectMode:!0,writable:!1});if(c(n?.readable)&&u(n?.writable))return I.fromWeb(n);if("object"==typeof n?.writable||"object"==typeof n?.readable)return j({readable:null!=n&&n.readable?o(n?.readable)?n?.readable:t(n.readable):void 0,writable:null!=n&&n.writable?a(n?.writable)?n?.writable:t(n.writable):void 0});const d=n?.then;if("function"==typeof d){let e;return E(d,n,t=>{null!=t&&e.push(t),e.push(null)},t=>{g(e,t)}),e=new I({objectMode:!0,writable:!1,read(){}})}throw new p(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],n)}}function Lt(){if(No)return Mi;No=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=Be();Mi=o;const i=ui(),s=ba();r(o.prototype,i.prototype),r(o,i);{const e=n(s.prototype);for(let t=0;t<e.length;t++){const n=e[t];o.prototype[n]||(o.prototype[n]=s.prototype[n])}}function o(e){if(!(this instanceof o))return new o(e);i.call(this,e),s.call(this,e),e?(this.allowHalfOpen=!1!==e.allowHalfOpen,!1===e.readable&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),!1===e.writable&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}let a,l;function c(){return void 0===a&&(a={}),a}return e(o.prototype,{writable:{__proto__:null,...t(s.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(s.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(s.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(s.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(s.prototype,"writableLength")},writableFinished:{__proto__:null,...t(s.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(s.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(s.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(s.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return void 0!==this._readableState&&void 0!==this._writableState&&this._readableState.destroyed&&this._writableState.destroyed},set(e){this._readableState&&this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}}),o.fromWeb=function(e,t){return c().newStreamDuplexFromReadableWritablePair(e,t)},o.toWeb=function(e){return c().newReadableWritablePairFromDuplex(e)},o.from=function(e){return l||(l=Id()),l(e,"body")},Mi}function tc(){if(Ro)return Bi;Ro=1;const{ObjectSetPrototypeOf:e,Symbol:t}=Be();Bi=o;const{ERR_METHOD_NOT_IMPLEMENTED:n}=it().codes,r=Lt(),{getHighWaterMark:i}=li();e(o.prototype,r.prototype),e(o,r);const s=t("kCallback");function o(e){if(!(this instanceof o))return new o(e);const t=e?i(this,e,"readableHighWaterMark",!0):null;0===t&&(e={...e,highWaterMark:null,readableHighWaterMark:t,writableHighWaterMark:e.writableHighWaterMark||0}),r.call(this,e),this._readableState.sync=!1,this[s]=null,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.on("prefinish",l)}function a(e){"function"!=typeof this._flush||this.destroyed?(this.push(null),e&&e()):this._flush((t,n)=>{t?e?e(t):this.destroy(t):(null!=n&&this.push(n),this.push(null),e&&e())})}function l(){this._final!==a&&a.call(this)}return o.prototype._final=a,o.prototype._transform=function(e,t,r){throw new n("_transform()")},o.prototype._write=function(e,t,n){const r=this._readableState,i=this._writableState,o=r.length;this._transform(e,t,(e,t)=>{e?n(e):(null!=t&&this.push(t),i.ended||o===r.length||r.length<r.highWaterMark?n():this[s]=n)})},o.prototype._read=function(){if(this[s]){const e=this[s];this[s]=null,e()}},Bi}function rc(){if(To)return qi;To=1;const{ObjectSetPrototypeOf:e}=Be();qi=n;const t=tc();function n(e){if(!(this instanceof n))return new n(e);t.call(this,e)}return e(n.prototype,t.prototype),e(n,t),n.prototype._transform=function(e,t,n){n(null,e)},qi}function _a(){if(Ao)return Ui;Ao=1;const e=pr(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:i}=Be(),s=zt(),{once:o}=at(),a=jr(),l=Lt(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:p,ERR_STREAM_PREMATURE_CLOSE:f},AbortError:g}=it(),{validateFunction:m,validateAbortSignal:b}=Nn(),{isIterable:y,isReadable:v,isReadableNodeStream:w,isNodeStream:_,isTransformStream:x,isWebStream:S,isReadableStream:E,isReadableFinished:I}=jt(),j=globalThis.AbortController||xn().AbortController;let T,N,k;function R(e,t,n){let r=!1;return e.on("close",()=>{r=!0}),{destroy:t=>{r||(r=!0,a.destroyer(e,t||new p("pipe")))},cleanup:s(e,{readable:t,writable:n},e=>{r=!e})}}function C(e){if(y(e))return e;if(w(e))return async function*(e){N||(N=ui()),yield*N.prototype[r].call(e)}(e);throw new u("val",["Readable","Iterable","AsyncIterable"],e)}async function A(e,t,r,{end:i}){let o,a=null;const l=e=>{if(e&&(o=e),a){const e=a;a=null,e()}},u=()=>new n((e,t)=>{o?t(o):a=()=>{o?t(o):e()}});t.on("drain",l);const d=s(t,{readable:!1},l);try{t.writableNeedDrain&&await u();for await(const n of e)t.write(n)||await u();i&&(t.end(),await u()),r()}catch(e){r(o!==e?c(o,e):e)}finally{d(),t.off("drain",l)}}async function O(e,t,n,{end:r}){x(t)&&(t=t.writable);const i=t.getWriter();try{for await(const t of e)await i.ready,i.write(t).catch(()=>{});await i.ready,r&&await i.close(),n()}catch(e){try{await i.abort(e),n(e)}catch(e){n(e)}}}function L(n,r,s){if(1===n.length&&t(n[0])&&(n=n[0]),n.length<2)throw new h("streams");const o=new j,a=o.signal,c=s?.signal,p=[];function f(){F(new g)}let m,I,N;b(c,"options.signal"),k=k||at().addAbortListener,c&&(m=k(c,f));const L=[];let D,P=0;function M(e){F(e,0===--P)}function F(t,n){var s;if(t&&(!I||"ERR_STREAM_PREMATURE_CLOSE"===I.code)&&(I=t),I||n){for(;L.length;)L.shift()(I);null===(s=m)||void 0===s||s[i](),o.abort(),n&&(I||p.forEach(e=>e()),e.nextTick(r,I,N))}}for(let t=0;t<n.length;t++){const r=n[t],i=t<n.length-1,o=t>0,c=i||!1!==s?.end,h=t===n.length-1;if(_(r)){let e=function(e){e&&"AbortError"!==e.name&&"ERR_STREAM_PREMATURE_CLOSE"!==e.code&&M(e)};if(c){const{destroy:e,cleanup:t}=R(r,i,o);L.push(e),v(r)&&h&&p.push(t)}r.on("error",e),v(r)&&h&&p.push(()=>{r.removeListener("error",e)})}if(0===t)if("function"==typeof r){if(D=r({signal:a}),!y(D))throw new d("Iterable, AsyncIterable or Stream","source",D)}else D=y(r)||w(r)||x(r)?r:l.from(r);else if("function"==typeof r){var B;if(D=x(D)?C(null===(B=D)||void 0===B?void 0:B.readable):C(D),D=r(D,{signal:a}),i){if(!y(D,!0))throw new d("AsyncIterable",`transform[${t-1}]`,D)}else{var U;T||(T=rc());const t=new T({objectMode:!0}),n=null===(U=D)||void 0===U?void 0:U.then;if("function"==typeof n)P++,n.call(D,n=>{N=n,null!=n&&t.write(n),c&&t.end(),e.nextTick(M)},n=>{t.destroy(n),e.nextTick(M,n)});else if(y(D,!0))P++,A(D,t,M,{end:c});else{if(!E(D)&&!x(D))throw new d("AsyncIterable or Promise","destination",D);{const e=D.readable||D;P++,A(e,t,M,{end:c})}}D=t;const{destroy:r,cleanup:i}=R(D,!1,!0);L.push(r),h&&p.push(i)}}else if(_(r)){if(w(D)){P+=2;const e=$(D,r,M,{end:c});v(r)&&h&&p.push(e)}else if(x(D)||E(D)){const e=D.readable||D;P++,A(e,r,M,{end:c})}else{if(!y(D))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],D);P++,A(D,r,M,{end:c})}D=r}else if(S(r)){if(w(D))P++,O(C(D),r,M,{end:c});else if(E(D)||y(D))P++,O(D,r,M,{end:c});else{if(!x(D))throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],D);P++,O(D.readable,r,M,{end:c})}D=r}else D=l.from(r)}return(null!=a&&a.aborted||null!=c&&c.aborted)&&e.nextTick(f),D}function $(t,n,r,{end:i}){let o=!1;if(n.on("close",()=>{o||r(new f)}),t.pipe(n,{end:!1}),i){let r=function(){o=!0,n.end()};I(t)?e.nextTick(r):t.once("end",r)}else r();return s(t,{readable:!0,writable:!1},e=>{const n=t._readableState;e&&"ERR_STREAM_PREMATURE_CLOSE"===e.code&&n&&n.ended&&!n.errored&&!n.errorEmitted?t.once("end",r).once("error",r):r(e)}),s(n,{readable:!1,writable:!0},r)}return Ui={pipelineImpl:L,pipeline:function(...e){return L(e,o(function(e){return m(e[e.length-1],"streams[stream.length - 1]"),e.pop()}(e)))}}}function nc(){if(Do)return Hi;Do=1;const{pipeline:e}=_a(),t=Lt(),{destroyer:n}=jr(),{isNodeStream:r,isReadable:i,isWritable:s,isWebStream:o,isTransformStream:a,isWritableStream:l,isReadableStream:c}=jt(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=it(),p=zt();return Hi=function(...f){if(0===f.length)throw new h("streams");if(1===f.length)return t.from(f[0]);const g=[...f];if("function"==typeof f[0]&&(f[0]=t.from(f[0])),"function"==typeof f[f.length-1]){const e=f.length-1;f[e]=t.from(f[e])}for(let e=0;e<f.length;++e)if(r(f[e])||o(f[e])){if(e<f.length-1&&!(i(f[e])||c(f[e])||a(f[e])))throw new d(`streams[${e}]`,g[e],"must be readable");if(e>0&&!(s(f[e])||l(f[e])||a(f[e])))throw new d(`streams[${e}]`,g[e],"must be writable")}let m,b,y,v,w;const _=f[0],x=e(f,function(e){const t=v;v=null,t?t(e):e?w.destroy(e):!E&&!S&&w.destroy()}),S=!!(s(_)||l(_)||a(_)),E=!!(i(x)||c(x)||a(x));if(w=new t({writableObjectMode:!(null==_||!_.writableObjectMode),readableObjectMode:!(null==x||!x.readableObjectMode),writable:S,readable:E}),S){if(r(_))w._write=function(e,t,n){_.write(e,t)?n():m=n},w._final=function(e){_.end(),b=e},_.on("drain",function(){if(m){const e=m;m=null,e()}});else if(o(_)){const e=(a(_)?_.writable:_).getWriter();w._write=async function(t,n,r){try{await e.ready,e.write(t).catch(()=>{}),r()}catch(e){r(e)}},w._final=async function(t){try{await e.ready,e.close().catch(()=>{}),b=t}catch(e){t(e)}}}const e=a(x)?x.readable:x;p(e,()=>{if(b){const e=b;b=null,e()}})}if(E)if(r(x))x.on("readable",function(){if(y){const e=y;y=null,e()}}),x.on("end",function(){w.push(null)}),w._read=function(){for(;;){const e=x.read();if(null===e)return void(y=w._read);if(!w.push(e))return}};else if(o(x)){const e=(a(x)?x.readable:x).getReader();w._read=async function(){for(;;)try{const{value:t,done:n}=await e.read();if(!w.push(t))return;if(n)return void w.push(null)}catch{return}}}return w._destroy=function(e,t){!e&&null!==v&&(e=new u),y=null,m=null,b=null,null===v?t(e):(v=t,r(x)&&n(x,e))},w}}function Nd(){if(Lo)return Mn;Lo=1;const e=globalThis.AbortController||xn().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:i},AbortError:s}=it(),{validateAbortSignal:o,validateInteger:a,validateObject:l}=Nn(),c=Be().Symbol("kWeak"),u=Be().Symbol("kResistStopPropagation"),{finished:d}=zt(),h=nc(),{addAbortSignalNoValidate:p}=oi(),{isWritable:f,isNodeStream:g}=jt(),{deprecate:m}=at(),{ArrayPrototypePush:b,Boolean:y,MathFloor:v,Number:w,NumberIsNaN:_,Promise:x,PromiseReject:S,PromiseResolve:E,PromisePrototypeThen:I,Symbol:j}=Be(),T=j("kEmpty"),N=j("kEof");function k(e,t){if("function"!=typeof e)throw new n("fn",["Function","AsyncFunction"],e);null!=t&&l(t,"options"),null!=t?.signal&&o(t.signal,"options.signal");let r=1;null!=t?.concurrency&&(r=v(t.concurrency));let i=r-1;return null!=t?.highWaterMark&&(i=v(t.highWaterMark)),a(r,"options.concurrency",1),a(i,"options.highWaterMark",0),i+=r,async function*(){const n=at().AbortSignalAny([t?.signal].filter(y)),o=this,a=[],l={signal:n};let c,u,d=!1,h=0;function p(){d=!0,f()}function f(){h-=1,g()}function g(){u&&!d&&h<r&&a.length<i&&(u(),u=null)}!async function(){try{for await(let t of o){if(d)return;if(n.aborted)throw new s;try{if(t=e(t,l),t===T)continue;t=E(t)}catch(e){t=S(e)}h+=1,I(t,f,p),a.push(t),c&&(c(),c=null),!d&&(a.length>=i||h>=r)&&await new x(e=>{u=e})}a.push(N)}catch(e){const t=S(e);I(t,f,p),a.push(t)}finally{d=!0,c&&(c(),c=null)}}();try{for(;;){for(;a.length>0;){const e=await a[0];if(e===N)return;if(n.aborted)throw new s;e!==T&&(yield e),a.shift(),g()}await new x(e=>{c=e})}}finally{d=!0,u&&(u(),u=null)}}.call(this)}async function R(e,t=void 0){for await(const n of C.call(this,e,t))return!0;return!1}function C(e,t){if("function"!=typeof e)throw new n("fn",["Function","AsyncFunction"],e);return k.call(this,async function(t,n){return await e(t,n)?t:T},t)}class A extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}function O(e){if(e=w(e),_(e))return 0;if(e<0)throw new i("number",">= 0",e);return e}return Mn.streamReturningOperators={asIndexedPairs:m(function(e=void 0){return null!=e&&l(e,"options"),null!=e?.signal&&o(e.signal,"options.signal"),async function*(){let t=0;for await(const r of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new s({cause:e.signal.reason});yield[t++,r]}}.call(this)},"readable.asIndexedPairs will be removed in a future version."),drop:function(e,t=void 0){return null!=t&&l(t,"options"),null!=t?.signal&&o(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new s;for await(const n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new s;e--<=0&&(yield n)}}.call(this)},filter:C,flatMap:function(e,t){const n=k.call(this,e,t);return async function*(){for await(const e of n)yield*e}.call(this)},map:k,take:function(e,t=void 0){return null!=t&&l(t,"options"),null!=t?.signal&&o(t.signal,"options.signal"),e=O(e),async function*(){var n;if(null!=t&&null!==(n=t.signal)&&void 0!==n&&n.aborted)throw new s;for await(const n of this){var r;if(null!=t&&null!==(r=t.signal)&&void 0!==r&&r.aborted)throw new s;if(e-- >0&&(yield n),e<=0)return}}.call(this)},compose:function(e,n){if(null!=n&&l(n,"options"),null!=n?.signal&&o(n.signal,"options.signal"),g(e)&&!f(e))throw new t("stream",e,"must be writable");const r=h(this,e);return null!=n&&n.signal&&p(n.signal,r),r}},Mn.promiseReturningOperators={every:async function(e,t=void 0){if("function"!=typeof e)throw new n("fn",["Function","AsyncFunction"],e);return!await R.call(this,async(...t)=>!await e(...t),t)},forEach:async function(e,t){if("function"!=typeof e)throw new n("fn",["Function","AsyncFunction"],e);for await(const n of k.call(this,async function(t,n){return await e(t,n),T},t));},reduce:async function(t,r,i){var a;if("function"!=typeof t)throw new n("reducer",["Function","AsyncFunction"],t);null!=i&&l(i,"options"),null!=i?.signal&&o(i.signal,"options.signal");let h=arguments.length>1;if(null!=i&&null!==(a=i.signal)&&void 0!==a&&a.aborted){const e=new s(void 0,{cause:i.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(e)),e}const p=new e,f=p.signal;if(null!=i&&i.signal){const e={once:!0,[c]:this,[u]:!0};i.signal.addEventListener("abort",()=>p.abort(),e)}let g=!1;try{for await(const e of this){var m;if(g=!0,null!=i&&null!==(m=i.signal)&&void 0!==m&&m.aborted)throw new s;h?r=await t(r,e,{signal:f}):(r=e,h=!0)}if(!g&&!h)throw new A}finally{p.abort()}return r},toArray:async function(e){null!=e&&l(e,"options"),null!=e?.signal&&o(e.signal,"options.signal");const t=[];for await(const r of this){var n;if(null!=e&&null!==(n=e.signal)&&void 0!==n&&n.aborted)throw new s(void 0,{cause:e.signal.reason});b(t,r)}return t},some:R,find:async function(e,t){for await(const n of C.call(this,e,t))return n}},Mn}function ic(){if(Oo)return Vi;Oo=1;const{ArrayPrototypePop:e,Promise:t}=Be(),{isIterable:n,isNodeStream:r,isWebStream:i}=jt(),{pipelineImpl:s}=_a(),{finished:o}=zt();return sc(),Vi={finished:o,pipeline:function(...o){return new t((t,a)=>{let l,c;const u=o[o.length-1];if(u&&"object"==typeof u&&!r(u)&&!n(u)&&!i(u)){const t=e(o);l=t.signal,c=t.end}s(o,(e,n)=>{e?a(e):t(n)},{signal:l,end:c})})}}}function sc(){if(Co)return vi.exports;Co=1;const{Buffer:e}=Ct(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=Be(),{promisify:{custom:i}}=at(),{streamReturningOperators:s,promiseReturningOperators:o}=Nd(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:a}}=it(),l=nc(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=li(),{pipeline:d}=_a(),{destroyer:h}=jr(),p=zt(),f=ic(),g=jt(),m=vi.exports=ya().Stream;m.isDestroyed=g.isDestroyed,m.isDisturbed=g.isDisturbed,m.isErrored=g.isErrored,m.isReadable=g.isReadable,m.isWritable=g.isWritable,m.Readable=ui();for(const e of n(s)){let n=function(...e){if(new.target)throw a();return m.Readable.from(r(i,this,e))};const i=s[e];t(n,"name",{__proto__:null,value:i.name}),t(n,"length",{__proto__:null,value:i.length}),t(m.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})}for(const e of n(o)){let n=function(...e){if(new.target)throw a();return r(i,this,e)};const i=o[e];t(n,"name",{__proto__:null,value:i.name}),t(n,"length",{__proto__:null,value:i.length}),t(m.Readable.prototype,e,{__proto__:null,value:n,enumerable:!1,configurable:!0,writable:!0})}m.Writable=ba(),m.Duplex=Lt(),m.Transform=tc(),m.PassThrough=rc(),m.pipeline=d;const{addAbortSignal:b}=oi();return m.addAbortSignal=b,m.finished=p,m.destroy=h,m.compose=l,m.setDefaultHighWaterMark=c,m.getDefaultHighWaterMark=u,t(m,"promises",{__proto__:null,configurable:!0,enumerable:!0,get:()=>f}),t(d,i,{__proto__:null,enumerable:!0,get:()=>f.pipeline}),t(p,i,{__proto__:null,enumerable:!0,get:()=>f.finished}),m.Stream=m,m._isUint8Array=function(e){return e instanceof Uint8Array},m._uint8ArrayToBuffer=function(t){return e.from(t.buffer,t.byteOffset,t.byteLength)},vi.exports}function ac(){return jo||(jo=1,function(e){const t=sc(),n=ic(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get:()=>n}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(wi)),wi.exports}var wa=ac();const Gi=Symbol("iter");function gn(e,t,n=4){if(0===n)return Object.assign(e,t);for(const r in t)e[r]=gn(e[r]||Object.create(null),t[r],n-1);return e}function oc(e,t,n=4){let r=!1;for(const i in e)if(i in t){const s=0===n?null:oc(e[i],t[i],n-1);if(!1!==s)r=r||Object.create(null),r[i]=s;else if(3===n)return!1}return r}function lc(e,t,n=4){let r=!1;for(const i in e)if(i in t){if(0!==n){const s=lc(e[i],t[i],n-1);if(!1!==s)r=r||Object.create(null),r[i]=s;else if(3===n)return!1}}else r=r||Object.create(null),r[i]=0===n?null:gn({},e[i],n-1);return r}class Rd{constructor(e={}){this._id=1,this._ids=Object.create(null),this._ids[""]=1,this._entities=Object.create(null),this._entities[1]="",this._blankNodeIndex=0,this._factory=e.factory||Ne}_termFromId(e){if("."===e[0]){const t=this._entities,n=e.split(".");return this._factory.quad(this._termFromId(t[n[1]]),this._termFromId(t[n[2]]),this._termFromId(t[n[3]]),n[4]&&this._termFromId(t[n[4]]))}return dn(e,this._factory)}_termToNumericId(e){if("Quad"===e.termType){const t=this._termToNumericId(e.subject),n=this._termToNumericId(e.predicate),r=this._termToNumericId(e.object);let i;return t&&n&&r&&(ia(e.graph)||(i=this._termToNumericId(e.graph)))&&this._ids[i?`.${t}.${n}.${r}.${i}`:`.${t}.${n}.${r}`]}return this._ids[Ir(e)]}_termToNewNumericId(e){const t=e&&"Quad"===e.termType?`.${this._termToNewNumericId(e.subject)}.${this._termToNewNumericId(e.predicate)}.${this._termToNewNumericId(e.object)}${ia(e.graph)?"":`.${this._termToNewNumericId(e.graph)}`}`:Ir(e);return this._ids[t]||(this._ids[this._entities[++this._id]=t]=this._id)}createBlankNode(e){let t,n;if(e)for(t=e=`_:${e}`,n=1;this._ids[t];)t=e+n++;else do{t="_:b"+this._blankNodeIndex++}while(this._ids[t]);return this._ids[t]=++this._id,this._entities[this._id]=t,this._factory.blankNode(t.substr(2))}}class et{constructor(e,t){this._size=0,this._graphs=Object.create(null),!t&&e&&!e[0]&&"function"!=typeof e.match&&(t=e,e=null),t=t||{},this._factory=t.factory||Ne,this._entityIndex=t.entityIndex||new Rd({factory:this._factory}),this._entities=this._entityIndex._entities,this._termFromId=this._entityIndex._termFromId.bind(this._entityIndex),this._termToNumericId=this._entityIndex._termToNumericId.bind(this._entityIndex),this._termToNewNumericId=this._entityIndex._termToNewNumericId.bind(this._entityIndex),e&&this.addAll(e)}get size(){let e=this._size;if(null!==e)return e;e=0;const t=this._graphs;let n,r;for(const i in t)for(const s in n=t[i].subjects)for(const t in r=n[s])e+=Object.keys(r[t]).length;return this._size=e}_addToIndex(e,t,n,r){const i=e[t]||(e[t]={}),s=i[n]||(i[n]={}),o=r in s;return o||(s[r]=null),!o}_removeFromIndex(e,t,n,r){const i=e[t],s=i[n];delete s[r];for(const e in s)return;delete i[n];for(const e in i)return;delete e[t]}*_findInIndex(e,t,n,r,i,s,o,a){let l,c,u;const d=this._entities,h=this._termFromId(d[a]),p={subject:null,predicate:null,object:null};t&&((l=e,e={})[t]=l[t]);for(const t in e)if(c=e[t]){p[i]=this._termFromId(d[t]),n&&((l=c,c={})[n]=l[n]);for(const e in c)if(u=c[e]){p[s]=this._termFromId(d[e]);const t=r?r in u?[r]:[]:Object.keys(u);for(let e=0;e<t.length;e++)p[o]=this._termFromId(d[t[e]]),yield this._factory.quad(p.subject,p.predicate,p.object,h)}}}_loop(e,t){for(const n in e)t(n)}_loopByKey0(e,t,n){let r,i;if(r=e[t])for(i in r)n(i)}_loopByKey1(e,t,n){let r,i;for(r in e)i=e[r],i[t]&&n(r)}_loopBy2Keys(e,t,n,r){let i,s,o;if((i=e[t])&&(s=i[n]))for(o in s)r(o)}_countInIndex(e,t,n,r){let i,s,o,a=0;t&&((i=e,e={})[t]=i[t]);for(const t in e)if(s=e[t]){n&&((i=s,s={})[n]=i[n]);for(const e in s)(o=s[e])&&(r?r in o&&a++:a+=Object.keys(o).length)}return a}_getGraphs(e){return"number"!=typeof(e=""===e?1:e&&(this._termToNumericId(e)||-1))?this._graphs:{[e]:this._graphs[e]}}_uniqueEntities(e){const t=Object.create(null);return n=>{n in t||(t[n]=!0,e(this._termFromId(this._entities[n],this._factory)))}}add(e){return this.addQuad(e),this}addQuad(e,t,n,r){t||(r=e.graph,n=e.object,t=e.predicate,e=e.subject),r=r?this._termToNewNumericId(r):1;let i=this._graphs[r];return i||(i=this._graphs[r]={subjects:{},predicates:{},objects:{}},Object.freeze(i)),e=this._termToNewNumericId(e),t=this._termToNewNumericId(t),n=this._termToNewNumericId(n),!!this._addToIndex(i.subjects,e,t,n)&&(this._addToIndex(i.predicates,t,n,e),this._addToIndex(i.objects,n,e,t),this._size=null,!0)}addQuads(e){for(let t=0;t<e.length;t++)this.addQuad(e[t])}delete(e){return this.removeQuad(e),this}has(e,t,n,r){return e&&e.subject&&({subject:e,predicate:t,object:n,graph:r}=e),!this.readQuads(e,t,n,r).next().done}import(e){return e.on("data",e=>{this.addQuad(e)}),e}removeQuad(e,t,n,r){t||({subject:e,predicate:t,object:n,graph:r}=e),r=r?this._termToNumericId(r):1;const i=this._graphs;let s,o,a;if(!((e=e&&this._termToNumericId(e))&&(t=t&&this._termToNumericId(t))&&(n=n&&this._termToNumericId(n))&&(s=i[r])&&(o=s.subjects[e])&&(a=o[t])&&n in a))return!1;for(e in this._removeFromIndex(s.subjects,e,t,n),this._removeFromIndex(s.predicates,t,n,e),this._removeFromIndex(s.objects,n,e,t),null!==this._size&&this._size--,s.subjects)return!0;return delete i[r],!0}removeQuads(e){for(let t=0;t<e.length;t++)this.removeQuad(e[t])}remove(e){return e.on("data",e=>{this.removeQuad(e)}),e}removeMatches(e,t,n,r){const i=new wa.Readable({objectMode:!0}),s=this.readQuads(e,t,n,r);return i._read=e=>{for(;--e>=0;){const{done:e,value:t}=s.next();if(e)return void i.push(null);i.push(t)}},this.remove(i)}deleteGraph(e){return this.removeMatches(null,null,null,e)}getQuads(e,t,n,r){return[...this.readQuads(e,t,n,r)]}*readQuads(e,t,n,r){const i=this._getGraphs(r);let s,o,a,l;if(!(e&&!(o=this._termToNumericId(e))||t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n))))for(const e in i)(s=i[e])&&(o?l?yield*this._findInIndex(s.objects,l,o,a,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,o,a,null,"subject","predicate","object",e):a?yield*this._findInIndex(s.predicates,a,l,null,"predicate","object","subject",e):l?yield*this._findInIndex(s.objects,l,null,null,"object","subject","predicate",e):yield*this._findInIndex(s.subjects,null,null,null,"subject","predicate","object",e))}match(e,t,n,r){return new qt(this,e,t,n,r,{entityIndex:this._entityIndex})}countQuads(e,t,n,r){const i=this._getGraphs(r);let s,o,a,l,c=0;if(e&&!(o=this._termToNumericId(e))||t&&!(a=this._termToNumericId(t))||n&&!(l=this._termToNumericId(n)))return 0;for(const r in i)(s=i[r])&&(c+=e?n?this._countInIndex(s.objects,l,o,a):this._countInIndex(s.subjects,o,a,l):t?this._countInIndex(s.predicates,a,l,o):this._countInIndex(s.objects,l,o,a));return c}forEach(e,t,n,r,i){this.some(t=>(e(t,this),!1),t,n,r,i)}every(e,t,n,r,i){return!this.some(t=>!e(t,this),t,n,r,i)}some(e,t,n,r,i){for(const s of this.readQuads(t,n,r,i))if(e(s,this))return!0;return!1}getSubjects(e,t,n){const r=[];return this.forSubjects(e=>{r.push(e)},e,t,n),r}forSubjects(e,t,n,r){const i=this._getGraphs(r);let s,o,a;if(e=this._uniqueEntities(e),!(t&&!(o=this._termToNumericId(t))||n&&!(a=this._termToNumericId(n))))for(r in i)(s=i[r])&&(o?a?this._loopBy2Keys(s.predicates,o,a,e):this._loopByKey1(s.subjects,o,e):a?this._loopByKey0(s.objects,a,e):this._loop(s.subjects,e))}getPredicates(e,t,n){const r=[];return this.forPredicates(e=>{r.push(e)},e,t,n),r}forPredicates(e,t,n,r){const i=this._getGraphs(r);let s,o,a;if(e=this._uniqueEntities(e),!(t&&!(o=this._termToNumericId(t))||n&&!(a=this._termToNumericId(n))))for(r in i)(s=i[r])&&(o?a?this._loopBy2Keys(s.objects,a,o,e):this._loopByKey0(s.subjects,o,e):a?this._loopByKey1(s.predicates,a,e):this._loop(s.predicates,e))}getObjects(e,t,n){const r=[];return this.forObjects(e=>{r.push(e)},e,t,n),r}forObjects(e,t,n,r){const i=this._getGraphs(r);let s,o,a;if(e=this._uniqueEntities(e),!(t&&!(o=this._termToNumericId(t))||n&&!(a=this._termToNumericId(n))))for(r in i)(s=i[r])&&(o?a?this._loopBy2Keys(s.subjects,o,a,e):this._loopByKey1(s.objects,o,e):a?this._loopByKey0(s.predicates,a,e):this._loop(s.objects,e))}getGraphs(e,t,n){const r=[];return this.forGraphs(e=>{r.push(e)},e,t,n),r}forGraphs(e,t,n,r){for(const i in this._graphs)this.some(t=>(e(t.graph),!0),t,n,r,this._termFromId(this._entities[i]))}createBlankNode(e){return this._entityIndex.createBlankNode(e)}extractLists({remove:e=!1,ignoreErrors:t=!1}={}){const n={},r=t?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},i=this.getQuads(null,Ke.rdf.rest,Ke.rdf.nil,null),s=e?[...i]:[];return i.forEach(t=>{const i=[];let o,a,l=!1;const c=t.graph;let u=t.subject;for(;u&&!l;){const e=this.getQuads(null,null,u,null),t=this.getQuads(u,null,null,null);let n,d=null,h=null,p=null;for(let i=0;i<t.length&&!l;i++)n=t[i],n.graph.equals(c)?o?l=r(u,"has non-list arcs out"):n.predicate.value===Ke.rdf.first?d?l=r(u,"has multiple rdf:first arcs"):s.push(d=n):n.predicate.value===Ke.rdf.rest?h?l=r(u,"has multiple rdf:rest arcs"):s.push(h=n):e.length?l=r(u,"can't be subject and object"):(o=n,a="subject"):l=r(u,"not confined to single graph");for(let t=0;t<e.length&&!l;++t)n=e[t],o?l=r(u,"can't have coreferences"):n.predicate.value===Ke.rdf.rest?p?l=r(u,"has incoming rdf:rest arcs"):p=n:(o=n,a="object");d?i.unshift(d.object):l=r(u,"has no list head"),u=p&&p.subject}l?e=!1:o&&(n[o[a].value]=i)}),e&&this.removeQuads(s),n}addAll(e){if(e instanceof qt&&(e=e.filtered),Array.isArray(e))this.addQuads(e);else if(e instanceof et&&e._entityIndex===this._entityIndex)0!==e._size&&(this._graphs=gn(this._graphs,e._graphs),this._size=null);else for(const t of e)this.add(t);return this}contains(e){if(e instanceof qt&&(e=e.filtered),e===this)return!0;if(!(e instanceof et)||this._entityIndex!==e._entityIndex)return e.every(e=>this.has(e));const t=this._graphs,n=e._graphs;let r,i,s,o,a;for(const e in n){if(!(r=t[e]))return!1;r=r.subjects;for(const t in i=n[e].subjects){if(!(s=r[t]))return!1;for(const e in o=i[t]){if(!(a=s[e]))return!1;for(const t in o[e])if(!(t in a))return!1}}}return!0}deleteMatches(e,t,n,r){for(const i of this.match(e,t,n,r))this.removeQuad(i);return this}difference(e){if(e&&e instanceof qt&&(e=e.filtered),e===this)return new et({entityIndex:this._entityIndex});if(e instanceof et&&e._entityIndex===this._entityIndex){const t=new et({entityIndex:this._entityIndex}),n=lc(this._graphs,e._graphs);return n&&(t._graphs=n,t._size=null),t}return this.filter(t=>!e.has(t))}equals(e){return e instanceof qt&&(e=e.filtered),e===this||this.size===e.size&&this.contains(e)}filter(e){const t=new et({entityIndex:this._entityIndex});for(const n of this)e(n,this)&&t.add(n);return t}intersection(e){if(e instanceof qt&&(e=e.filtered),e===this){const e=new et({entityIndex:this._entityIndex});return e._graphs=gn(Object.create(null),this._graphs),e._size=this._size,e}if(e instanceof et&&this._entityIndex===e._entityIndex){const t=new et({entityIndex:this._entityIndex}),n=oc(e._graphs,this._graphs);return n&&(t._graphs=n,t._size=null),t}return this.filter(t=>e.has(t))}map(e){const t=new et({entityIndex:this._entityIndex});for(const n of this)t.add(e(n,this));return t}reduce(e,t){const n=this.readQuads();let r=void 0===t?n.next().value:t;for(const t of n)r=e(r,t,this);return r}toArray(){return this.getQuads()}toCanonical(){throw new Error("not implemented")}toStream(){return this.match()}toString(){return(new ma).quadsToString(this)}union(e){const t=new et({entityIndex:this._entityIndex});return t._graphs=gn(Object.create(null),this._graphs),t._size=this._size,t.addAll(e),t}*[Symbol.iterator](){yield*this.readQuads()}}function Et(e,t,n=0){const r=t[n];if(r&&!(r in e))return!1;let i=!1;for(const s in r?{[r]:e[r]}:e){const r=2===n?null:Et(e[s],t,n+1);!1!==r&&(i=i||Object.create(null),i[s]=r)}return i}class qt extends wa.Readable{constructor(e,t,n,r,i,s){super({objectMode:!0}),Object.assign(this,{n3Store:e,subject:t,predicate:n,object:r,graph:i,options:s})}get filtered(){if(!this._filtered){const{n3Store:e,graph:t,object:n,predicate:r,subject:i}=this,s=this._filtered=new et({factory:e._factory,entityIndex:this.options.entityIndex});let o,a,l;if(i&&!(o=s._termToNumericId(i))||r&&!(a=s._termToNumericId(r))||n&&!(l=s._termToNumericId(n)))return s;const c=e._getGraphs(t);for(const e in c){let t,n,r,i;(i=c[e])&&(!o&&a?(n=Et(i.predicates,[a,l,o]))&&(t=Et(i.subjects,[o,a,l]),r=Et(i.objects,[l,o,a])):l?(r=Et(i.objects,[l,o,a]))&&(t=Et(i.subjects,[o,a,l]),n=Et(i.predicates,[a,l,o])):(t=Et(i.subjects,[o,a,l]))&&(n=Et(i.predicates,[a,l,o]),r=Et(i.objects,[l,o,a])),t&&(s._graphs[e]={subjects:t,predicates:n,objects:r}))}s._size=null}return this._filtered}get size(){return this.filtered.size}_read(e){e>0&&!this[Gi]&&(this[Gi]=this[Symbol.iterator]());const t=this[Gi];for(;--e>=0;){const{done:e,value:n}=t.next();if(e)return void this.push(null);this.push(n)}}addAll(e){return this.filtered.addAll(e)}contains(e){return this.filtered.contains(e)}deleteMatches(e,t,n,r){return this.filtered.deleteMatches(e,t,n,r)}difference(e){return this.filtered.difference(e)}equals(e){return this.filtered.equals(e)}every(e,t,n,r,i){return this.filtered.every(e,t,n,r,i)}filter(e){return this.filtered.filter(e)}forEach(e,t,n,r,i){return this.filtered.forEach(e,t,n,r,i)}import(e){return this.filtered.import(e)}intersection(e){return this.filtered.intersection(e)}map(e){return this.filtered.map(e)}some(e,t,n,r,i){return this.filtered.some(e,t,n,r,i)}toCanonical(){return this.filtered.toCanonical()}toStream(){return this._filtered?this._filtered.toStream():this.n3Store.match(this.subject,this.predicate,this.object,this.graph)}union(e){return this._filtered?this._filtered.union(e):this.n3Store.match(this.subject,this.predicate,this.object,this.graph).addAll(e)}toArray(){return this._filtered?this._filtered.toArray():this.n3Store.getQuads(this.subject,this.predicate,this.object,this.graph)}reduce(e,t){return this.filtered.reduce(e,t)}toString(){return(new ma).quadsToString(this)}add(e){return this.filtered.add(e)}delete(e){return this.filtered.delete(e)}has(e){return this.filtered.has(e)}match(e,t,n,r){return new qt(this.filtered,e,t,n,r,this.options)}*[Symbol.iterator](){yield*this._filtered||this.n3Store.readQuads(this.subject,this.predicate,this.object,this.graph)}}class Td extends wa.Transform{constructor(e){super({decodeStrings:!0}),this._readableState.objectMode=!0;const t=new Ku(e);let n,r;const i={onQuad:(e,t)=>{e&&this.emit("error",e)||t&&this.push(t)},onPrefix:(e,t)=>{this.emit("prefix",e,t)}};e&&e.comments&&(i.onComment=e=>{this.emit("comment",e)}),t.parse({on:(e,t)=>{switch(e){case"data":n=t;break;case"end":r=t}}},i),this._transform=(e,t,r)=>{n(e),r()},this._flush=e=>{r(),e()}}import(e){return e.on("data",e=>{this.write(e)}),e.on("end",()=>{this.end()}),e.on("error",e=>{this.emit("error",e)}),this}}const xe="http://www.w3.org/ns/shacl#",$o="http://datashapes.org/dash#",Gt="http://www.w3.org/2001/XMLSchema#",Ut="http://www.w3.org/1999/02/22-rdf-syntax-ns#",va="http://www.w3.org/2000/01/rdf-schema#",xa="http://www.w3.org/2004/02/skos/core#",Ad="http://www.w3.org/2002/07/owl#",Dd="http://www.w3.org/ns/oa#",Ld="http://purl.org/dc/terms/",Od="http://xmlns.com/foaf/0.1/",mn=Ne.namedNode("loaded-shapes"),Dt=Ne.namedNode("loaded-data"),tt=Ne.namedNode(Ut+"type"),sa=Ne.namedNode(Ld+"conformsTo"),Fo=Ne.namedNode(va+"subClassOf"),Ea=Ne.namedNode(Ad+"imports"),Cd=Ne.namedNode(xa+"broader"),jd=Ne.namedNode(xa+"narrower"),Un=Ne.namedNode(xe+"NodeShape"),$d=Ne.namedNode(xe+"IRI"),Zn=Ne.namedNode(xe+"property"),Sa=Ne.namedNode(xe+"class"),Fd=Ne.namedNode(xe+"node"),Nr=Ne.namedNode(xe+"targetClass"),kd=Ne.namedNode(xe+"nodeKind"),Pd=Ne.namedNode(Gt+"string");function yn(e,t,n=xe,r){let i="";const s=Md(e,t,n,r);return s&&(i=s.value),i}function Md(e,t,n=xe,r){let i;const s=n+t;if(r?.length){for(const t of r)for(const n of e)if(n.predicate.value===s){if(n.object.id.endsWith(`@${t}`))return n.object;n.object.id.indexOf("@")<0?i=n.object:i||(i=n.object)}}else for(const t of e)if(t.predicate.value===s)return t.object;return i}function Bd(e){e.querySelector(".editor")?.focus()}function Rn(e,t){return yn(e,"prefLabel",xa,t)||yn(e,"label",va,t)||yn(e,"name",Od,t)}function uc(e,t,n){const r=[];for(const i of e)r.push({value:i,label:Rn(t.getQuads(i,null,null,null),n),children:[]});return r}function aa(e,t){for(const n in t)e=e.replace(t[n],"");return e}function cc(e,t,n,r,i=new Set){for(const s of t.owlImports)i.has(s.id)||(i.add(s.id),r.push(...n.getSubjects(tt,e,s)));t.parent&&cc(e,t.parent,n,r,i)}function Ia(e,t){if(t.shaclIn){const e=t.config.lists[t.shaclIn];return uc(e?.length?e:[],t.config.store,t.config.languages)}{const n=t.config.store.getSubjects(tt,e,mn);n.push(...t.config.store.getSubjects(tt,e,Dt)),cc(e,t,t.config.store,n);const r=new Map,i=new Map;for(const e of n)r.set(e.id,{value:e,label:Rn(t.config.store.getQuads(e,null,null,null),t.config.languages),children:[]});for(const e of n){for(const n of t.config.store.getObjects(e,Cd,null))r.has(n.id)&&i.set(e.id,n.id);for(const n of t.config.store.getObjects(e,jd,null))r.has(n.id)&&i.set(n.id,e.id);for(const n of t.config.store.getObjects(e,Fo,null))r.has(n.id)&&i.set(e.id,n.id)}for(const[e,t]of i.entries())r.get(t)?.children?.push(r.get(e));const s=[];for(const[e,t]of r.entries())i.has(e)||s.push(t);for(const n of t.config.store.getSubjects(Fo,e,null))s.push(...Ia(n,t));return s}}function oa(e){let t;try{t=new URL(e)}catch{return!1}return"http:"===t.protocol||"https:"===t.protocol}function ko(e,t,n){if(void 0===t)return n;if(void 0===n)return t;const r=e.indexOf(t.language);if(r<0)return n;const i=e.indexOf(n.language);return i<0||i>r?t:n}function qd(e,{remove:t=!1,ignoreErrors:n=!1}={}){const r={},i=n?()=>!0:(e,t)=>{throw new Error(`${e.value} ${t}`)},s=e.getQuads(null,Ut+"rest",Ut+"nil",null),o=t?[...s]:[];return s.forEach(n=>{const s=[];let a,l,c=!1;const u=n.graph;let d=n.subject;for(;d&&!c;){const t=e.getQuads(null,null,d,null),n=e.getQuads(d,null,null,null).filter(e=>!e.predicate.equals(tt));let r,h=null,p=null,f=null;for(let e=0;e<n.length&&!c;e++)r=n[e],r.graph.equals(u)?a?c=i(d,"has non-list arcs out"):r.predicate.value===Ut+"first"?h?c=i(d,"has multiple rdf:first arcs"):o.push(h=r):r.predicate.value===Ut+"rest"?p?c=i(d,"has multiple rdf:rest arcs"):o.push(p=r):t.length?c=i(d,"can't be subject and object"):(a=r,l="subject"):c=i(d,"not confined to single graph");for(let e=0;e<t.length&&!c;++e)r=t[e],a?c=i(d,"can't have coreferences"):r.predicate.value===Ut+"rest"?f?c=i(d,"has incoming rdf:rest arcs"):f=r:(a=r,l="object");h?s.unshift(h.object):c=i(d,"has no list head"),d=f&&f.subject}c?t=!1:a&&(r[a[l].value]=s)}),t&&e.removeQuads(o),r}function dc(e,t,n){const r=document.createElement("div");r.classList.add("shacl-or-constraint");const i=[];if(t instanceof Wt){const s=[];let o=!1;e.length&&(o=n.store.countQuads(e[0],Zn,null,null)>0);for(let r=0;r<e.length;r++)if(o){const o=n.store.getObjects(e[r],Zn,null),a=[];let l="";for(const e of o){const r=new ri(e,t,n);a.push(r),l+=(l.length>1?" / ":"")+r.template.label}s.push(a),i.push({label:l,value:r.toString()})}else{const o=new ri(e[r],t,n);s.push([o]),i.push({label:o.template.label,value:r.toString()})}const a=n.theme.createListEditor("Please choose",null,!1,i),l=a.querySelector(".editor");l.onchange=()=>{if(l.value){const e=s[parseInt(l.value)];let t;e.length&&(t=e[0],r.replaceWith(e[0]));for(let n=1;n<e.length;n++)t.after(e[n]),t=e[n]}},r.appendChild(a)}else{const s=[];for(let t=0;t<e.length;t++){const r=n.store.getQuads(e[t],null,null,null);r.length&&(s.push(r),i.push({label:Rn(r,n.languages)||aa(r[0].predicate.value,n.prefixes)+" = "+aa(r[0].object.value,n.prefixes),value:t.toString()}))}const o=n.theme.createListEditor(t.template.label+"?",null,!1,i,t.template),a=o.querySelector(".editor");a.onchange=()=>{a.value&&r.replaceWith(Xn(t.template.clone().merge(s[parseInt(a.value)]),void 0,!0))},r.appendChild(o)}return r}function Ud(e,t,n){if(t instanceof ct){const r=t.datatype;for(const t of e){const e=n.store.getQuads(t,null,null,null);for(const t of e)if(t.predicate.value===`${xe}datatype`&&t.object.equals(r))return e}}else{const r=n.store.getObjects(t,tt,null);for(const t of e){const e=n.store.getQuads(t,null,null,null);for(const t of e)if(r.length>0){if(t.predicate.value===`${xe}node`)for(const i of r)if(n.store.getQuads(t.object,Nr,i,null).length>0)return e;if(t.predicate.equals(Sa))for(const n of r)if(t.object.equals(n))return e}else if(t.predicate.equals(kd)&&t.object.equals($d))return e}}return console.error("couldn't resolve sh:or/sh:xone on property for value",t),[]}function Hd(e,t,n){for(const r of e){let e=!1;const i=n.store.getObjects(r,Zn,null);for(const r of i){const i=n.store.getObjects(r,`${xe}path`,null);for(const r of i)if(e=n.store.countQuads(t,r,null,null)>0,e)break}if(e)return i}return console.error("couldn't resolve sh:or/sh:xone on node for value",t),[]}const Vd={[`${xe}name`]:(e,t)=>{const n=t;e.name=ko(e.config.languages,e.name,n)},[`${xe}description`]:(e,t)=>{const n=t;e.description=ko(e.config.languages,e.description,n)},[`${xe}path`]:(e,t)=>{e.path=t.value},[`${xe}node`]:(e,t)=>{e.node=t},[`${xe}datatype`]:(e,t)=>{e.datatype=t},[`${xe}nodeKind`]:(e,t)=>{e.nodeKind=t},[`${xe}minCount`]:(e,t)=>{e.minCount=parseInt(t.value)},[`${xe}maxCount`]:(e,t)=>{e.maxCount=parseInt(t.value)},[`${xe}minLength`]:(e,t)=>{e.minLength=parseInt(t.value)},[`${xe}maxLength`]:(e,t)=>{e.maxLength=parseInt(t.value)},[`${xe}minInclusive`]:(e,t)=>{e.minInclusive=parseInt(t.value)},[`${xe}maxInclusive`]:(e,t)=>{e.maxInclusive=parseInt(t.value)},[`${xe}minExclusive`]:(e,t)=>{e.minExclusive=parseInt(t.value)},[`${xe}maxExclusive`]:(e,t)=>{e.maxExclusive=parseInt(t.value)},[`${xe}pattern`]:(e,t)=>{e.pattern=t.value},[`${xe}order`]:(e,t)=>{e.order=parseInt(t.value)},[`${$o}singleLine`]:(e,t)=>{e.singleLine="true"===t.value},[`${$o}readonly`]:(e,t)=>{e.readonly="true"===t.value},[`${Dd}styleClass`]:(e,t)=>{e.cssClass=t.value},[`${xe}and`]:(e,t)=>{e.shaclAnd=t.value},[`${xe}in`]:(e,t)=>{e.shaclIn=t.value},[`${xe}languageIn`]:(e,t)=>{e.languageIn=e.config.lists[t.value],e.datatype=Ne.namedNode(Ut+"langString")},[`${xe}defaultValue`]:(e,t)=>{e.defaultValue=t},[`${xe}hasValue`]:(e,t)=>{e.hasValue=t},[`${xe}qualifiedValueShape`]:(e,t)=>{e.qualifiedValueShape=t},[`${xe}qualifiedMinCount`]:(e,t)=>{e.minCount=parseInt(t.value)},[`${xe}qualifiedMaxCount`]:(e,t)=>{e.maxCount=parseInt(t.value)},[Ea.id]:(e,t)=>{e.owlImports.push(t)},[Sa.id]:(e,t)=>{e.class=t;const n=e.config.store.getSubjects(Nr,t,null);n.length>0&&(e.node=n[0])},[`${xe}or`]:(e,t)=>{const n=e.config.lists[t.value];n?.length?e.shaclOr=n:console.error("list for sh:or not found:",t.value,"existing lists:",e.config.lists)},[`${xe}xone`]:(e,t)=>{const n=e.config.lists[t.value];n?.length?e.shaclXone=n:console.error("list for sh:xone not found:",t.value,"existing lists:",e.config.lists)}};class Gd{constructor(e,t,n){this.label="",this.owlImports=[],this.extendedShapes=[],this.parent=t,this.config=n,this.merge(e),this.qualifiedValueShape&&this.merge(n.store.getQuads(this.qualifiedValueShape,null,null,null))}merge(e){for(const t of e)Vd[t.predicate.id]?.call(this,this,t.object);if(this.label=this.name?.value||Rn(e,this.config.languages),!this.label&&!this.shaclAnd&&(this.label=this.path?aa(this.path,this.config.prefixes):"unknown"),(this.node||this.shaclAnd)&&(this.node&&this.extendedShapes.push(this.node),this.shaclAnd)){const e=this.config.lists[this.shaclAnd];if(e?.length)for(const t of e)this.extendedShapes.push(t)}return this}clone(){const e=Object.assign({},this);return e.extendedShapes=[...this.extendedShapes],e.owlImports=[...this.owlImports],this.languageIn&&(e.languageIn=[...this.languageIn]),this.shaclOr&&(e.shaclOr=[...this.shaclOr]),this.shaclXone&&(e.shaclXone=[...this.shaclXone]),e.merge=this.merge.bind(e),e.clone=this.clone.bind(e),e}}const Wd="form { display:block; --label-width: 8em; --caret-size: 10px; }\nform.mode-edit { padding-left: 1em;  }\nform, form * { box-sizing: border-box; }\nshacl-node, .collapsible::part(content) { display: flex; flex-direction: column; width: 100%; position: relative; }\nshacl-node .remove-button { margin-left: 4px; margin-top: 1px; }\nshacl-node .add-button { color: #555; background-color: transparent; margin: 4px 24px 0 0; border: 0; }\nshacl-node .add-button:hover { color:#222; }\nshacl-node .add-button:focus { box-shadow: none; }\nshacl-node h1 { font-size: 16px; border-bottom: 1px solid #AAA; margin-top: 4px; color: #555; }\nshacl-property:not(:has(>.collapsible)), shacl-property>.collapsible::part(content) { display: flex; flex-direction: column; align-items: end; position: relative; }\nshacl-property:not(.may-add) > .add-button { display: none; }\nshacl-property:not(.may-remove) > .property-instance > .remove-button:not(.persistent) { visibility: hidden; }\nshacl-property:not(.may-remove) > .shacl-or-constraint > .remove-button:not(.persistent) { visibility: hidden; }\n.mode-view .shacl-group:not(:has(shacl-property)) { display: none; }\n.property-instance, .shacl-or-constraint { display: flex; align-items: flex-start; padding: 4px 0; width: 100%; position: relative; }\n.shacl-or-constraint > div { display: flex; flex-grow: 1; align-items: flex-start; }\n.shacl-or-constraint label { display: inline-block; word-break: break-word; width: var(--label-width); line-height: 1em; padding-top: 0.15em; padding-right: 1em; flex-shrink: 0; position: relative; }\n.property-instance label[title] { cursor: help; text-decoration: underline dashed #AAA; }\n.property-instance.linked label:after, label.linked:after { content: '\\1F517'; font-size: 0.6em; padding-left: 6px; }\n.mode-edit .property-instance label.required::before { color: red; content: '\\2736'; font-size: 0.6rem; position: absolute; left: -1.4em; top: 0.15rem; }\n.property-instance.valid::before { content: ''; position: absolute; left: calc(var(--label-width) - 1em); top:0.5em; width: 0.9em; height: 0.9em; background: url('data:image/svg+xml;utf8,<svg viewBox=\"0 0 1024 1024\" fill=\"green\" version=\"1.1\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"M866.133333 258.133333L362.666667 761.6l-204.8-204.8L98.133333 618.666667 362.666667 881.066667l563.2-563.2z\"/></svg>'); }\n.editor:not([type='checkbox']) { flex-grow: 1; }\ntextarea.editor { resize: vertical; }\n.lang-chooser { border: 0; background-color: #e9e9ed; padding: 2px 4px; align-self: flex-start; }\n.validation-error { position: absolute; left: calc(var(--label-width) - 1em); color: red; cursor: help; }\n.validation-error::before { content: '\\26a0' }\n.validation-error.node { left: -1em; }\n.invalid > .editor { border-color: red !important; }\n.ml-0  { margin-left: 0 !important; }\n.pr-0  { padding-right: 0 !important; }\n.mode-view .property-instance:not(:first-child) > label { visibility: hidden; }\n.mode-view .property-instance label { width: var(--label-width); }\n\n.d-flex { display: flex; }\n.lang { opacity: 0.65; font-size: 0.6em; }\na, a:visited { color: inherit; }\n\n.fadeIn, .fadeOut { animation: fadeIn 0.2s ease-out; }\n.fadeOut { animation-direction: reverse; animation-timing-function: ease-out;}\n@keyframes fadeIn {\n    0% { opacity: 0; transform: scaleY(0.8); }\n    100% { opacity: 1; transform: scaleY(1); }\n}\n.collapsible::part(label) { font-weight: 600; }\n.collapsible > .property-instance:nth-child(even) { background-color: #F8F8F8; }\n.collapsible > .property-instance > shacl-node > h1 { display: none; }\n.ref-link { cursor: pointer; }\n.ref-link:hover { text-decoration: underline; }\n.node-id-display { color: #999; font-size: 11px; }";class zd{constructor(e){let t=Wd;e&&(t+="\n"+e),this.stylesheet=new CSSStyleSheet,this.stylesheet.replaceSync(t)}apply(e){}createViewer(e,t,n){const r=document.createElement("div"),i=document.createElement("label");i.innerHTML=e+":",n.description&&i.setAttribute("title",n.description.value),r.appendChild(i);let s,o=t.value,a=null;if(t instanceof vn){const e=n.config.store.getQuads(o,null,null,null);if(e.length){const t=Rn(e,n.config.languages);t&&(o=t)}}else t instanceof ct&&(t.language?(a=document.createElement("span"),a.classList.add("lang"),a.innerText=`@${t.language}`):t.datatype.value===`${Gt}date`?o=new Date(Date.parse(t.value)).toDateString():t.datatype.value===`${Gt}dateTime`&&(o=new Date(Date.parse(t.value)).toLocaleString()));return oa(t.value)?(s=document.createElement("a"),s.setAttribute("href",t.value)):s=document.createElement("div"),s.classList.add("d-flex"),s.innerText=o,a&&s.appendChild(a),r.appendChild(s),r}}function Qd(e,t,n){if(n){const n=void 0!==e.minCount&&e.minCount>0;if(e.class)return e.config.theme.createListEditor(e.label,t,n,Ia(e.class,e),e);if(e.shaclIn){const r=e.config.lists[e.shaclIn];if(r?.length){const i=uc(r,e.config.store,e.config.languages);return e.config.theme.createListEditor(e.label,t,n,i,e)}console.error("list not found:",e.shaclIn,"existing lists:",e.config.lists)}if(e.datatype?.value===`${Ut}langString`||e.languageIn?.length)return e.config.theme.createLangStringEditor(e.label,t,n,e);switch(e.datatype?.value.replace(Gt,"")){case"integer":case"float":case"double":case"decimal":return e.config.theme.createNumberEditor(e.label,t,n,e);case"date":case"dateTime":return e.config.theme.createDateEditor(e.label,t,n,e);case"boolean":return e.config.theme.createBooleanEditor(e.label,t,n,e);case"base64Binary":return e.config.theme.createFileEditor(e.label,t,n,e)}return e.config.theme.createTextEditor(e.label,t,n,e)}{if(t)return e.config.theme.createViewer(e.label,t,e);const n=document.createElement("div");return n.innerHTML="No value",n}}function Xd(e,t,n){if("application/ld+json"===t)return Jd(e);{const r=new ma({format:t,prefixes:n});r.addQuads(e);let i="";return r.end((e,t)=>{e&&console.error(e),i=t}),i}}function Jd(e){const t=[];for(const n of e){const e={"@id":n.subject.id};if(n.predicate===tt)e["@type"]=n.object.id;else{let t=n.object.value;n.object instanceof ct?n.object.language?t={"@language":n.object.language,"@value":n.object.value}:n.object.datatype&&n.object.datatype.value!==`${Gt}#string`&&(t={"@type":n.object.datatype.value,"@value":n.object.value}):t={"@id":n.object.id},e[n.predicate.value]=t}t.push(e)}return JSON.stringify(t)}function Kd(e){let t=e.shaclDatatype,n=e.value;if(n){if(n.startsWith("<")&&n.endsWith(">")&&n.indexOf(":")>-1)return Ne.namedNode(n.substring(1,n.length-1));if(e.dataset.class||e.dataset.nodeKind===xe+"IRI")return Ne.namedNode(n);if(e.dataset.link)return JSON.parse(e.dataset.link);if(e.dataset.lang?t=e.dataset.lang:"number"===e.type?n=parseFloat(n):"file"===e.type&&e.binaryData?n=e.binaryData:"datetime-local"===e.type&&(n=new Date(n).toISOString().slice(0,19)),!t&&"string"==typeof n){const e=n.split("^^");2===e.length&&(e[0].startsWith('"')&&e[0].endsWith('"')||e[0].startsWith("'")&&e[0].endsWith("'"))&&2===e[1].split(":").length&&(n=e[0].substring(1,e[0].length-1),t=Ne.namedNode(e[1]))}return Ne.literal(n,t)}if(("checkbox"===e.type||"checkbox"===e.getAttribute("type"))&&(e.checked||parseInt(e.dataset.minCount||"0")>0))return Ne.literal(e.checked?"true":"false",t)}const bn={};function Yd(e){void 0===e.predicate&&void 0===e.datatype?console.warn('not registering plugin because it does neither define "predicate" nor "datatype"',e):bn[`${e.predicate}^${e.datatype}`]=e}function Zd(){return Object.entries(bn).map(e=>e[1])}function eh(e,t){let n=bn[`${e}^${t}`];return n||(n=bn[`${e}^undefined`],n)?n:bn[`undefined^${t}`]}class gy{constructor(e,t){this.predicate=e.predicate,this.datatype=e.datatype,t&&(this.stylesheet=new CSSStyleSheet,this.stylesheet.replaceSync(t))}createViewer(e,t){return e.config.theme.createViewer(e.label,t,e)}}const Wn=globalThis,Na=Wn.ShadowRoot&&(void 0===Wn.ShadyCSS||Wn.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,Ra=Symbol(),Po=new WeakMap;let hc=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==Ra)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Na&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=Po.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Po.set(t,e))}return e}toString(){return this.cssText}};const th=e=>new hc("string"==typeof e?e:e+"",void 0,Ra),St=(e,...t)=>{const n=1===e.length?e[0]:t.reduce((t,n,r)=>t+(e=>{if(!0===e._$cssResult$)return e.cssText;if("number"==typeof e)return e;throw Error("Value passed to 'css' function must be a 'css' function result: "+e+". Use 'unsafeCSS' to pass non-literal values, but take care to ensure page security.")})(n)+e[r+1],e[0]);return new hc(n,e,Ra)},rh=(e,t)=>{if(Na)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const n of t){const t=document.createElement("style"),r=Wn.litNonce;void 0!==r&&t.setAttribute("nonce",r),t.textContent=n.cssText,e.appendChild(t)}},Mo=Na?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return th(t)})(e):e,{is:nh,defineProperty:ih,getOwnPropertyDescriptor:sh,getOwnPropertyNames:ah,getOwnPropertySymbols:oh,getPrototypeOf:lh}=Object,ci=globalThis,Bo=ci.trustedTypes,uh=Bo?Bo.emptyScript:"",ch=ci.reactiveElementPolyfillSupport,_n=(e,t)=>e,la={toAttribute(e,t){switch(t){case Boolean:e=e?uh:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},fc=(e,t)=>!nh(e,t),qo={attribute:!0,type:String,converter:la,reflect:!1,useDefault:!1,hasChanged:fc};Symbol.metadata??=Symbol("metadata"),ci.litPropertyMetadata??=new WeakMap;let vr=class extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=qo){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),r=this.getPropertyDescriptor(e,n,t);void 0!==r&&ih(this.prototype,e,r)}}static getPropertyDescriptor(e,t,n){const{get:r,set:i}=sh(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:r,set(t){const s=r?.call(this);i?.call(this,t),this.requestUpdate(e,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??qo}static _$Ei(){if(this.hasOwnProperty(_n("elementProperties")))return;const e=lh(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(_n("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(_n("properties"))){const e=this.properties,t=[...ah(e),...oh(e)];for(const n of t)this.createProperty(n,e[n])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,n]of t)this.elementProperties.set(e,n)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const n=this._$Eu(e,t);void 0!==n&&this._$Eh.set(n,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(Mo(e))}else void 0!==e&&t.push(Mo(e));return t}static _$Eu(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return rh(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){const n=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,n);if(void 0!==r&&!0===n.reflect){const i=(void 0!==n.converter?.toAttribute?n.converter:la).toAttribute(t,n.type);this._$Em=e,null==i?this.removeAttribute(r):this.setAttribute(r,i),this._$Em=null}}_$AK(e,t){const n=this.constructor,r=n._$Eh.get(e);if(void 0!==r&&this._$Em!==r){const e=n.getPropertyOptions(r),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:la;this._$Em=r;const s=i.fromAttribute(t,e.type);this[r]=s??this._$Ej?.get(r)??s,this._$Em=null}}requestUpdate(e,t,n){if(void 0!==e){const r=this.constructor,i=this[e];if(n??=r.getPropertyOptions(e),!((n.hasChanged??fc)(i,t)||n.useDefault&&n.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(r._$Eu(e,n))))return;this.C(e,t,n)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:r,wrapped:i},s){n&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,s??t??this[e]),!0!==i||void 0!==s)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),!0===r&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,n]of e){const{wrapped:e}=n,r=this[t];!0!==e||this._$AL.has(t)||void 0===r||this.C(t,void 0,n,r)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}};vr.elementStyles=[],vr.shadowRootOptions={mode:"open"},vr[_n("elementProperties")]=new Map,vr[_n("finalized")]=new Map,ch?.({ReactiveElement:vr}),(ci.reactiveElementVersions??=[]).push("2.1.1");const Ta=globalThis,ei=Ta.trustedTypes,Uo=ei?ei.createPolicy("lit-html",{createHTML:e=>e}):void 0,pc="$lit$",Ht=`lit$${Math.random().toFixed(9).slice(2)}$`,gc="?"+Ht,dh=`<${gc}>`,ur=document,En=()=>ur.createComment(""),Sn=e=>null===e||"object"!=typeof e&&"function"!=typeof e,Aa=Array.isArray,hh=e=>Aa(e)||"function"==typeof e?.[Symbol.iterator],Wi="[ \t\n\f\r]",Qr=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,Ho=/-->/g,Vo=/>/g,Kt=RegExp(`>|${Wi}(?:([^\\s"'>=/]+)(${Wi}*=${Wi}*(?:[^ \t\n\f\r"'\`<>=]|("|')|))|$)`,"g"),Go=/'/g,Wo=/"/g,mc=/^(?:script|style|textarea|title)$/i,fh=e=>(t,...n)=>({_$litType$:e,strings:t,values:n}),dt=fh(1),Rr=Symbol.for("lit-noChange"),Ve=Symbol.for("lit-nothing"),zo=new WeakMap,or=ur.createTreeWalker(ur,129);function yc(e,t){if(!Aa(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return void 0!==Uo?Uo.createHTML(t):t}const ph=(e,t)=>{const n=e.length-1,r=[];let i,s=2===t?"<svg>":3===t?"<math>":"",o=Qr;for(let t=0;t<n;t++){const n=e[t];let a,l,c=-1,u=0;for(;u<n.length&&(o.lastIndex=u,l=o.exec(n),null!==l);)u=o.lastIndex,o===Qr?"!--"===l[1]?o=Ho:void 0!==l[1]?o=Vo:void 0!==l[2]?(mc.test(l[2])&&(i=RegExp("</"+l[2],"g")),o=Kt):void 0!==l[3]&&(o=Kt):o===Kt?">"===l[0]?(o=i??Qr,c=-1):void 0===l[1]?c=-2:(c=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?Kt:'"'===l[3]?Wo:Go):o===Wo||o===Go?o=Kt:o===Ho||o===Vo?o=Qr:(o=Kt,i=void 0);const d=o===Kt&&e[t+1].startsWith("/>")?" ":"";s+=o===Qr?n+dh:c>=0?(r.push(a),n.slice(0,c)+pc+n.slice(c)+Ht+d):n+Ht+(-2===c?t:d)}return[yc(e,s+(e[n]||"<?>")+(2===t?"</svg>":3===t?"</math>":"")),r]};let ua=class e{constructor({strings:t,_$litType$:n},r){let i;this.parts=[];let s=0,o=0;const a=t.length-1,l=this.parts,[c,u]=ph(t,n);if(this.el=e.createElement(c,r),or.currentNode=this.el.content,2===n||3===n){const e=this.el.content.firstChild;e.replaceWith(...e.childNodes)}for(;null!==(i=or.nextNode())&&l.length<a;){if(1===i.nodeType){if(i.hasAttributes())for(const e of i.getAttributeNames())if(e.endsWith(pc)){const t=u[o++],n=i.getAttribute(e).split(Ht),r=/([.?@])?(.*)/.exec(t);l.push({type:1,index:s,name:r[2],strings:n,ctor:"."===r[1]?mh:"?"===r[1]?yh:"@"===r[1]?bh:di}),i.removeAttribute(e)}else e.startsWith(Ht)&&(l.push({type:6,index:s}),i.removeAttribute(e));if(mc.test(i.tagName)){const e=i.textContent.split(Ht),t=e.length-1;if(t>0){i.textContent=ei?ei.emptyScript:"";for(let n=0;n<t;n++)i.append(e[n],En()),or.nextNode(),l.push({type:2,index:++s});i.append(e[t],En())}}}else if(8===i.nodeType)if(i.data===gc)l.push({type:2,index:s});else{let e=-1;for(;-1!==(e=i.data.indexOf(Ht,e+1));)l.push({type:7,index:s}),e+=Ht.length-1}s++}}static createElement(e,t){const n=ur.createElement("template");return n.innerHTML=e,n}};function Tr(e,t,n=e,r){if(t===Rr)return t;let i=void 0!==r?n._$Co?.[r]:n._$Cl;const s=Sn(t)?void 0:t._$litDirective$;return i?.constructor!==s&&(i?._$AO?.(!1),void 0===s?i=void 0:(i=new s(e),i._$AT(e,n,r)),void 0!==r?(n._$Co??=[])[r]=i:n._$Cl=i),void 0!==i&&(t=Tr(e,i._$AS(e,t.values),i,r)),t}let gh=class{constructor(e,t){this._$AV=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}u(e){const{el:{content:t},parts:n}=this._$AD,r=(e?.creationScope??ur).importNode(t,!0);or.currentNode=r;let i=or.nextNode(),s=0,o=0,a=n[0];for(;void 0!==a;){if(s===a.index){let t;2===a.type?t=new Da(i,i.nextSibling,this,e):1===a.type?t=new a.ctor(i,a.name,a.strings,this,e):6===a.type&&(t=new _h(i,this,e)),this._$AV.push(t),a=n[++o]}s!==a?.index&&(i=or.nextNode(),s++)}return or.currentNode=ur,r}p(e){let t=0;for(const n of this._$AV)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}},Da=class e{get _$AU(){return this._$AM?._$AU??this._$Cv}constructor(e,t,n,r){this.type=2,this._$AH=Ve,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=r,this._$Cv=r?.isConnected??!0}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e?.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=Tr(this,e,t),Sn(e)?e===Ve||null==e||""===e?(this._$AH!==Ve&&this._$AR(),this._$AH=Ve):e!==this._$AH&&e!==Rr&&this._(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):hh(e)?this.k(e):this._(e)}O(e){return this._$AA.parentNode.insertBefore(e,this._$AB)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}_(e){this._$AH!==Ve&&Sn(this._$AH)?this._$AA.nextSibling.data=e:this.T(ur.createTextNode(e)),this._$AH=e}$(e){const{values:t,_$litType$:n}=e,r="number"==typeof n?this._$AC(e):(void 0===n.el&&(n.el=ua.createElement(yc(n.h,n.h[0]),this.options)),n);if(this._$AH?._$AD===r)this._$AH.p(t);else{const e=new gh(r,this),n=e.u(this.options);e.p(t),this.T(n),this._$AH=e}}_$AC(e){let t=zo.get(e.strings);return void 0===t&&zo.set(e.strings,t=new ua(e)),t}k(t){Aa(this._$AH)||(this._$AH=[],this._$AR());const n=this._$AH;let r,i=0;for(const s of t)i===n.length?n.push(r=new e(this.O(En()),this.O(En()),this,this.options)):r=n[i],r._$AI(s),i++;i<n.length&&(this._$AR(r&&r._$AB.nextSibling,i),n.length=i)}_$AR(e=this._$AA.nextSibling,t){for(this._$AP?.(!1,!0,t);e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){void 0===this._$AM&&(this._$Cv=e,this._$AP?.(e))}},di=class{get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}constructor(e,t,n,r,i){this.type=1,this._$AH=Ve,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=i,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=Ve}_$AI(e,t=this,n,r){const i=this.strings;let s=!1;if(void 0===i)e=Tr(this,e,t,0),s=!Sn(e)||e!==this._$AH&&e!==Rr,s&&(this._$AH=e);else{const r=e;let o,a;for(e=i[0],o=0;o<i.length-1;o++)a=Tr(this,r[n+o],t,o),a===Rr&&(a=this._$AH[o]),s||=!Sn(a)||a!==this._$AH[o],a===Ve?e=Ve:e!==Ve&&(e+=(a??"")+i[o+1]),this._$AH[o]=a}s&&!r&&this.j(e)}j(e){e===Ve?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,e??"")}},mh=class extends di{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===Ve?void 0:e}};class yh extends di{constructor(){super(...arguments),this.type=4}j(e){this.element.toggleAttribute(this.name,!!e&&e!==Ve)}}let bh=class extends di{constructor(e,t,n,r,i){super(e,t,n,r,i),this.type=5}_$AI(e,t=this){if((e=Tr(this,e,t,0)??Ve)===Rr)return;const n=this._$AH,r=e===Ve&&n!==Ve||e.capture!==n.capture||e.once!==n.once||e.passive!==n.passive,i=e!==Ve&&(n===Ve||r);r&&this.element.removeEventListener(this.name,this,n),i&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){"function"==typeof this._$AH?this._$AH.call(this.options?.host??this.element,e):this._$AH.handleEvent(e)}},_h=class{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){Tr(this,e)}};const wh=Ta.litHtmlPolyfillSupport;wh?.(ua,Da),(Ta.litHtmlVersions??=[]).push("3.3.1");const vh=(e,t,n)=>{const r=n?.renderBefore??t;let i=r._$litPart$;if(void 0===i){const e=n?.renderBefore??null;r._$litPart$=i=new Da(t.insertBefore(En(),e),e,void 0,n??{})}return i._$AI(e),i},La=globalThis;class lr extends vr{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){const e=super.createRenderRoot();return this.renderOptions.renderBefore??=e.firstChild,e}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=vh(t,this.renderRoot,this.renderOptions)}connectedCallback(){super.connectedCallback(),this._$Do?.setConnected(!0)}disconnectedCallback(){super.disconnectedCallback(),this._$Do?.setConnected(!1)}render(){return Rr}}lr._$litElement$=!0,lr.finalized=!0,La.litElementHydrateSupport?.({LitElement:lr});const xh=La.litElementPolyfillSupport;xh?.({LitElement:lr}),(La.litElementVersions??=[]).push("4.2.1");var wc=e=>{throw TypeError(e)},vc=(e,t,n)=>t.has(e)||wc("Cannot "+n),Bt=(e,t,n)=>(vc(e,t,"read from private field"),n?n.call(e):t.get(e)),Eh=(e,t,n)=>t.has(e)?wc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Sh=(e,t,n,r)=>(vc(e,t,"write to private field"),t.set(e,n),n);const Qt=e=>(t,n)=>{void 0!==n?n.addInitializer(()=>{customElements.define(e,t)}):customElements.define(e,t)},zn=globalThis,Oa=zn.ShadowRoot&&(void 0===zn.ShadyCSS||zn.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,xc=Symbol(),Qo=new WeakMap;let Ih=class{constructor(e,t,n){if(this._$cssResult$=!0,n!==xc)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const t=this.t;if(Oa&&void 0===e){const n=void 0!==t&&1===t.length;n&&(e=Qo.get(t)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),n&&Qo.set(t,e))}return e}toString(){return this.cssText}};const Nh=e=>new Ih("string"==typeof e?e:e+"",void 0,xc),Rh=(e,t)=>{if(Oa)e.adoptedStyleSheets=t.map(e=>e instanceof CSSStyleSheet?e:e.styleSheet);else for(const n of t){const t=document.createElement("style"),r=zn.litNonce;void 0!==r&&t.setAttribute("nonce",r),t.textContent=n.cssText,e.appendChild(t)}},Xo=Oa?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return Nh(t)})(e):e,{is:Th,defineProperty:Ah,getOwnPropertyDescriptor:Dh,getOwnPropertyNames:Lh,getOwnPropertySymbols:Oh,getPrototypeOf:Ch}=Object,hi=globalThis,Jo=hi.trustedTypes,jh=Jo?Jo.emptyScript:"",$h=hi.reactiveElementPolyfillSupport,wn=(e,t)=>e,ti={toAttribute(e,t){switch(t){case Boolean:e=e?jh:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch{n=null}}return n}},Ca=(e,t)=>!Th(e,t),Ko={attribute:!0,type:String,converter:ti,reflect:!1,useDefault:!1,hasChanged:Ca};Symbol.metadata??=Symbol("metadata"),hi.litPropertyMetadata??=new WeakMap;class Xr extends HTMLElement{static addInitializer(e){this._$Ei(),(this.l??=[]).push(e)}static get observedAttributes(){return this.finalize(),this._$Eh&&[...this._$Eh.keys()]}static createProperty(e,t=Ko){if(t.state&&(t.attribute=!1),this._$Ei(),this.prototype.hasOwnProperty(e)&&((t=Object.create(t)).wrapped=!0),this.elementProperties.set(e,t),!t.noAccessor){const n=Symbol(),r=this.getPropertyDescriptor(e,n,t);void 0!==r&&Ah(this.prototype,e,r)}}static getPropertyDescriptor(e,t,n){const{get:r,set:i}=Dh(this.prototype,e)??{get(){return this[t]},set(e){this[t]=e}};return{get:r,set(t){const s=r?.call(this);i?.call(this,t),this.requestUpdate(e,s,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)??Ko}static _$Ei(){if(this.hasOwnProperty(wn("elementProperties")))return;const e=Ch(this);e.finalize(),void 0!==e.l&&(this.l=[...e.l]),this.elementProperties=new Map(e.elementProperties)}static finalize(){if(this.hasOwnProperty(wn("finalized")))return;if(this.finalized=!0,this._$Ei(),this.hasOwnProperty(wn("properties"))){const e=this.properties,t=[...Lh(e),...Oh(e)];for(const n of t)this.createProperty(n,e[n])}const e=this[Symbol.metadata];if(null!==e){const t=litPropertyMetadata.get(e);if(void 0!==t)for(const[e,n]of t)this.elementProperties.set(e,n)}this._$Eh=new Map;for(const[e,t]of this.elementProperties){const n=this._$Eu(e,t);void 0!==n&&this._$Eh.set(n,e)}this.elementStyles=this.finalizeStyles(this.styles)}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(Xo(e))}else void 0!==e&&t.push(Xo(e));return t}static _$Eu(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}constructor(){super(),this._$Ep=void 0,this.isUpdatePending=!1,this.hasUpdated=!1,this._$Em=null,this._$Ev()}_$Ev(){this._$ES=new Promise(e=>this.enableUpdating=e),this._$AL=new Map,this._$E_(),this.requestUpdate(),this.constructor.l?.forEach(e=>e(this))}addController(e){(this._$EO??=new Set).add(e),void 0!==this.renderRoot&&this.isConnected&&e.hostConnected?.()}removeController(e){this._$EO?.delete(e)}_$E_(){const e=new Map,t=this.constructor.elementProperties;for(const n of t.keys())this.hasOwnProperty(n)&&(e.set(n,this[n]),delete this[n]);e.size>0&&(this._$Ep=e)}createRenderRoot(){const e=this.shadowRoot??this.attachShadow(this.constructor.shadowRootOptions);return Rh(e,this.constructor.elementStyles),e}connectedCallback(){this.renderRoot??=this.createRenderRoot(),this.enableUpdating(!0),this._$EO?.forEach(e=>e.hostConnected?.())}enableUpdating(e){}disconnectedCallback(){this._$EO?.forEach(e=>e.hostDisconnected?.())}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$ET(e,t){const n=this.constructor.elementProperties.get(e),r=this.constructor._$Eu(e,n);if(void 0!==r&&!0===n.reflect){const i=(void 0!==n.converter?.toAttribute?n.converter:ti).toAttribute(t,n.type);this._$Em=e,null==i?this.removeAttribute(r):this.setAttribute(r,i),this._$Em=null}}_$AK(e,t){const n=this.constructor,r=n._$Eh.get(e);if(void 0!==r&&this._$Em!==r){const e=n.getPropertyOptions(r),i="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==e.converter?.fromAttribute?e.converter:ti;this._$Em=r,this[r]=i.fromAttribute(t,e.type)??this._$Ej?.get(r)??null,this._$Em=null}}requestUpdate(e,t,n){if(void 0!==e){const r=this.constructor,i=this[e];if(n??=r.getPropertyOptions(e),!((n.hasChanged??Ca)(i,t)||n.useDefault&&n.reflect&&i===this._$Ej?.get(e)&&!this.hasAttribute(r._$Eu(e,n))))return;this.C(e,t,n)}!1===this.isUpdatePending&&(this._$ES=this._$EP())}C(e,t,{useDefault:n,reflect:r,wrapped:i},s){n&&!(this._$Ej??=new Map).has(e)&&(this._$Ej.set(e,s??t??this[e]),!0!==i||void 0!==s)||(this._$AL.has(e)||(this.hasUpdated||n||(t=void 0),this._$AL.set(e,t)),!0===r&&this._$Em!==e&&(this._$Eq??=new Set).add(e))}async _$EP(){this.isUpdatePending=!0;try{await this._$ES}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){if(!this.isUpdatePending)return;if(!this.hasUpdated){if(this.renderRoot??=this.createRenderRoot(),this._$Ep){for(const[e,t]of this._$Ep)this[e]=t;this._$Ep=void 0}const e=this.constructor.elementProperties;if(e.size>0)for(const[t,n]of e){const{wrapped:e}=n,r=this[t];!0!==e||this._$AL.has(t)||void 0===r||this.C(t,void 0,n,r)}}let e=!1;const t=this._$AL;try{e=this.shouldUpdate(t),e?(this.willUpdate(t),this._$EO?.forEach(e=>e.hostUpdate?.()),this.update(t)):this._$EM()}catch(t){throw e=!1,this._$EM(),t}e&&this._$AE(t)}willUpdate(e){}_$AE(e){this._$EO?.forEach(e=>e.hostUpdated?.()),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$EM(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$ES}shouldUpdate(e){return!0}update(e){this._$Eq&&=this._$Eq.forEach(e=>this._$ET(e,this[e])),this._$EM()}updated(e){}firstUpdated(e){}}Xr.elementStyles=[],Xr.shadowRootOptions={mode:"open"},Xr[wn("elementProperties")]=new Map,Xr[wn("finalized")]=new Map,$h?.({ReactiveElement:Xr}),(hi.reactiveElementVersions??=[]).push("2.1.0");const Fh={attribute:!0,type:String,converter:ti,reflect:!1,hasChanged:Ca},kh=(e=Fh,t,n)=>{const{kind:r,metadata:i}=n;let s=globalThis.litPropertyMetadata.get(i);if(void 0===s&&globalThis.litPropertyMetadata.set(i,s=new Map),"setter"===r&&((e=Object.create(e)).wrapped=!0),s.set(n.name,e),"accessor"===r){const{name:r}=n;return{set(n){const i=t.get.call(this);t.set.call(this,n),this.requestUpdate(r,i,e)},init(t){return void 0!==t&&this.C(r,void 0,e,t),t}}}if("setter"===r){const{name:r}=n;return function(n){const i=this[r];t.call(this,n),this.requestUpdate(r,i,e)}}throw Error("Unsupported decorator location: "+r)};function Se(e){return(t,n)=>"object"==typeof n?kh(e,t,n):((e,t,n)=>{const r=t.hasOwnProperty(n);return t.constructor.createProperty(n,e),r?Object.getOwnPropertyDescriptor(t,n):void 0})(e,t,n)}function ja(e){return Se({...e,state:!0,attribute:!1})}const Ph=(e,t,n)=>(n.configurable=!0,n.enumerable=!0,Reflect.decorate&&"object"!=typeof t&&Object.defineProperty(e,t,n),n);function pt(e,t){return(t,n,r)=>Ph(t,n,{get(){return this.renderRoot?.querySelector(e)??null}})}var Mh=Object.defineProperty,Xt=(e,t,n,r)=>{for(var i,s=void 0,o=e.length-1;o>=0;o--)(i=e[o])&&(s=i(t,n,s)||s);return s&&Mh(t,n,s),s};const ca=class extends lr{constructor(){super(...arguments),this.dense=!1}};ca.shadowRootOptions={...lr.shadowRootOptions,delegatesFocus:!0},ca.styles=[St`
    :host {
        /* color-scheme: light dark; */
        --rokit-primary-color-inner: var(--rokit-primary-color, #008877);
        --rokit-primary-color-transparent-inner: color-mix(in srgb, var(--rokit-primary-color-inner) 20%, transparent);
        --rokit-error-color-inner: var(--rokit-error-color, #F03333);
        /*--rokit-background-color-inner: var(--rokit-background-color, #242424);*/
        --rokit-background-color-inner: var(--rokit-background-color, #FFF);
        --rokit-light-background-color-inner: var(--rokit-light-background-color, color-mix(in srgb, var(--rokit-background-color-inner) 97%, currentColor));
        --rokit-light-background-darker-color-inner: var(--rokit-light-background-darker-color, color-mix(in srgb, var(--rokit-light-background-color-inner) 80%, currentColor));
        --rokit-shadow-color-inner: var(--rokit-shadow-color, color-mix(in srgb, currentColor 40%, transparent));
        --rokit-list-indent-inner: var(--rokit-list-indent, 1em);
        --rokit-list-max-height-inner: var(--rokit-list-max-height, 300);
        --rokit-caret-size-inner: var(--rokit-caret-size, 0.5em);
        --rokit-transition-duration-inner: var(--rokit-transition-duration, 0.2s);
    }
    /*
    @media (prefers-color-scheme: light) {
        :host {
            --rokit-background-color-inner: var(--rokit-background-color, #FFF);
        }
    }
    */
    `];let $t=ca;var bt;Xt([Se({type:Boolean,reflect:!0})],$t.prototype,"dense");const da=class extends $t{constructor(){super(),Eh(this,bt),this.value="",this.clearable=!1,this.required=!1,this.disabled=!1,Sh(this,bt,this.attachInternals())}checkValidity(){return Bt(this,bt).checkValidity()}reportValidity(){const e=Bt(this,bt).reportValidity();return this.classList.toggle("invalid",!e),e}get validity(){return Bt(this,bt).validity}get validationMessage(){return Bt(this,bt).validationMessage}setCustomValidity(e,t){e?Bt(this,bt).setValidity({customError:!0},e,t):Bt(this,bt).setValidity(void 0)}updateValidity(e,t,n){Bt(this,bt).setValidity(e,t,n)}setFormValue(e,t){Bt(this,bt).setFormValue(e,t)}};bt=new WeakMap,da.formAssociated=!0,da.styles=[...$t.styles,St`
    :host { display: inline-flex; align-items: center; padding: 6px 8px; border-bottom: 2px solid var(--rokit-light-background-darker-color-inner); box-sizing: border-box; position: relative; }
    :host(:focus) { border-color: var(--rokit-primary-color-inner); }
    :host(.invalid) { border-color: var(--rokit-error-color-inner); }
    `];let vt=da;function Bh(e){const t=parseFloat(e),n=e.match(/m?s/);let r=0;if(n)switch(n[0]){case"s":r=1e3*t;break;case"ms":r=t;break;default:r=0}return r}Xt([Se()],vt.prototype,"name"),Xt([Se()],vt.prototype,"value"),Xt([Se({type:Boolean})],vt.prototype,"clearable"),Xt([Se({type:Boolean})],vt.prototype,"required"),Xt([Se({type:Boolean})],vt.prototype,"disabled"),Xt([Se()],vt.prototype,"label"),Xt([Se()],vt.prototype,"placeholder");var qh=Object.defineProperty,Uh=Object.getOwnPropertyDescriptor,Ec=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?Uh(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&qh(t,n,s),s};let Ar=class extends $t{constructor(){super(...arguments),this.icon=!1}render(){return dt`<a part="link"><slot><slot></a>`}};Ar.styles=[...$t.styles,St`
    :host { display: inline-flex; }
    :host a { display: flex; min-width: 1em; height: 1em; padding: 0.5em; cursor: pointer; border-radius: 0.6em; align-items: center; justify-content: center; }
    :host a:hover { text-shadow: 0 0 1px; }
    :host(:not([icon])) a { background-color: var(--rokit-light-background-color-inner); }
    :host([icon]) a { border-radius: 1em; }
    :host([icon]) a:hover { text-shadow: 0 0 1px var(--rokit-shadow-color-inner); background-color: var(--rokit-light-background-darker-color-inner); }
    :host([dense]) { font-size: 0.65em; }
    :host(.clear) a:before { content: '\u2715'; }
    :host(.caret) a:before { content: ''; width: var(--rokit-caret-size-inner); height: var(--rokit-caret-size-inner); border-style: none solid solid none; border-width: calc(0.3 * var(--rokit-caret-size-inner)); transform: translate(0.15em, -0.15em) rotate(45deg); transition: transform var(--rokit-transition-duration-inner) ease-out; margin-right: calc(0.5 * var(--rokit-caret-size-inner)); }
    :host(.caret.down) a:before { transform: translate(0.15em, 0.15em) rotate(225deg); }
    :host(.caret.right) a:before { transform: translate(0em, 0em) rotate(-45deg); }
    `],Ec([Se({type:Boolean,reflect:!0})],Ar.prototype,"icon",2),Ar=Ec([Qt("rokit-button")],Ar);var Hh=Object.defineProperty,Vh=Object.getOwnPropertyDescriptor,Ft=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?Vh(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Hh(t,n,s),s};let nt=class extends $t{constructor(){super(...arguments),this.open=!1,this.disabled=!1,this.transitioning=!1,this.closedBeforeTransition=!1,this.onMouseDown=(()=>{this.closedBeforeTransition=!this.open&&!this.transitioning}).bind(this),this.onClick=(()=>{this.toggle(this.closedBeforeTransition,!0)}).bind(this)}firstUpdated(){this.transitionDuration=Bh(getComputedStyle(this).getPropertyValue("--rokit-transition-duration-inner")),new IntersectionObserver(e=>{e.length&&e[0].isIntersecting&&this.updateContentHeight()}).observe(this)}updated(e){e.has("transitioning")&&this.classList.toggle("transitioning",this.transitioning),e.has("disabled")&&(this.disabled?(this.header.removeEventListener("mousedown",this.onMouseDown),this.header.removeEventListener("click",this.onClick)):(this.header.addEventListener("mousedown",this.onMouseDown),this.header.addEventListener("click",this.onClick))),e.has("open")&&!this.disabled&&(this.transitioning||this.toggle(this.open))}updateContentHeight(){setTimeout(()=>{this.content.style.maxHeight=(void 0!==this.maxHeight?Math.min(this.maxHeight,this.content.scrollHeight):this.content.scrollHeight)+"px",this.classList.toggle("has-content","0px"!==this.content.style.maxHeight)})}onSlotChange(){const e=this.shadowRoot.querySelector("#content > slot").assignedNodes(),t=new MutationObserver(()=>this.updateContentHeight());for(const n of e)t.observe(n,{subtree:!0,childList:!0,characterData:!0});this.updateContentHeight()}toggle(e=!this.open,t=!1){this.disabled||(this.transitioning=!0,this.open=e,this.toggleButton.classList.toggle("down",e),setTimeout(()=>{this.transitioning=!1,this.open&&t&&this.content.scrollIntoView({block:"nearest"})},this.transitionDuration))}render(){return dt`
            <header part="header">
                <slot name="prefix" part="prefix"></slot>
                <span class="label"><slot name="label" part="label">${this.label}</slot></span>
                <slot name="pre-suffix" part="suffix"></slot>
                <rokit-button id="toggle" part="toggle" class="caret" icon ?dense="${this.dense}" title="${this.open?"Collapse":"Expand"}"></rokit-button>
                <slot name="suffix" part="suffix"></slot>
            </header>
            <div id="content" part="content">
                <slot @slotchange=${this.onSlotChange}></slot>
            </div>
        `}};nt.styles=[...$t.styles,St`
        :host { display: flex; flex-direction: column; align-items: stretch; border-bottom: 2px solid var(--rokit-light-background-darker-color-inner); }
        :host header { cursor: pointer; }
        :host([dense]) header { padding: 2px 4px; }
        :host([maxheight]) #content { overflow:auto }
        :host(:not([open])) #content { max-height: 0 !important; }
        :host(:not([open])) #content, :host(.transitioning) #content { overflow: hidden !important; }
        :host([open]) #content, :host(.transitioning) #content { padding-top: 4px; }
        header { display: flex; align-items: center; padding: 6px 8px; background-color: var(--rokit-light-background-color-inner); user-select: none; }
        .label { flex-grow: 1; overflow: hidden; }
        #content { display: flex; transition: max-height var(--rokit-transition-duration-inner) ease-in-out; position: relative; scrollbar-width: thin; }
        #toggle { margin-left: 3px; }
    `],Ft([Se({type:Boolean,reflect:!0})],nt.prototype,"open",2),Ft([Se()],nt.prototype,"label",2),Ft([Se({reflect:!0})],nt.prototype,"maxHeight",2),Ft([Se({type:Boolean})],nt.prototype,"disabled",2),Ft([pt("#content")],nt.prototype,"content",2),Ft([pt("#toggle")],nt.prototype,"toggleButton",2),Ft([pt("header")],nt.prototype,"header",2),Ft([ja()],nt.prototype,"transitioning",2),nt=Ft([Qt("rokit-collapsible")],nt);var fn,Gh=Object.defineProperty,Wh=Object.getOwnPropertyDescriptor,Sc=e=>{throw TypeError(e)},lt=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?Wh(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Gh(t,n,s),s},Ic=(e,t,n)=>t.has(e)||Sc("Cannot "+n),zh=(e,t,n)=>(Ic(e,t,"read from private field"),t.get(e)),Qh=(e,t,n)=>t.has(e)?Sc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Yo=(e,t,n,r)=>(Ic(e,t,"write to private field"),t.set(e,n),n);let Ue=class extends vt{constructor(){super(),this.type="text",this.readonly=!1,this.sticky=!1,this.minWidth=80,this.autoGrowLabelWidth=!1,Qh(this,fn,""),this.addEventListener("keydown",e=>{"Escape"===e.code&&this.blur()}),this.addEventListener("focus",()=>{this.classList.add("has-focus")}),this.addEventListener("blur",()=>{this.inputElement.scrollLeft=0,this.classList.remove("has-focus")})}firstUpdated(){Yo(this,fn,this.value),this.inputElement.addEventListener("change",()=>{this.value=this.inputElement.value}),this.autoGrowLabelWidth&&new IntersectionObserver(e=>{e.length&&e[0].isIntersecting&&this.updateMinWidth()}).observe(this)}updateMinWidth(){const e=this.shadowRoot.querySelector(".wrapper");if(e){const t=this.shadowRoot?.querySelector("label")?.scrollWidth||0,n=this.minWidth>t?this.minWidth:t;e.style.minWidth=n>0?n+"px":""}}updated(e){e.has("label")&&(this.classList.toggle("has-label",void 0!==this.label),this.autoGrowLabelWidth&&this.updateMinWidth()),e.has("min")&&(this.inputElement.min=this.min||""),e.has("max")&&(this.inputElement.max=this.max||""),e.has("step")&&(this.inputElement.step=this.step||""),e.has("placeholder")&&(this.inputElement.placeholder=this.placeholder||""),e.has("pattern")&&(this.inputElement.pattern=this.pattern||""),e.has("minLength")&&(this.inputElement.minLength=void 0===this.minLength?-1:this.minLength),e.has("maxLength")&&(this.inputElement.maxLength=void 0===this.maxLength?-1:this.maxLength),e.has("value")&&(this.classList.toggle("has-value",""!==this.value),this.setFormValue(this.value),this.updateValidity(this.inputElement.validity,this.inputElement.validationMessage,this.inputElement),this.value!==zh(this,fn)&&(Yo(this,fn,this.value),this.dispatchEvent(new CustomEvent("change",{bubbles:!0}))))}clear(){this.inputElement.value="",this.value="",this.blur()}renderInput(){return dt`<input id="input" part="input" size="1" name="${this.name}" type="${this.type}" autocomplete="off" ?disabled="${this.disabled}" ?readonly="${this.readonly}" ?required="${this.required}" .value="${"file"===this.type?"":this.value}">`}render(){return dt`
            <slot name="prefix" part="prefix"></slot>
            <div class="wrapper">
                <label for="input" part="label">${this.label}</label>
                ${this.renderInput()}
                ${this.clearable?dt`
                    <rokit-button class="clear" icon ?dense="${this.dense}" @mousedown="${e=>{e.preventDefault()}}" @click="${e=>{e.stopPropagation(),this.clear()}}" title="Clear"></rokit-button>
                `:Ve}
            </div>
            <slot name="suffix" part="suffix"></slot>
        `}};fn=new WeakMap,Ue.styles=[...vt.styles,St`
        :host { background-color: var(--rokit-light-background-color-inner); user-select: none; }
        :host([dense]) { padding: 2px 4px; }
        :host(.has-focus:not([readonly])) label, :host(.has-value) label, :host([sticky]) label { font-size: 0.75em; top: 0.5em; font-weight: 600; }
        :host(.has-focus) label { color: var(--rokit-primary-color-inner); }
        .wrapper { display: flex; position: relative; flex-grow: 1; align-items: center; }
        label { position: absolute; top: 50%; transform: translate(0, -50%); transition-property: top, font-size; transition-duration: var(--rokit-transition-duration-inner); max-width: 100%; overflow: hidden; pointer-events: none; white-space: nowrap; }
        #input { height: 1.3em; border: 0; outline: 0; flex-grow: 1; font-size: 1em; background: none; padding: 0; color: currentColor; font-family: inherit; text-overflow: ellipsis; }
        #input[type='file'] { padding-bottom: 3px; }
        #input[readonly] { caret-color: transparent; }
        #input[readonly]::placeholder { color: transparent; }
        :host(.has-label) #input { margin-top: 0.9em; }
        :host(.has-label:not(.has-focus):not(.has-value):not([sticky])) #input { clip-path: polygon(0 0, 0 0, 0 0, 0 0); }
        :host(:not(.has-value)) .clear { visibility: hidden; }
    `],lt([Se()],Ue.prototype,"type",2),lt([Se({type:Boolean,reflect:!0})],Ue.prototype,"readonly",2),lt([Se({type:Boolean,reflect:!0})],Ue.prototype,"sticky",2),lt([Se()],Ue.prototype,"pattern",2),lt([Se()],Ue.prototype,"minLength",2),lt([Se()],Ue.prototype,"maxLength",2),lt([Se()],Ue.prototype,"min",2),lt([Se()],Ue.prototype,"max",2),lt([Se()],Ue.prototype,"step",2),lt([Se()],Ue.prototype,"minWidth",2),lt([Se({type:Boolean})],Ue.prototype,"autoGrowLabelWidth",2),lt([pt("#input")],Ue.prototype,"inputElement",2),Ue=lt([Qt("rokit-input")],Ue);var xr,Qn,Xh=Object.defineProperty,Jh=Object.getOwnPropertyDescriptor,Nc=e=>{throw TypeError(e)},rt=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?Jh(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Xh(t,n,s),s},Rc=(e,t,n)=>t.has(e)||Nc("Cannot "+n),Zo=(e,t,n)=>(Rc(e,t,"read from private field"),n?n.call(e):t.get(e)),el=(e,t,n)=>t.has(e)?Nc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Hn=(e,t,n,r)=>(Rc(e,t,"write to private field"),t.set(e,n),n);let Ge=class extends vt{constructor(){super(),this.emptyMessage="Nothing to select",this.collapsibleOrientationLeft="0",this.collapsibleOrientationRight="0",this.collapsibleWidth="",this.autoGrowLabelWidth=!1,this.collapse=!1,this.filterableThreshold=15,this.itemCount=0,el(this,xr,""),el(this,Qn,""),this.addEventListener("focus",()=>{this.collapsible.toggle(!0)}),this.addEventListener("blur",()=>{this.checkInputValue(),this.collapsible.toggle(!1)}),this.addEventListener("input",()=>{this.collapsible.toggle(!0)})}firstUpdated(){Hn(this,xr,this.value),Hn(this,Qn,getComputedStyle(this).getPropertyValue("--rokit-list-indent-inner")),this.input.placeholder=void 0===this.placeholder?"Type to filter list...":this.placeholder,this.input.label=this.label,void 0!==this.inputMinWidth&&(this.input.minWidth=this.inputMinWidth),setTimeout(()=>{this.collapsible.maxHeight=parseInt(void 0!==this.collapsibleMaxHeight?this.collapsibleMaxHeight:getComputedStyle(this).getPropertyValue("--rokit-list-max-height-inner")),this.collapsible.content.style.width=this.collapsibleWidth,this.collapsible.content.style.left=this.collapsibleOrientationLeft,this.collapsible.content.style.right=this.collapsibleOrientationRight})}updated(e){if(e.has("selectedItem")){const e=this.value;this.value=this.selectedItem?this.itemValue(this.selectedItem):"",this.input.value=this.selectedItem?this.itemText(this.selectedItem):this.value,this.input.title=this.input.value,this.classList.toggle("has-value",""!==this.value),this.setFormValue(this.value),this.required&&""===this.value?this.updateValidity({valueMissing:!0},"Please select a value",this.listContainer):this.updateValidity(),e!==this.value&&this.dispatchEvent(new CustomEvent("change",{bubbles:!0}))}e.has("value")&&this.selectItem(this.findItem(this.value)),e.has("disabled")&&(this.input.disabled=this.disabled,this.collapsible.disabled=this.disabled),(e.has("filterableThreshold")||e.has("itemCount"))&&(this.input.readonly=this.filterableThreshold<0||this.itemCount<this.filterableThreshold),this.collapsible?.toggleButton&&(this.collapsible.toggleButton.style.display=0===this.listContainer.childElementCount?"none":"")}checkInputValue(e=!0){if(this.input.value){const e=this.findItem(this.input.value);if(e)return void this.selectItem(e)}e&&(this.input.value="",this.input.title="",Hn(this,xr,""),this.selectItem(null,!1))}filter(e){e=e.toLowerCase();let t=!0;for(const n of this.listContainer.querySelectorAll("li"))if("noresult"!==n.id){const r=-1==this.itemText(n).toLowerCase().indexOf(e);n.classList.toggle("hidden",r),this.collapse&&(n.classList.remove("open"),n.querySelector("ul")?.classList.remove("open")),r||(t=!1)}for(const n of this.listContainer.querySelectorAll("li:has(li:not(.hidden))"))n.classList.remove("hidden"),e&&this.collapse&&(n.classList.add("open"),n.querySelector("ul")?.classList.add("open")),t=!1;this.highlightItem(null),this.listContainer.querySelector("#noresult")?.classList.toggle("hidden",!t)}selectItem(e,t=!0){null!==e?.getAttribute("disabled")&&(e=null),this.selectedItem=e,this.filter(""),this.highlightItem(e,!1),t&&this.value&&Hn(this,xr,this.value),setTimeout(()=>this.blur())}findItem(e){if(e)for(const t of this.listContainer.querySelectorAll("li"))if(this.itemValue(t)===e||this.itemText(t)===e)return t;return null}highlightItem(e,t=!0){if(this.listContainer.querySelector("li.active")?.classList.remove("active"),e){if(t&&this.listContainer.focus(),e.classList.add("active"),this.collapse)for(let t=e.closest("ul");t;t=t.parentElement.closest("ul"))t.classList.add("open"),t.closest("li")?.classList.add("open");this.collapsible.open&&e.scrollIntoView({block:"nearest"})}}highlightNextItem(){const e=this.listContainer.querySelector("li.active");let t=e;const n=this.listContainer.querySelectorAll("ul.open > li:not([disabled]):not(.hidden):not(.divider)");if(e){for(let r=0;r<n.length;r++)if(n[r]===e&&r<n.length-1){t=n[r+1];break}}else n.length>0&&(t=n[0]);this.highlightItem(t)}highlightPreviousItem(){const e=this.listContainer.querySelector("li.active");let t=null;if(e){const n=this.listContainer.querySelectorAll("ul.open > li:not([disabled]):not(.hidden):not(.divider)");for(let r=0;r<n.length;r++)if(n[r]===e&&r>0){t=n[r-1];break}}this.highlightItem(t),t||this.input.focus()}itemValue(e){return e.dataset.value||this.itemText(e)||""}itemText(e){return e.querySelector("div > div")?.innerText||""}elementText(e){let t="";for(const n of e.childNodes)3==n.nodeType&&(t+=n.nodeValue?.trim());return t}onSlotChange(){this.listContainer.replaceChildren(),this.itemCount=0;let e=null;const t=this.shadowRoot.querySelector("#list-container-slot").assignedElements();if(1===t?.length&&(e=Array.prototype.slice.call(t[0].querySelectorAll(":scope > li")),this.copyItems(e,this.listContainer)),this.emptyMessage){const t=document.createElement("li");t.id="noresult",t.setAttribute("disabled",""),t.innerText=this.emptyMessage,this.listContainer.appendChild(t),e&&e.length>0&&t.classList.add("hidden")}this.value=this.value||Zo(this,xr),this.selectItem(this.findItem(this.value))}copyItems(e,t,n=0){if(void 0!==this.sort){const t=this.sort||"asc";e=e.sort((e,n)=>"desc"===t?(this.elementText(n)||this.itemValue(n)).localeCompare(this.elementText(e)||this.itemValue(e)):(this.elementText(e)||this.itemValue(e)).localeCompare(this.elementText(n)||this.itemValue(n)))}let r="";n>0&&(r=`calc(0.3em + ${n}*${Zo(this,Qn)})`);for(const i of e){const e=i.cloneNode();e.replaceChildren();const s=document.createElement("div");r&&(s.style.paddingLeft=r);const o=document.createElement("div");s.appendChild(o);for(const e of i.childNodes)if("UL"!==e.nodeName){const t=e.cloneNode(!0);3===t.nodeType&&t.nodeValue&&(t.nodeValue=t.nodeValue.trim()),o.appendChild(t)}e.appendChild(s),e.title=e.title||this.itemText(e);const a=i.querySelector("ul");if(a?.childElementCount){const t=document.createElement("ul");if(e.appendChild(t),this.copyItems(Array.prototype.slice.call(a.children),t,n+1),this.collapse){const n=new Ar;n.title="Open",n.dense=!0,n.icon=!0,n.classList.add("toggle-node","caret"),n.addEventListener("click",r=>{r.stopPropagation(),e.classList.toggle("open"),t.classList.toggle("open"),n.title=e.classList.contains("open")?"Close":"Open",this.collapsible.updateContentHeight()}),s.prepend(n)}else t.classList.add("open")}t.appendChild(e),this.itemCount++}}render(){return dt`
            <rokit-collapsible ?dense="${this.dense}" part="collapsible">
                <slot name="prefix" part="prefix" slot="prefix"></slot>
                <slot name="suffix" part="suffix" slot="suffix"></slot>
                <rokit-input id="input" slot="label"
                    ?clearable="${this.clearable}"
                    ?dense="${this.dense}"
                    @change="${()=>{this.checkInputValue(""===this.input.inputElement.value||!this.collapsible.open)}}"
                    @input="${()=>{this.filter(this.input.inputElement.value)}}"
                    @click="${()=>{this.collapsible.toggle(!0)}}"
                    ?autoGrowLabelWidth="${this.autoGrowLabelWidth}"
                    @keydown="${e=>{switch(e.code){case"ArrowDown":e.preventDefault(),this.highlightNextItem();break;case"Enter":{const e=this.findItem(this.input.value);e?this.selectItem(e):this.filter(this.input.value);break}}}}"
                ></rokit-input>
                <ul id="list-container" tabindex="-1" part="list" class="open"
                    @mousedown="${e=>{e.preventDefault()}}"
                    @click="${e=>{const t=e.target.closest("li");t&&null===t.getAttribute("disabled")&&!t.classList.contains("divider")&&this.selectItem(t)}}"
                    @keydown="${e=>{switch(e.code){case"Enter":this.selectItem(this.listContainer.querySelector("li.active"));break;case"ArrowDown":e.preventDefault(),this.highlightNextItem();break;case"ArrowUp":e.preventDefault(),this.highlightPreviousItem();break;case"ArrowRight":if(this.collapse){const t=this.listContainer.querySelector("li.active");t&&(e.preventDefault(),t.classList.add("open"),t.querySelector("ul")?.classList.add("open"),this.collapsible.updateContentHeight())}break;case"ArrowLeft":if(this.collapse){const t=this.listContainer.querySelector("li.active");t&&(e.preventDefault(),t.classList.remove("open"),t.querySelector("ul")?.classList.remove("open"),this.collapsible.updateContentHeight())}break;case"Escape":this.listContainer.blur()}}}">
                </ul>
                <slot id="list-container-slot" @slotchange=${this.onSlotChange}></slot>
            </rokit-collapsible>
        `}};xr=new WeakMap,Qn=new WeakMap,Ge.styles=[...vt.styles,St`
        :host { background-color: var(--rokit-light-background-color-inner); user-select: none; padding: 0; }
        :host([dense]) li > div { padding: 4px 2px; }
        :host([dense]) li.large > div, :host([dense]) li.header > div { padding-top: 6px; padding-bottom: 6px; }
        #input { padding: 0; background-color: inherit; }
        rokit-collapsible, #input { display: flex; flex-grow: 1; border: 0; }
        rokit-collapsible::part(content) { display: flex; flex-direction: column; padding-top: 0; outline: 0; z-index: 1000; position: absolute; top: calc(100% + 2px); background-color: var(--rokit-background-color-inner); }
        rokit-collapsible::part(header) { background-color: inherit !important; }
        rokit-collapsible[open].has-content::part(content), rokit-collapsible.has-content.transitioning::part(content) { border: 2px solid var(--rokit-primary-color-transparent-inner); box-shadow: 0 0 10px var(--rokit-shadow-color-inner); clip-path: inset(0 -13px -13px 0); }
        #list-container { outline: 0; }
        #list-container-slot { display: none; }
        ul { list-style-type: none; margin: 0; padding: 0; width: 100%; box-sizing: border-box; }
        li > div, #noresult { display: flex; align-items:center; line-height: 1em; padding: 8px; white-space: nowrap; transition: all calc(0.5 * var(--rokit-transition-duration-inner)); }
        li:not([disabled]):not(.divider) { cursor: pointer }
        li:not([disabled]):not(.divider) > div:hover { background-color: var(--rokit-light-background-color-inner); }
        li.active > div { color: var(--rokit-primary-color-inner); background-color: var(--rokit-light-background-color-inner); }
        li.divider { border-top: 1px solid var(--rokit-light-background-darker-color-inner); height: 0; padding: 0; }
        li.divider, li.header { pointer-events: none; }
        li.header > div { font-size: 0.7rem; font-weight: bold; padding-top: 8px; }
        li.large > div { padding-top: 10px; padding-bottom: 10px; }
        .hidden { display: none !important; }
        :host([collapse]) li > div { padding-left: 0; }
        :host([collapse]) .toggle-node { position: absolute }
        :host([collapse]) li > div > div { padding-left: 1.8em; }
        :host([collapse]) ul:not(.open) { display: none; }
        :host([collapse]) li:not(.open) > div > .toggle-node::part(link):before { transform: translate(0em, 0em) rotate(-45deg); }
    `],rt([Se()],Ge.prototype,"emptyMessage",2),rt([Se()],Ge.prototype,"sort",2),rt([Se()],Ge.prototype,"collapsibleMaxHeight",2),rt([Se()],Ge.prototype,"collapsibleOrientationLeft",2),rt([Se()],Ge.prototype,"collapsibleOrientationRight",2),rt([Se()],Ge.prototype,"collapsibleWidth",2),rt([Se({type:Boolean})],Ge.prototype,"autoGrowLabelWidth",2),rt([Se()],Ge.prototype,"inputMinWidth",2),rt([Se({type:Boolean,reflect:!0})],Ge.prototype,"collapse",2),rt([Se()],Ge.prototype,"filterableThreshold",2),rt([pt("rokit-collapsible")],Ge.prototype,"collapsible",2),rt([pt("#input")],Ge.prototype,"input",2),rt([pt("#list-container")],Ge.prototype,"listContainer",2),rt([ja()],Ge.prototype,"selectedItem",2),rt([ja()],Ge.prototype,"itemCount",2),Ge=rt([Qt("rokit-select")],Ge);var Kh=Object.defineProperty,Yh=Object.getOwnPropertyDescriptor,fi=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?Yh(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Kh(t,n,s),s};let cr=class extends Ue{constructor(){super(...arguments),this.resize="none",this.rows=3}firstUpdated(){super.firstUpdated(),this.inputElement.rows=this.rows,void 0!==this.cols&&(this.inputElement.cols=this.cols),"auto"===this.resize?(this.inputElement.style.resize="none",this.inputElement.addEventListener("input",()=>this.autoResize())):this.inputElement.style.resize=this.resize}updated(e){super.updated(e),"auto"===this.resize&&e.has("resize")&&new IntersectionObserver(e=>{e.length&&e[0].isIntersecting&&this.autoResize()}).observe(this),"auto"===this.resize&&e.has("value")&&this.autoResize()}autoResize(){this.inputElement.style.height="",this.inputElement.style.height=this.inputElement.scrollHeight+"px"}onSlotChange(){const e=this.shadowRoot.querySelector("#content").assignedNodes().map(e=>e.textContent).join("");""!==e.trim()&&(this.value=e)}renderInput(){return dt`
        <textarea id="input" part="input" autocomplete="off" name="${this.name}" ?disabled="${this.disabled}" ?readonly="${this.readonly}" ?required="${this.required}" .value="${this.value}"></textarea>
        <slot id="content" @slotchange=${this.onSlotChange}></slot>
        `}};cr.styles=[...Ue.styles,St`
        :host, .wrapper { align-items: flex-start; }
        #input { height: initial; }
        #content { display: none; }
    `],fi([Se()],cr.prototype,"resize",2),fi([Se()],cr.prototype,"rows",2),fi([Se()],cr.prototype,"cols",2),cr=fi([Qt("rokit-textarea")],cr);var Me,At,Er,Zh=Object.defineProperty,ef=Object.getOwnPropertyDescriptor,Tc=e=>{throw TypeError(e)},It=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?ef(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&Zh(t,n,s),s},Ac=(e,t,n)=>t.has(e)||Tc("Cannot "+n),je=(e,t,n)=>(Ac(e,t,"read from private field"),n?n.call(e):t.get(e)),zi=(e,t,n)=>t.has(e)?Tc("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Vn=(e,t,n,r)=>(Ac(e,t,"write to private field"),t.set(e,n),n);const Vt=18;let Ot=class extends Ue{constructor(){super(...arguments),this.labelFormatter=e=>String(e),zi(this,Me,[0,1]),zi(this,At,[je(this,Me)[0],je(this,Me)[1]]),zi(this,Er)}firstUpdated(){super.firstUpdated(),this.sliderElement.addEventListener("mousedown",e=>this.onKnobDrag(e)),this.sliderElement.addEventListener("touchstart",e=>this.onKnobDrag(e)),new ResizeObserver(()=>{this.updateKnobPositions()}).observe(this.sliderElement)}updated(e){if(super.updated(e),e.has("min")&&(je(this,Me)[0]=parseFloat(this.min||"0"),je(this,Me)[1]=Math.max(je(this,Me)[0],je(this,Me)[1])),e.has("max")&&(je(this,Me)[1]=parseFloat(this.max||"1"),je(this,Me)[0]=Math.min(je(this,Me)[0],je(this,Me)[1])),e.has("step")&&Vn(this,Er,this.step?parseFloat(this.step):void 0),e.has("value")||e.has("min")||e.has("max"))if(this.value)if(void 0!==this.range){const e=JSON.parse(this.value);Vn(this,At,[this.applyConstraints(e[0]),this.applyConstraints(e[1])])}else Vn(this,At,[this.applyConstraints(parseFloat(this.value))]);else Vn(this,At,[je(this,Me)[0],je(this,Me)[1]]);this.updateKnobPositions()}updateValidity(e,t){super.updateValidity(e,t,this.sliderElement)}chooseKnob(e){if(!this.endKnob)return this.startKnob;let t=Math.abs(e-this.startKnob.offsetLeft)<Math.abs(e-this.endKnob.offsetLeft)?this.startKnob:this.endKnob;return this.startKnob.value===this.endKnob.value&&("start"===t.id&&t.value===je(this,Me)[0]?t=this.endKnob:"end"===t.id&&t.value===je(this,Me)[1]&&(t=this.startKnob)),t}toScreenSpace(e){return(e-je(this,Me)[0])/(je(this,Me)[1]-je(this,Me)[0])*this.track.offsetWidth}toValueSpace(e){return e/this.track.offsetWidth*(je(this,Me)[1]-je(this,Me)[0])+je(this,Me)[0]}applyConstraints(e,t){let n=Math.min(Math.max(e,je(this,Me)[0]),je(this,Me)[1]);return je(this,Er)&&(n=Math.round(n/je(this,Er))*je(this,Er)),void 0!==t&&this.endKnob&&(n=t?Math.min(n,this.endKnob.value):Math.max(n,this.startKnob.value)),n}updateKnob(e,t){e.value=t,e.offset=this.toScreenSpace(t),e.label=this.labelFormatter(t),this.endKnob&&("start"===e.id?this.track.style.borderLeftWidth=e.offset+"px":this.track.style.borderRightWidth=this.track.offsetWidth-e.offset+"px")}updateKnobPositions(){this.updateKnob(this.startKnob,je(this,At)[0]),this.endKnob&&this.updateKnob(this.endKnob,je(this,At)[1])}onKnobDrag(e){if(e.target instanceof Dr||this.classList.contains("has-value")||this.classList.contains("has-focus")){let t;const n=e=>{let n=0;n="touchmove"===e.type||"touchstart"===e.type?e.touches[0].clientX:e.clientX,n-=this.track.getBoundingClientRect().left,t||(t=this.chooseKnob(n),t.classList.add("focus")),this.updateKnob(t,this.applyConstraints(this.toValueSpace(n),"start"===t.id))},r=()=>{document.removeEventListener("mousemove",n),document.removeEventListener("touchmove",n),document.removeEventListener("mouseup",r),document.removeEventListener("touchend",r),t&&(t.classList.remove("focus"),void 0!==this.range?"end"===t.id?this.value=JSON.stringify([je(this,At)[0],t.value]):this.value=JSON.stringify([t.value,je(this,At)[1]]):this.value=String(t.value)),t=void 0};this.sliderElement.focus(),document.addEventListener("mousemove",n),document.addEventListener("touchmove",n),document.addEventListener("mouseup",r),document.addEventListener("touchend",r),n(e)}}renderInput(){return dt`
        ${super.renderInput()}
        <div id="slider" part="slider" tabindex="0" ?range="${void 0!==this.range}">
            <div id="track"></div>
            <rokit-slider-knob id="start"></rokit-slider-knob>
            ${void 0===this.range?Ve:dt`
                <rokit-slider-knob id="end"></rokit-slider-knob>
            `}
        </div>
        `}};Me=new WeakMap,At=new WeakMap,Er=new WeakMap,Ot.styles=[...Ue.styles,St`
        :host(.has-label:not(:focus):not(.has-value):not([sticky])) #slider > * { visibility: hidden; }
        :host(.has-label) .wrapper { padding-top: 1em; }
        :host([sticky]) #slider { margin-top: ${26.5}px; }
        #input { display: none; }
        #slider { display: flex; position: relative; align-items: center; width: 100%; height: ${18}px; padding: 0 ${9}px; outline: 0; }
        :host(:not([sticky])) #slider:not(:focus) rokit-slider-knob::part(label) { color: transparent; background-color: transparent; border-color: transparent; top: 0; }
        #track { height: 2px;  flex-grow: 1; background-color: #CCC; }
        #slider[range] #track { background-color: color-mix(in srgb, var(--rokit-primary-color-inner) 60%, transparent); border-width: 0; border-color: #CCC; border-style: solid; }
    `],It([Se()],Ot.prototype,"range",2),It([Se()],Ot.prototype,"labelFormatter",2),It([pt("#slider")],Ot.prototype,"sliderElement",2),It([pt("#track")],Ot.prototype,"track",2),It([pt("#start")],Ot.prototype,"startKnob",2),It([pt("#end")],Ot.prototype,"endKnob",2),Ot=It([Qt("rokit-slider")],Ot);let Dr=class extends lr{constructor(){super(...arguments),this.offset=0,this.label="",this.value=0}updated(e){e.has("offset")&&(this.style.left=this.offset+"px")}render(){return dt`<label part="label">${this.label}</label>`}};Dr.styles=[St`
        :host { position: absolute; width: ${18}px; height: ${18}px; border-radius: ${18}px; background-color: var(--rokit-primary-color-inner); }
        :host(.focus), :host(:hover) { box-shadow: 0 0 0 ${9}px var(--rokit-primary-color-transparent-inner); z-index: 1; }
        label {
            position: absolute;
            top: calc(-2em - ${4.5}px);
            left: 50%;
            transform: translate(-50%, 0);
            white-space: nowrap;
            font-size: 0.75em;
            font-weight: 500;
            transition-property: top color background-color;
            transition-duration: var(--rokit-transition-duration-inner);
            pointer-events: none;
            color: white;
            background-color: var(--rokit-primary-color-inner);
            padding: 0 4px;
            border-radius: 3px;
        }
        label:after {
            content: '';
            width: 10px;
            height: 10px;
            position: absolute;
            left: 50%;
            bottom: -4px;
            transform: translate(-50%, 0);
            background-color: inherit;
            clip-path: polygon(50% 50%, 100% 50%, 50% 100%, 0 50%);
        }
    `],It([Se()],Dr.prototype,"offset",2),It([Se()],Dr.prototype,"label",2),Dr=It([Qt("rokit-slider-knob")],Dr);var tf=Object.defineProperty,rf=Object.getOwnPropertyDescriptor,Tn=(e,t,n,r)=>{for(var i,s=r>1?void 0:r?rf(t,n):t,o=e.length-1;o>=0;o--)(i=e[o])&&(s=(r?i(t,n,s):i(s))||s);return r&&s&&tf(t,n,s),s};let dr=class extends $t{constructor(){super(...arguments),this.open=!1,this.closable=!1,this.title=""}firstUpdated(){this.dialogElement.addEventListener("close",()=>{this.open=!1,this.dispatchEvent(new Event("close"))})}updated(e){if(e.has("open"))if(this.open)document.body.style.top=`-${window.scrollY}px`,document.body.style.position="fixed",this.dialogElement.showModal();else{const e=document.body.style.top;document.body.style.position="",document.body.style.top="",window.scrollTo(0,-1*parseInt(e||"0")),this.dialogElement.close()}}render(){return dt`
            <dialog id="dialog" part="dialog">
                <header>
                    <div class="title" part="title">
                        <slot name="header">${this.title}</slot>
                    </div>
                    ${this.closable?dt`
                        <rokit-button class="clear" icon ?dense="${this.dense}" @click="${()=>{this.open=!1}}" title="Close"></rokit-button>
                    `:Ve}
                </header>
                <main>
                    <slot></slot>
                </main>
            </dialog>
        `}};dr.styles=[...$t.styles,St`
        dialog[open] { display: flex; flex-direction: column; width: 100%; max-width: 90vw; max-height: 90vh; margin: auto; outline: 0; border: 0; border-radius: 1em; }
        dialog::backdrop { background-color: #0007; }
        header { display: flex; align-items: center; }
        .title { font-weight: 600; flex-grow: 1; text-align: center; }
        .clear { justify-self: flex-end; }
        main { flex-grow: 1; overflow: auto; }
    `],Tn([Se({type:Boolean,reflect:!0})],dr.prototype,"open",2),Tn([Se({type:Boolean})],dr.prototype,"closable",2),Tn([Se()],dr.prototype,"title",2),Tn([pt("#dialog")],dr.prototype,"dialogElement",2),dr=Tn([Qt("rokit-dialog")],dr);class ri extends HTMLElement{constructor(e,t,n,r){if(super(),this.template=new Gd(n.store.getQuads(e,null,null,null),t,n),this.template.extendedShapes.length&&null!==this.template.config.attributes.collapse&&(!this.template.maxCount||this.template.maxCount>1)){const e=new nt;e.classList.add("collapsible","shacl-group"),e.open="open"===n.attributes.collapse,e.label=this.template.label,this.container=e}else this.container=this;if(void 0!==this.template.order&&(this.style.order=`${this.template.order}`),this.template.cssClass&&this.classList.add(this.template.cssClass),n.editMode&&!t.linked&&(this.addButton=this.createAddButton(),this.container.appendChild(this.addButton)),this.template.path){let e=[];r&&(e=t.linked?n.store.getQuads(r,this.template.path,null,null):n.store.getQuads(r,this.template.path,null,Dt));let i=!1;for(const t of e)this.isValueValid(t.object)&&(this.addPropertyInstance(t.object),this.template.hasValue&&t.object.equals(this.template.hasValue)&&(i=!0));n.editMode&&this.template.hasValue&&!i&&!t.linked&&this.addPropertyInstance(this.template.hasValue)}n.editMode&&!t.linked&&(this.addEventListener("change",()=>{this.updateControls()}),this.updateControls()),this.container instanceof nt&&(n.editMode&&!t.linked||this.container.childElementCount>0)&&this.appendChild(this.container)}addPropertyInstance(e){let t;if(this.template.shaclOr?.length||this.template.shaclXone?.length){const n=this.template.shaclOr?.length?this.template.shaclOr:this.template.shaclXone;let r=!1;if(e){const i=Ud(n,e,this.template.config);i.length&&(t=Xn(this.template.clone().merge(i),e,!0),r=!0)}r||(t=dc(n,this,this.template.config),Dc(t,""))}else{let n=!1;if(e&&!(e instanceof ct)){const t=this.getRdfClassToLinkOrCreate();t&&0===this.template.config.store.countQuads(e,tt,t,Dt)&&(n=!0)}t=Xn(this.template,e,void 0,n||this.template.parent.linked)}return this.addButton?this.container.insertBefore(t,this.addButton):this.container.appendChild(t),t}updateControls(){let e,t=this.querySelectorAll(":scope > .property-instance, :scope > .shacl-or-constraint, :scope > shacl-node").length;0===t&&(!this.template.extendedShapes.length||void 0!==this.template.minCount&&this.template.minCount>0)&&(this.addPropertyInstance(),t=this.querySelectorAll(":scope > .property-instance, :scope > .shacl-or-constraint, :scope > shacl-node").length),e=void 0!==this.template.minCount?t>this.template.minCount:this.template.extendedShapes.length>0||t>1;const n=void 0===this.template.maxCount||t<this.template.maxCount;this.classList.toggle("may-remove",e),this.classList.toggle("may-add",n)}toRDF(e,t){for(const n of this.querySelectorAll(":scope > .property-instance, :scope > .collapsible > .property-instance")){const r=Ne.namedNode(n.dataset.path);if(n.firstChild instanceof Wt){const i=n.firstChild.toRDF(e);e.addQuad(t,r,i,this.template.config.valuesGraphId)}else for(const i of n.querySelectorAll(":scope > .editor")){const n=Kd(i);n&&e.addQuad(t,r,n,this.template.config.valuesGraphId)}}}getRdfClassToLinkOrCreate(){if(this.template.class&&this.template.node)return this.template.class;for(const e of this.template.extendedShapes){const t=this.template.config.store.getObjects(e,Nr,null);if(t.length>0)return t[0]}}isValueValid(e){if(!this.template.extendedShapes.length)return!0;for(const t of this.template.extendedShapes){const n=this.template.config.store.getObjects(t,Nr,null);for(const t of n)if(this.template.config.store.countQuads(e,tt,t,null)>0)return!0}return!1}createAddButton(){const e=new Ge;e.dense=!0,e.label="+ "+this.template.label,e.title="Add "+this.template.label,e.autoGrowLabelWidth=!0,e.classList.add("add-button");let t=[],n=this.getRdfClassToLinkOrCreate();if(n&&(t=Ia(n,this.template)),0===t.length)e.emptyMessage="",e.inputMinWidth=0,e.addEventListener("click",t=>{e.blur();const n=this.addPropertyInstance();n.classList.add("fadeIn"),this.updateControls(),setTimeout(()=>{Bd(n),n.classList.remove("fadeIn")},200)});else{const n=document.createElement("ul"),r=document.createElement("li");r.innerHTML="&#xFF0B; Create new "+this.template.label+"...",r.dataset.value="new",r.classList.add("large"),n.appendChild(r);const i=document.createElement("li");i.classList.add("divider"),n.appendChild(i);const s=document.createElement("li");s.classList.add("header"),s.innerText="Or link existing:",n.appendChild(s);for(const e of t){const t=document.createElement("li"),r="string"==typeof e.value?e.value:e.value.value;t.innerText=e.label?e.label:r,t.dataset.value=JSON.stringify(e.value),n.appendChild(t)}e.appendChild(n),e.collapsibleWidth="250px",e.collapsibleOrientationLeft="",e.addEventListener("change",()=>{if("new"===e.value)this.addPropertyInstance();else{const t=JSON.parse(e.value);this.container.insertBefore(Xn(this.template,t,!0,!0),e)}e.value=""})}return e}}function Xn(e,t,n=!1,r=!1){let i;if(e.extendedShapes.length){i=document.createElement("div"),i.classList.add("property-instance");for(const n of e.extendedShapes)i.appendChild(new Wt(n,e.config,t,e.parent,e.nodeKind,e.label,r))}else{const n=eh(e.path,e.datatype?.value);i=n?e.config.editMode&&!r?n.createEditor(e,t):n.createViewer(e,t):Qd(e,t||null,e.config.editMode&&!r),i.classList.add("property-instance"),r&&i.classList.add("linked")}return e.config.editMode&&Dc(i,e.label,n),i.dataset.path=e.path,i}function Dc(e,t,n=!1){const r=new Ar;r.classList.add("remove-button","clear"),r.title="Remove "+t,r.dense=!0,r.icon=!0,r.addEventListener("click",t=>{e.classList.remove("fadeIn"),e.classList.add("fadeOut"),setTimeout(()=>{const t=e.parentElement;e.remove(),t?.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0}))},200)}),n&&r.classList.add("persistent"),e.appendChild(r)}function nf(e,t){let n=e;const r=t.store.getQuads(e,null,null,null),i=yn(r,"label",va,t.languages);let s;if(i&&(n=i),null!==t.attributes.collapse)s=new nt,s.classList.add("collapsible"),s.open="open"===t.attributes.collapse,s.label=n;else{s=document.createElement("div");const e=document.createElement("h1");e.innerText=n,s.appendChild(e)}s.dataset.subject=e,s.classList.add("shacl-group");const o=yn(r,"order");return o&&(s.style.order=o),s}window.customElements.define("shacl-property",ri);const Je=[];for(let e=0;e<256;++e)Je.push((e+256).toString(16).slice(1));function sf(e,t=0){return(Je[e[t+0]]+Je[e[t+1]]+Je[e[t+2]]+Je[e[t+3]]+"-"+Je[e[t+4]]+Je[e[t+5]]+"-"+Je[e[t+6]]+Je[e[t+7]]+"-"+Je[e[t+8]]+Je[e[t+9]]+"-"+Je[e[t+10]]+Je[e[t+11]]+Je[e[t+12]]+Je[e[t+13]]+Je[e[t+14]]+Je[e[t+15]]).toLowerCase()}let Qi;const af=new Uint8Array(16);function of(){if(!Qi){if(typeof crypto>"u"||!crypto.getRandomValues)throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");Qi=crypto.getRandomValues.bind(crypto)}return Qi(af)}const lf=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),tl={randomUUID:lf};function rl(e,t,n){if(tl.randomUUID&&!e)return tl.randomUUID();const r=(e=e||{}).random??e.rng?.()??of();if(r.length<16)throw new Error("Random bytes length must be >= 16");return r[6]=15&r[6]|64,r[8]=63&r[8]|128,sf(r)}class Wt extends HTMLElement{constructor(e,t,n,r,i,s,o){super(),this.owlImports=[],this.parent=r,this.config=t,this.shaclSubject=e,this.linked=o||!1;let a=n;if(!a){if(!i){const n=t.store.getObjects(e,`${xe}nodeKind`,null);n.length&&(i=n[0])}a=void 0===i&&t.attributes.valuesNamespace||i?.value===`${xe}IRI`?Ne.namedNode(t.attributes.valuesNamespace+rl()):Ne.blankNode(rl())}this.nodeId=a;const l=JSON.stringify([e,n]);if(n&&t.renderedNodes.has(l)){s=s||"Link";const e=document.createElement("label");e.innerText=s,e.classList.add("linked"),this.appendChild(e);const t=document.createElement("a");let r="BlankNode"===n.termType?"_:"+n.value:n.value;t.innerText=r,t.classList.add("ref-link"),t.onclick=()=>{this.config.form.querySelector(`shacl-node[data-node-id='${r}']`)?.scrollIntoView()},this.appendChild(t),this.style.flexDirection="row"}else{if(n&&t.renderedNodes.add(l),this.dataset.nodeId=this.nodeId.id,null!==this.config.attributes.showNodeIds){const e=document.createElement("div");e.innerText=`id: ${this.nodeId.id}`,e.classList.add("node-id-display"),this.appendChild(e)}for(const n of t.store.getQuads(e,Ea,null,null))this.owlImports.push(n.object);for(const r of t.store.getQuads(e,null,null,null))switch(r.predicate.id){case Zn.id:this.addPropertyInstance(r.object,t,n);break;case`${xe}and`:const e=t.lists[r.object.value];if(e?.length)for(const r of e)this.prepend(new Wt(r,t,n,this));else console.error("list not found:",r.object.value,"existing lists:",t.lists);break;case Fd.id:this.prepend(new Wt(r.object,t,n,this));break;case`${xe}targetClass`:this.targetClass=r.object;break;case`${xe}or`:case`${xe}xone`:this.tryResolve(r.object,n,t)}if(s){const e=document.createElement("h1");e.innerText=s,this.prepend(e)}}}toRDF(e,t){if(t||(t=this.nodeId),!this.linked){for(const n of this.querySelectorAll(":scope > shacl-node, :scope > .shacl-group > shacl-node, :scope > shacl-property, :scope > .shacl-group > shacl-property"))n.toRDF(e,t);this.targetClass&&e.addQuad(t,tt,this.targetClass,this.config.valuesGraphId),this.config.attributes.generateNodeShapeReference&&!this.parent&&e.addQuad(t,Ne.namedNode(this.config.attributes.generateNodeShapeReference),this.shaclSubject,this.config.valuesGraphId)}return t}addPropertyInstance(e,t,n){let r=this;const i=t.store.getQuads(e,`${xe}group`,null,null);if(i.length>0){const e=i[0].object.value;if(t.groups.indexOf(e)>-1){let n=this.querySelector(`:scope > .shacl-group[data-subject='${e}']`);n||(n=nf(e,t),this.appendChild(n)),r=n}else console.warn("ignoring unknown group reference",i[0],"existing groups:",t.groups)}const s=new ri(e,this,t,n);s.childElementCount>0&&r.appendChild(s)}tryResolve(e,t,n){const r=n.lists[e.value];if(r?.length){let e=!1;if(t){const i=Hd(r,t,n);if(i.length){for(const e of i)this.addPropertyInstance(e,n,t);e=!0}}e||this.appendChild(dc(r,this,n))}else console.error("list for sh:or/sh:xone not found:",e,"existing lists:",n.lists)}}window.customElements.define("shacl-node",Wt);var nl,il,Yt={},Zt={},er={},Tt={};function uf(){if(nl)return Tt;function e(e){const t=[];let r=0;for(;r<e.length;)switch(e[r]){case"/":if("."===e[r+1])if("."===e[r+2]){if(!n(e[r+3])){t.push([]),r++;break}t.pop(),e[r+3]||t.push([]),r+=3}else{if(!n(e[r+2])){t.push([]),r++;break}e[r+2]||t.push([]),r+=2}else t.push([]),r++;break;case"#":case"?":t.length||t.push([]),t[t.length-1].push(e.substr(r)),r=e.length;break;default:t.length||t.push([]),t[t.length-1].push(e[r]),r++}return"/"+t.map(e=>e.join("")).join("/")}function t(t,n){let r=n+1;n>=0?"/"===t[n+1]&&"/"===t[n+2]&&(r=n+3):"/"===t[0]&&"/"===t[1]&&(r=2);const i=t.indexOf("/",r);return i<0?t:t.substr(0,i)+e(t.substr(i))}function n(e){return!e||"#"===e||"?"===e||"/"===e}return nl=1,Object.defineProperty(Tt,"__esModule",{value:!0}),Tt.removeDotSegmentsOfPath=Tt.removeDotSegments=Tt.resolve=void 0,Tt.resolve=function(n,r){const i=(r=r||"").indexOf("#");if(i>0&&(r=r.substr(0,i)),!n.length){if(r.indexOf(":")<0)throw new Error(`Found invalid baseIRI '${r}' for value '${n}'`);return r}if(n.startsWith("?")){const e=r.indexOf("?");return e>0&&(r=r.substr(0,e)),r+n}if(n.startsWith("#"))return r+n;if(!r.length){const e=n.indexOf(":");if(e<0)throw new Error(`Found invalid relative IRI '${n}' for a missing baseIRI`);return t(n,e)}const s=n.indexOf(":");if(s>=0)return t(n,s);const o=r.indexOf(":");if(o<0)throw new Error(`Found invalid baseIRI '${r}' for value '${n}'`);const a=r.substr(0,o+1);if(0===n.indexOf("//"))return a+t(n,s);let l;if(r.indexOf("//",o)===o+1){if(l=r.indexOf("/",o+3),l<0)return r.length>o+3?r+"/"+t(n,s):a+t(n,s)}else if(l=r.indexOf("/",o+1),l<0)return a+t(n,s);if(0===n.indexOf("/"))return r.substr(0,l)+e(n);let c=r.substr(l);const u=c.lastIndexOf("/");return u>=0&&u<c.length-1&&(c=c.substr(0,u+1),"."===n[0]&&"."!==n[1]&&"/"!==n[1]&&n[2]&&(n=n.substr(1))),n=e(n=c+n),r.substr(0,l)+n},Tt.removeDotSegments=e,Tt.removeDotSegmentsOfPath=t,Tt}function cf(){return il||(il=1,e=er,t=er&&er.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n),Object.defineProperty(e,r,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=er&&er.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(uf(),e)),er;var e,t,n}var sl,tr={},Xi={};function df(){return sl||(sl=1,function(e){function t(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="\t\n\r -퟿-�𐀀-􏿿",e.S=" \t\r\n",e.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.CHAR_RE=new RegExp("^["+e.CHAR+"]$","u"),e.S_RE=new RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=new RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=new RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=new RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=new RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(e){return e>=32&&e<=55295||10===e||13===e||9===e||e>=57344&&e<=65533||e>=65536&&e<=1114111},e.isS=function(e){return 32===e||10===e||13===e||9===e},e.isNameStartChar=t,e.isNameChar=function(e){return t(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}}(Xi)),Xi}var al,Ji={};function hf(){return al||(al=1,function(e){function t(e){return e>=65&&e<=90||e>=97&&e<=122||58===e||95===e||8204===e||8205===e||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="-퟿-�𐀀-􏿿",e.RESTRICTED_CHAR="-\b\v\f---",e.S=" \t\r\n",e.NAME_START_CHAR=":A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.CHAR_RE=new RegExp("^["+e.CHAR+"]$","u"),e.RESTRICTED_CHAR_RE=new RegExp("^["+e.RESTRICTED_CHAR+"]$","u"),e.S_RE=new RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=new RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=new RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=new RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=new RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(e){return e>=1&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},e.isRestrictedChar=function(e){return e>=1&&e<=8||11===e||12===e||e>=14&&e<=31||e>=127&&e<=132||e>=134&&e<=159},e.isCharAndNotRestricted=function(e){return 9===e||10===e||13===e||e>31&&e<127||133===e||e>159&&e<=55295||e>=57344&&e<=65533||e>=65536&&e<=1114111},e.isS=function(e){return 32===e||10===e||13===e||9===e},e.isNameStartChar=t,e.isNameChar=function(e){return t(e)||e>=48&&e<=57||45===e||46===e||183===e||e>=768&&e<=879||e>=8255&&e<=8256}}(Ji)),Ji}var ol,ll,Ki={};function ff(){return ol||(ol=1,function(e){function t(e){return e>=65&&e<=90||95===e||e>=97&&e<=122||e>=192&&e<=214||e>=216&&e<=246||e>=248&&e<=767||e>=880&&e<=893||e>=895&&e<=8191||e>=8204&&e<=8205||e>=8304&&e<=8591||e>=11264&&e<=12271||e>=12289&&e<=55295||e>=63744&&e<=64975||e>=65008&&e<=65533||e>=65536&&e<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.NC_NAME_START_CHAR="A-Z_a-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�𐀀-󯿿",e.NC_NAME_CHAR="-"+e.NC_NAME_START_CHAR+".0-9·̀-ͯ‿-⁀",e.NC_NAME_START_CHAR_RE=new RegExp("^["+e.NC_NAME_START_CHAR+"]$","u"),e.NC_NAME_CHAR_RE=new RegExp("^["+e.NC_NAME_CHAR+"]$","u"),e.NC_NAME_RE=new RegExp("^["+e.NC_NAME_START_CHAR+"]["+e.NC_NAME_CHAR+"]*$","u"),e.isNCNameStartChar=t,e.isNCNameChar=function(e){return t(e)||45===e||46===e||e>=48&&e<=57||183===e||e>=768&&e<=879||e>=8255&&e<=8256}}(Ki)),Ki}function pf(){if(ll)return tr;ll=1,Object.defineProperty(tr,"__esModule",{value:!0}),tr.SaxesParser=tr.EVENTS=void 0;const e=df(),t=hf(),n=ff();var r=e.isS,i=e.isChar,s=e.isNameStartChar,o=e.isNameChar,a=e.S_LIST,l=e.NAME_RE,c=t.isChar,u=n.isNCNameStartChar,d=n.isNCNameChar,h=n.NC_NAME_RE;const p="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/2000/xmlns/",g={__proto__:null,xml:p,xmlns:f},m={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},b=-1,y=-2,v=13,w=33,_=10,x=60,S=61,E=62,I=63,j=93,T=e=>34===e||39===e,N=[34,39],k=[...N,91,E],R=[...N,x,j],C=[S,I,...a],A=[...a,E,38,x];function O(e,t,n){switch(t){case"xml":n!==p&&e.fail(`xml prefix must be bound to ${p}.`);break;case"xmlns":n!==f&&e.fail(`xmlns prefix must be bound to ${f}.`)}switch(n){case f:e.fail(""===t?`the default namespace may not be set to ${n}.`:`may not assign a prefix (even "xmlns") to the URI ${f}.`);break;case p:switch(t){case"xml":break;case"":e.fail(`the default namespace may not be set to ${n}.`);break;default:e.fail("may not assign the xml namespace to another prefix.")}}}const L=e=>h.test(e),$=e=>l.test(e);tr.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];const D={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};return tr.SaxesParser=class{get closed(){return this._closed}constructor(e){this.opt=e??{},this.fragmentOpt=!!this.opt.fragment;const t=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,t){this.nameStartCheck=u,this.nameCheck=d,this.isName=L,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},g);const e=this.opt.additionalNamespaces;null!=e&&(function(e,t){for(const n of Object.keys(t))O(e,n,t[n])}(this,e),Object.assign(this.ns,e))}else this.nameStartCheck=s,this.nameCheck=o,this.isName=$,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}_init(){var e;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];const{fragmentOpt:t}=this;this.state=t?v:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=t,this.xmlDeclPossible=!t,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:n}=this.opt;if(void 0===n){if(!0===this.opt.forceXMLVersion)throw new Error("forceXMLVersion set but defaultXMLVersion is not set");n="1.0"}this.setXMLVersion(n),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(m),null===(e=this.readyHandler)||void 0===e||e.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(e,t){this[D[e]]=t}off(e){this[D[e]]=void 0}makeError(e){var t;let n=null!==(t=this.fileName)&&void 0!==t?t:"";return this.trackPosition&&(n.length>0&&(n+=":"),n+=`${this.line}:${this.column}`),n.length>0&&(n+=": "),new Error(n+e)}fail(e){const t=this.makeError(e),n=this.errorHandler;if(void 0===n)throw t;return n(t),this}write(e){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let t=!1;null===e?(t=!0,e=""):"object"==typeof e&&(e=e.toString()),void 0!==this.carriedFromPrevious&&(e=`${this.carriedFromPrevious}${e}`,this.carriedFromPrevious=void 0);let n=e.length;const r=e.charCodeAt(n-1);!t&&(13===r||r>=55296&&r<=56319)&&(this.carriedFromPrevious=e[n-1],n--,e=e.slice(0,n));const{stateTable:i}=this;for(this.chunk=e,this.i=0;this.i<n;)i[this.state].call(this);return this.chunkPosition+=n,t?this.end():this}close(){return this.write(null)}getCode10(){const{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return b;const n=e.charCodeAt(t);if(this.column++,n<55296){if(n>=32||9===n)return n;switch(n){case _:return this.line++,this.column=0,this.positionAtNewLine=this.position,_;case 13:return e.charCodeAt(t+1)===_&&(this.i=t+2),this.line++,this.column=0,this.positionAtNewLine=this.position,y;default:return this.fail("disallowed character."),n}}if(n>56319)return n>=57344&&n<=65533||this.fail("disallowed character."),n;const r=65536+1024*(n-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,r>1114111&&this.fail("disallowed character."),r}getCode11(){const{chunk:e,i:t}=this;if(this.prevI=t,this.i=t+1,t>=e.length)return b;const n=e.charCodeAt(t);if(this.column++,n<55296){if(n>31&&n<127||n>159&&8232!==n||9===n)return n;switch(n){case _:return this.line++,this.column=0,this.positionAtNewLine=this.position,_;case 13:{const n=e.charCodeAt(t+1);(n===_||133===n)&&(this.i=t+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,y;default:return this.fail("disallowed character."),n}}if(n>56319)return n>=57344&&n<=65533||this.fail("disallowed character."),n;const r=65536+1024*(n-55296)+(e.charCodeAt(t+1)-56320);return this.i=t+2,r>1114111&&this.fail("disallowed character."),r}getCodeNorm(){const e=this.getCode();return e===y?_:e}unget(){this.i=this.prevI,this.column--}captureTo(e){let{i:t}=this;const{chunk:n}=this;for(;;){const r=this.getCode(),i=r===y,s=i?_:r;if(s===b||e.includes(s))return this.text+=n.slice(t,this.prevI),s;i&&(this.text+=`${n.slice(t,this.prevI)}\n`,t=this.i)}}captureToChar(e){let{i:t}=this;const{chunk:n}=this;for(;;){let r=this.getCode();switch(r){case y:this.text+=`${n.slice(t,this.prevI)}\n`,t=this.i,r=_;break;case b:return this.text+=n.slice(t),!1}if(r===e)return this.text+=n.slice(t,this.prevI),!0}}captureNameChars(){const{chunk:e,i:t}=this;for(;;){const n=this.getCode();if(n===b)return this.name+=e.slice(t),b;if(!o(n))return this.name+=e.slice(t,this.prevI),n===y?_:n}}skipSpaces(){for(;;){const e=this.getCodeNorm();if(e===b||!r(e))return e}}setXMLVersion(e){this.currentXMLVersion=e,"1.0"===e?(this.isChar=i,this.getCode=this.getCode10):(this.isChar=c,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){const e=this.i,t=this.skipSpaces();switch(this.prevI!==e&&(this.xmlDeclPossible=!1),t){case x:if(this.state=15,0!==this.text.length)throw new Error("no-empty text at start");break;case b:break;default:this.unget(),this.state=v,this.xmlDeclPossible=!1}}sDoctype(){var e;const t=this.captureTo(k);switch(t){case E:null===(e=this.doctypeHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=v,this.doctype=!0;break;case b:break;default:this.text+=String.fromCodePoint(t),91===t?this.state=4:T(t)&&(this.state=3,this.q=t)}}sDoctypeQuote(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.q=null,this.state=2)}sDTD(){const e=this.captureTo(R);e!==b&&(this.text+=String.fromCodePoint(e),e===j?this.state=2:e===x?this.state=6:T(e)&&(this.state=5,this.q=e))}sDTDQuoted(){const e=this.q;this.captureToChar(e)&&(this.text+=String.fromCodePoint(e),this.state=4,this.q=null)}sDTDOpenWaka(){const e=this.getCodeNorm();switch(this.text+=String.fromCodePoint(e),e){case 33:this.state=7,this.openWakaBang="";break;case I:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){const e=String.fromCodePoint(this.getCodeNorm()),t=this.openWakaBang+=e;this.text+=e,"-"!==t&&(this.state="--"===t?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),this.state=45===e?10:8}sDTDCommentEnded(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===E?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(I)&&(this.text+="?",this.state=12)}sDTDPIEnding(){const e=this.getCodeNorm();this.text+=String.fromCodePoint(e),e===E&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:e}=this;const{chunk:t}=this;e:for(;;)switch(this.getCode()){case y:this.entity+=`${t.slice(e,this.prevI)}\n`,e=this.i;break;case 59:{const{entityReturnState:n}=this,r=this.entity+t.slice(e,this.prevI);let i;this.state=n,""===r?(this.fail("empty entity name."),i="&;"):(i=this.parseEntity(r),this.entity=""),(n!==v||void 0!==this.textHandler)&&(this.text+=i);break e}case b:this.entity+=t.slice(e);break e}}sOpenWaka(){const e=this.getCode();if(s(e))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(e){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case I:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=v,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var e;const t=this.getCodeNorm();45===t?(this.state=19,null===(e=this.commentHandler)||void 0===e||e.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(t)}`,this.state=17)}sCommentEnded(){const e=this.getCodeNorm();e!==E?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(e)}`,this.state=17):this.state=v}sCData(){this.captureToChar(j)&&(this.state=21)}sCDataEnding(){const e=this.getCodeNorm();e===j?this.state=22:(this.text+=`]${String.fromCodePoint(e)}`,this.state=20)}sCDataEnding2(){var e;const t=this.getCodeNorm();switch(t){case E:null===(e=this.cdataHandler)||void 0===e||e.call(this,this.text),this.text="",this.state=v;break;case j:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(t)}`,this.state=20}}sPIFirstChar(){const e=this.getCodeNorm();this.nameStartCheck(e)?(this.piTarget+=String.fromCodePoint(e),this.state=24):e===I||r(e)?(this.fail("processing instruction without a target."),this.state=e===I?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(e),this.state=24)}sPIRest(){const{chunk:e,i:t}=this;for(;;){const n=this.getCodeNorm();if(n===b)return void(this.piTarget+=e.slice(t));if(!this.nameCheck(n)){this.piTarget+=e.slice(t,this.prevI);const i=n===I;i||r(n)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=i?w:27):this.state=i?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(n));break}}}sPIBody(){if(0===this.text.length){const e=this.getCodeNorm();e===I?this.state=26:r(e)||(this.text=String.fromCodePoint(e))}else this.captureToChar(I)&&(this.state=26)}sPIEnding(){var e;const t=this.getCodeNorm();if(t===E){const{piTarget:t}=this;"xml"===t.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(e=this.piHandler)||void 0===e||e.call(this,{target:t,body:this.text}),this.piTarget=this.text="",this.state=v}else t===I?this.text+="?":(this.text+=`?${String.fromCodePoint(t)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){const e=this.skipSpaces();e!==I?e!==b&&(this.state=28,this.name=String.fromCodePoint(e)):this.state=w}sXMLDeclName(){const e=this.captureTo(C);if(e===I)return this.state=w,this.name+=this.text,this.text="",void this.fail("XML declaration is incomplete.");if(r(e)||e===S){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=e===S?30:29}}sXMLDeclEq(){const e=this.getCodeNorm();if(e===I)return this.state=w,void this.fail("XML declaration is incomplete.");r(e)||(e!==S&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){const e=this.getCodeNorm();if(e===I)return this.state=w,void this.fail("XML declaration is incomplete.");r(e)||(T(e)?this.q=e:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){const e=this.captureTo([this.q,I]);if(e===I)return this.state=w,this.text="",void this.fail("XML declaration is incomplete.");if(e===b)return;const t=this.text;switch(this.text="",this.name){case"version":{this.xmlDeclExpects=["encoding","standalone"];const e=t;this.xmlDecl.version=e,/^1\.[0-9]+$/.test(e)?this.opt.forceXMLVersion||this.setXMLVersion(e):this.fail("version number must match /^1\\.[0-9]+$/.");break}case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(t)||this.fail("encoding value must match \t/^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=t;break;case"standalone":"yes"!==t&&"no"!==t&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=t}this.name="",this.state=32}sXMLDeclSeparator(){const e=this.getCodeNorm();e!==I?(r(e)||(this.fail("whitespace required."),this.unget()),this.state=27):this.state=w}sXMLDeclEnding(){var e;this.getCodeNorm()===E?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(e=this.xmldeclHandler)||void 0===e||e.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=v):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var e;const t=this.captureNameChars();if(t===b)return;const n=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=n.ns=Object.create(null)),null===(e=this.openTagStartHandler)||void 0===e||e.call(this,n),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),t){case E:this.openTag();break;case 47:this.state=35;break;default:r(t)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){this.getCode()===E?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){const e=this.skipSpaces();e!==b&&(s(e)?(this.unget(),this.state=37):e===E?this.openTag():47===e?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){const e=this.captureNameChars();e===S?this.state=39:r(e)?this.state=38:e===E?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):e!==b&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){const e=this.skipSpaces();switch(e){case b:return;case S:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",e===E?this.openTag():s(e)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){const e=this.getCodeNorm();T(e)?(this.q=e,this.state=40):r(e)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){const{q:e,chunk:t}=this;let{i:n}=this;for(;;)switch(this.getCode()){case e:return this.pushAttrib(this.name,this.text+t.slice(n,this.prevI)),this.name=this.text="",this.q=null,void(this.state=41);case 38:return this.text+=t.slice(n,this.prevI),this.state=14,void(this.entityReturnState=40);case _:case y:case 9:this.text+=`${t.slice(n,this.prevI)} `,n=this.i;break;case x:return this.text+=t.slice(n,this.prevI),void this.fail("disallowed character.");case b:return void(this.text+=t.slice(n))}}sAttribValueClosed(){const e=this.getCodeNorm();r(e)?this.state=36:e===E?this.openTag():47===e?this.state=35:s(e)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){const e=this.captureTo(A);switch(e){case 38:this.state=14,this.entityReturnState=42;break;case x:this.fail("disallowed character.");break;case b:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",e===E?this.openTag():this.state=36}}sCloseTag(){const e=this.captureNameChars();e===E?this.closeTag():r(e)?this.state=44:e!==b&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case E:this.closeTag();break;case b:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:e,forbiddenState:t}=this;const{chunk:n,textHandler:r}=this;e:for(;;)switch(this.getCode()){case x:if(this.state=15,void 0!==r){const{text:t}=this,i=n.slice(e,this.prevI);0!==t.length?(r(t+i),this.text=""):0!==i.length&&r(i)}t=0;break e;case 38:this.state=14,this.entityReturnState=v,void 0!==r&&(this.text+=n.slice(e,this.prevI)),t=0;break e;case j:switch(t){case 0:t=1;break;case 1:t=2;break;case 2:break;default:throw new Error("impossible state")}break;case E:2===t&&this.fail('the string "]]>" is disallowed in char data.'),t=0;break;case y:void 0!==r&&(this.text+=`${n.slice(e,this.prevI)}\n`),e=this.i,t=0;break;case b:void 0!==r&&(this.text+=n.slice(e));break e;default:t=0}this.forbiddenState=t}handleTextOutsideRoot(){let{i:e}=this;const{chunk:t,textHandler:n}=this;let i=!1;e:for(;;){const s=this.getCode();switch(s){case x:if(this.state=15,void 0!==n){const{text:r}=this,i=t.slice(e,this.prevI);0!==r.length?(n(r+i),this.text=""):0!==i.length&&n(i)}break e;case 38:this.state=14,this.entityReturnState=v,void 0!==n&&(this.text+=t.slice(e,this.prevI)),i=!0;break e;case y:void 0!==n&&(this.text+=`${t.slice(e,this.prevI)}\n`),e=this.i;break;case b:void 0!==n&&(this.text+=t.slice(e));break e;default:r(s)||(i=!0)}}i&&(!this.sawRoot&&!this.reportedTextBeforeRoot&&(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(e,t){var n;const{prefix:r,local:i}=this.qname(e),s={name:e,prefix:r,local:i,value:t};if(this.attribList.push(s),null===(n=this.attributeHandler)||void 0===n||n.call(this,s),"xmlns"===r){const e=t.trim();"1.0"===this.currentXMLVersion&&""===e&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[i]=e,O(this,i,e)}else if("xmlns"===e){const e=t.trim();this.topNS[""]=e,O(this,"",e)}}pushAttribPlain(e,t){var n;const r={name:e,value:t};this.attribList.push(r),null===(n=this.attributeHandler)||void 0===n||n.call(this,r)}end(){var e,t;this.sawRoot||this.fail("document must contain a root element.");const{tags:n}=this;for(;n.length>0;){const e=n.pop();this.fail(`unclosed tag: ${e.name}`)}0!==this.state&&this.state!==v&&this.fail("unexpected end.");const{text:r}=this;return 0!==r.length&&(null===(e=this.textHandler)||void 0===e||e.call(this,r),this.text=""),this._closed=!0,null===(t=this.endHandler)||void 0===t||t.call(this),this._init(),this}resolve(e){var t,n;let r=this.topNS[e];if(void 0!==r)return r;const{tags:i}=this;for(let t=i.length-1;t>=0;t--)if(r=i[t].ns[e],void 0!==r)return r;return r=this.ns[e],void 0!==r?r:null===(n=(t=this.opt).resolvePrefix)||void 0===n?void 0:n.call(t,e)}qname(e){const t=e.indexOf(":");if(-1===t)return{prefix:"",local:e};const n=e.slice(t+1),r=e.slice(0,t);return(""===r||""===n||n.includes(":"))&&this.fail(`malformed name: ${e}.`),{prefix:r,local:n}}processAttribsNS(){var e;const{attribList:t}=this,n=this.tag;{const{prefix:t,local:r}=this.qname(n.name);n.prefix=t,n.local=r;const i=n.uri=null!==(e=this.resolve(t))&&void 0!==e?e:"";""!==t&&("xmlns"===t&&this.fail('tags may not have "xmlns" as prefix.'),""===i&&(this.fail(`unbound namespace prefix: ${JSON.stringify(t)}.`),n.uri=t))}if(0===t.length)return;const{attributes:r}=n,i=new Set;for(const e of t){const{name:t,prefix:n,local:s}=e;let o,a;""===n?(o="xmlns"===t?f:"",a=t):(o=this.resolve(n),void 0===o&&(this.fail(`unbound namespace prefix: ${JSON.stringify(n)}.`),o=n),a=`{${o}}${s}`),i.has(a)&&this.fail(`duplicate attribute: ${a}.`),i.add(a),e.uri=o,r[t]=e}this.attribList=[]}processAttribsPlain(){const{attribList:e}=this,t=this.tag.attributes;for(const{name:n,value:r}of e)void 0!==t[n]&&this.fail(`duplicate attribute: ${n}.`),t[n]=r;this.attribList=[]}openTag(){var e;this.processAttribs();const{tags:t}=this,n=this.tag;n.isSelfClosing=!1,null===(e=this.openTagHandler)||void 0===e||e.call(this,n),t.push(n),this.state=v,this.name=""}openSelfClosingTag(){var e,t,n;this.processAttribs();const{tags:r}=this,i=this.tag;i.isSelfClosing=!0,null===(e=this.openTagHandler)||void 0===e||e.call(this,i),null===(t=this.closeTagHandler)||void 0===t||t.call(this,i),null===(this.tag=null!==(n=r[r.length-1])&&void 0!==n?n:null)&&(this.closedRoot=!0),this.state=v,this.name=""}closeTag(){const{tags:e,name:t}=this;if(this.state=v,this.name="",""===t)return this.fail("weird empty close tag."),void(this.text+="</>");const n=this.closeTagHandler;let r=e.length;for(;r-- >0;){const r=this.tag=e.pop();if(this.topNS=r.ns,n?.(r),r.name===t)break;this.fail("unexpected close tag.")}0===r?this.closedRoot=!0:r<0&&(this.fail(`unmatched closing tag: ${t}.`),this.text+=`</${t}>`)}parseEntity(e){if("#"!==e[0]){const t=this.ENTITIES[e];return void 0!==t?t:(this.fail(this.isName(e)?"undefined entity.":"disallowed character in entity name."),`&${e};`)}let t=NaN;return"x"===e[1]&&/^#x[0-9a-f]+$/i.test(e)?t=parseInt(e.slice(2),16):/^#[0-9]+$/.test(e)&&(t=parseInt(e.slice(1),10)),this.isChar(t)?String.fromCodePoint(t):(this.fail("malformed character entity."),`&${e};`)}},tr}var ul,Jr={};function gf(){if(ul)return Jr;ul=1,Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.ParseError=void 0;let e=class extends Error{constructor(e,t){const n=e.saxParser;super(e.trackPosition?`Line ${n.line} column ${n.column+1}: ${t}`:t)}};return Jr.ParseError=e,Jr}var cl,rr={},Kr={};function Lc(){return cl||(cl=1,Object.defineProperty(Kr,"__esModule",{value:!0}),Kr.BlankNode=void 0,Kr.BlankNode=class{constructor(e){this.termType="BlankNode",this.value=e}equals(e){return!!e&&"BlankNode"===e.termType&&e.value===this.value}}),Kr}var dl,Yr={},Zr={};function Oc(){if(dl)return Zr;dl=1,Object.defineProperty(Zr,"__esModule",{value:!0}),Zr.DefaultGraph=void 0;class e{constructor(){this.termType="DefaultGraph",this.value=""}equals(e){return!!e&&"DefaultGraph"===e.termType}}return Zr.DefaultGraph=e,e.INSTANCE=new e,Zr}var hl,fl,en={},tn={};function $a(){return hl||(hl=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.NamedNode=void 0,tn.NamedNode=class{constructor(e){this.termType="NamedNode",this.value=e}equals(e){return!!e&&"NamedNode"===e.termType&&e.value===this.value}}),tn}function Cc(){if(fl)return en;fl=1,Object.defineProperty(en,"__esModule",{value:!0}),en.Literal=void 0;const e=$a();class t{constructor(e,n){this.termType="Literal",this.value=e,"string"==typeof n?(this.language=n,this.datatype=t.RDF_LANGUAGE_STRING,this.direction=""):n?"termType"in n?(this.language="",this.datatype=n,this.direction=""):(this.language=n.language,this.datatype=n.direction?t.RDF_DIRECTIONAL_LANGUAGE_STRING:t.RDF_LANGUAGE_STRING,this.direction=n.direction||""):(this.language="",this.datatype=t.XSD_STRING,this.direction="")}equals(e){return!!e&&"Literal"===e.termType&&e.value===this.value&&e.language===this.language&&(e.direction===this.direction||!e.direction&&""===this.direction)&&this.datatype.equals(e.datatype)}}return en.Literal=t,t.RDF_LANGUAGE_STRING=new e.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),t.RDF_DIRECTIONAL_LANGUAGE_STRING=new e.NamedNode("http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString"),t.XSD_STRING=new e.NamedNode("http://www.w3.org/2001/XMLSchema#string"),en}var pl,rn={};function jc(){return pl||(pl=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.Quad=void 0,rn.Quad=class{constructor(e,t,n,r){this.termType="Quad",this.value="",this.subject=e,this.predicate=t,this.object=n,this.graph=r}equals(e){return!!e&&("Quad"===e.termType||!e.termType)&&this.subject.equals(e.subject)&&this.predicate.equals(e.predicate)&&this.object.equals(e.object)&&this.graph.equals(e.graph)}}),rn}var gl,ml,yl,nn={};function $c(){return gl||(gl=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.Variable=void 0,nn.Variable=class{constructor(e){this.termType="Variable",this.value=e}equals(e){return!!e&&"Variable"===e.termType&&e.value===this.value}}),nn}function mf(){if(ml)return Yr;ml=1,Object.defineProperty(Yr,"__esModule",{value:!0}),Yr.DataFactory=void 0;const e=Lc(),t=Oc(),n=Cc(),r=$a(),i=jc(),s=$c();let o=0;return Yr.DataFactory=class{constructor(e){this.blankNodeCounter=0,e=e||{},this.blankNodePrefix=e.blankNodePrefix||`df_${o++}_`}namedNode(e){return new r.NamedNode(e)}blankNode(t){return new e.BlankNode(t||`${this.blankNodePrefix}${this.blankNodeCounter++}`)}literal(e,t){return new n.Literal(e,t)}variable(e){return new s.Variable(e)}defaultGraph(){return t.DefaultGraph.INSTANCE}quad(e,t,n,r){return new i.Quad(e,t,n,r||this.defaultGraph())}fromTerm(e){switch(e.termType){case"NamedNode":return this.namedNode(e.value);case"BlankNode":return this.blankNode(e.value);case"Literal":return e.language?this.literal(e.value,e.language):e.datatype.equals(n.Literal.XSD_STRING)?this.literal(e.value):this.literal(e.value,this.fromTerm(e.datatype));case"Variable":return this.variable(e.value);case"DefaultGraph":return this.defaultGraph();case"Quad":return this.quad(this.fromTerm(e.subject),this.fromTerm(e.predicate),this.fromTerm(e.object),this.fromTerm(e.graph))}}fromQuad(e){return this.fromTerm(e)}resetBlankNodeCounter(){this.blankNodeCounter=0}},Yr}function Fc(){return yl||(yl=1,e=rr,t=rr&&rr.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=rr&&rr.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(Lc(),e),n(mf(),e),n(Oc(),e),n(Cc(),e),n($a(),e),n(jc(),e),n($c(),e)),rr;var e,t,n}var bl,_l,wl,vl,nr={},Yi={};function yf(){return bl||(bl=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.validateIri=e.IriValidationStrategy=void 0;const t=function(){const e="[!$&'()*+,;=]",t="%[a-fA-F0-9]{2}",n="([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-4][0-9]|25[0-5])",r=`${n}\\.${n}\\.${n}\\.${n}`,i="[a-fA-F0-9]{1,4}",s=`(${i}:${i}|${r})`,o="[a-zA-Z0-9\\-._~ -퟿豈-﷏ﷰ-￯𐀀-🿽𠀀-𯿽𰀀-𿿽񀀀-񏿽񐀀-񟿽񠀀-񯿽񰀀-񿿽򀀀-򏿽򐀀-򟿽򠀀-򯿽򰀀-򿿽󀀀-󏿽󐀀-󟿽󡀀-󯿽]",a=`(${o}|${t}|${e}|[:@])*`,l=`(${a})+`,c=`(${a})*`;return new RegExp(`^[a-zA-Z][a-zA-Z0-9+\\-.]*:(\\/\\/((${o}|${t}|${e}|:)*@)?(\\[(((${i}:){6}${s}|::(${i}:){5}${s}|(${i})?::(${i}:){4}${s}|((${i}:){0,1}${i})?::(${i}:){3}${s}|((${i}:){0,2}${i})?::(${i}:){2}${s}|((${i}:){0,3}${i})?::${i}:${s}|((${i}:){0,4}${i})?::${s}|((${i}:){0,5}${i})?::${i}|((${i}:){0,6}${i})?::)|v[a-fA-F0-9]+\\.(${e}|${e}|":)+)\\]|${r}|(${o}|${t}|${e})*)(:[0-9]*)?(\\/${c})*|\\/(${l}(\\/${c})*)?|${l}(\\/${c})*|)(\\?(${a}|[-󰀀-󿿽􀀀-􏿽]|[\\/?])*)?(#(${a}|[\\/?])*)?$`,"u")}(),n=/^[A-Za-z][\d+-.A-Za-z]*:[^\u0000-\u0020"<>\\^`{|}]*$/u;var r,i;(i=r=e.IriValidationStrategy||(e.IriValidationStrategy={})).Strict="strict",i.Pragmatic="pragmatic",i.None="none",e.validateIri=function(e,i=r.Strict){switch(i){case r.Strict:return t.test(e)?void 0:new Error(`Invalid IRI according to RFC 3987: '${e}'`);case r.Pragmatic:return n.test(e)?void 0:new Error(`Invalid IRI according to RDF Turtle: '${e}'`);case r.None:return;default:return new Error(`Not supported validation strategy "${i}"`)}}}(Yi)),Yi}function bf(){return _l||(_l=1,e=nr,t=nr&&nr.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=nr&&nr.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(yf(),e)),nr;var e,t,n}function _f(){if(wl)return Zt;wl=1,Object.defineProperty(Zt,"__esModule",{value:!0}),Zt.ParseType=Zt.RdfXmlParser=void 0;const e=cf(),t=pf(),n=ac(),r=gf(),i=Fc(),s=bf();let o=class o extends n.Transform{constructor(e){super({readableObjectMode:!0}),this.activeTagStack=[],this.nodeIds={},e&&(Object.assign(this,e),this.options=e),this.dataFactory||(this.dataFactory=new i.DataFactory),this.baseIRI||(this.baseIRI=""),this.defaultGraph||(this.defaultGraph=this.dataFactory.defaultGraph()),!1!==this.validateUri&&(this.validateUri=!0),this.iriValidationStrategy||(this.iriValidationStrategy=this.validateUri?s.IriValidationStrategy.Pragmatic:s.IriValidationStrategy.None),this.saxParser=new t.SaxesParser({xmlns:!0,position:this.trackPosition}),this.attachSaxListeners()}import(e){const t=new n.PassThrough({readableObjectMode:!0});e.on("error",e=>r.emit("error",e)),e.on("data",e=>t.push(e)),e.on("end",()=>t.push(null));const r=t.pipe(new o(this.options));return r}_transform(e,t,n){try{this.saxParser.write(e)}catch(e){return n(e)}n()}newParseError(e){return new r.ParseError(this,e)}valueToUri(t,n){return this.uriToNamedNode((0,e.resolve)(t,n.baseIRI))}uriToNamedNode(e){const t=(0,s.validateIri)(e,this.iriValidationStrategy);if(t instanceof Error)throw this.newParseError(t.message);return this.dataFactory.namedNode(e)}validateNcname(e){if(!o.NCNAME_MATCHER.test(e))throw this.newParseError(`Not a valid NCName: ${e}`)}createLiteral(e,t){return this.dataFactory.literal(e,t.datatype?t.datatype:t.language?{language:t.language,direction:t.rdfVersion?t.direction:void 0}:void 0)}attachSaxListeners(){this.saxParser.on("error",e=>this.emit("error",e)),this.saxParser.on("opentag",this.onTag.bind(this)),this.saxParser.on("text",this.onText.bind(this)),this.saxParser.on("cdata",this.onText.bind(this)),this.saxParser.on("closetag",this.onCloseTag.bind(this)),this.saxParser.on("doctype",this.onDoctype.bind(this))}onTag(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;let n=a.RESOURCE;if(t&&(t.hadChildren=!0,n=t.childrenParseType),t&&t.childrenStringTags){const n=e.name;let r="";for(const{key:e,value:n}of t.namespaces||[])r+=` ${e}="${n}"`;for(const t in e.attributes)r+=` ${t}="${e.attributes[t].value}"`;const i=`<${n}${r}>`;t.childrenStringTags.push(i);const s={childrenStringTags:t.childrenStringTags};return s.childrenStringEmitClosingTag=`</${n}>`,void this.activeTagStack.push(s)}const r={};t?(r.language=t.language,r.direction=t.direction,r.baseIRI=t.baseIRI,r.childrenTripleTerms=t.childrenTripleTerms,r.rdfVersion=t.rdfVersion):r.baseIRI=this.baseIRI,this.activeTagStack.push(r),n===a.RESOURCE?this.onTagResource(e,r,t,!t):this.onTagProperty(e,r,t);for(const t in e.attributes){const n=e.attributes[t];"xmlns"===n.prefix&&(r.namespaces||(r.namespaces=[]),r.namespaces.push({key:`${n.prefix}:${n.local}`,value:n.value}))}t&&t.namespaces&&(r.namespaces=[...r.namespaces||[],...t.namespaces])}onTagResource(t,n,r,i){n.childrenParseType=a.PROPERTY;let s=!0;if(t.uri===o.RDF){if(!i&&o.FORBIDDEN_NODE_ELEMENTS.indexOf(t.local)>=0)throw this.newParseError(`Illegal node element name: ${t.local}`);switch(t.local){case"RDF":n.childrenParseType=a.RESOURCE;case"Description":s=!1}}const l=[],c=[];let u=null,d=!1,h=!1,p=null;for(const i in t.attributes){const s=t.attributes[i];if(s.uri!==o.RDF||"version"!==s.local){if(r&&s.uri===o.RDF)switch(s.local){case"about":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${s.value} and ${u} where found.`);u=s.value;continue;case"ID":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${s.value} and ${u} where found.`);this.validateNcname(s.value),u="#"+s.value,d=!0;continue;case"nodeID":if(u)throw this.newParseError(`Only one of rdf:about, rdf:nodeID and rdf:ID can be present, while ${s.value} and ${u} where found.`);this.validateNcname(s.value),u=s.value,h=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"type":p=s.value;continue;case"aboutEach":throw this.newParseError("rdf:aboutEach is not supported.");case"aboutEachPrefix":throw this.newParseError("rdf:aboutEachPrefix is not supported.");case"li":throw this.newParseError("rdf:li on node elements are not supported.")}else if(s.uri===o.XML){if("lang"===s.local){n.language=""===s.value?null:s.value.toLowerCase();continue}if("base"===s.local){n.baseIRI=(0,e.resolve)(s.value,n.baseIRI);continue}}else if(s.uri===o.ITS&&"dir"===s.local){this.setDirection(n,s.value);continue}"xml"!==s.prefix&&"xmlns"!==s.prefix&&(""!==s.prefix||"xmlns"!==s.local)&&s.uri&&(l.push(this.uriToNamedNode(s.uri+s.local)),c.push(s.value))}else this.setVersion(n,s.value)}if(null!==u&&(n.subject=h?this.dataFactory.blankNode(u):this.valueToUri(u,n),d&&this.claimNodeId(n.subject)),n.subject||(n.subject=this.dataFactory.blankNode()),s){const e=this.uriToNamedNode(t.uri+t.local);this.emitTriple(n.subject,this.dataFactory.namedNode(o.RDF+"type"),e,r?r.reifiedStatementId:null,n.childrenTripleTerms,n.reifier)}if(r){if(r.predicate)if(r.childrenCollectionSubject){const e=this.dataFactory.blankNode(),t=this.dataFactory.namedNode(o.RDF+"rest"),i=r.childrenCollectionPredicate.equals(t);this.emitTriple(r.childrenCollectionSubject,r.childrenCollectionPredicate,e,i?null:r.reifiedStatementId,r.childrenTripleTerms,i?null:r.reifier),this.emitTriple(e,this.dataFactory.namedNode(o.RDF+"first"),n.subject,null,n.childrenTripleTerms),r.childrenCollectionSubject=e,r.childrenCollectionPredicate=t}else{r.childrenTagsToTripleTerms||(this.emitTriple(r.subject,r.predicate,n.subject,r.reifiedStatementId,r.childrenTripleTerms,r.reifier),r.predicateEmitted=!0);for(let e=0;e<r.predicateSubPredicates.length;e++)this.emitTriple(n.subject,r.predicateSubPredicates[e],r.predicateSubObjects[e],null,r.childrenTripleTerms,r.reifier);r.predicateSubPredicates=[],r.predicateSubObjects=[]}for(let e=0;e<l.length;e++){const t=this.createLiteral(c[e],n);this.emitTriple(n.subject,l[e],t,r.reifiedStatementId,r.childrenTripleTerms,r.reifier)}p&&this.emitTriple(n.subject,this.dataFactory.namedNode(o.RDF+"type"),this.uriToNamedNode(p),null,n.childrenTripleTerms,n.reifier)}}onTagProperty(e,t,n){if(t.childrenParseType=a.RESOURCE,t.subject=n.subject,e.uri===o.RDF&&"li"===e.local?(n.listItemCounter||(n.listItemCounter=1),t.predicate=this.uriToNamedNode(e.uri+"_"+n.listItemCounter++)):t.predicate=this.uriToNamedNode(e.uri+e.local),e.uri===o.RDF&&o.FORBIDDEN_PROPERTY_ELEMENTS.indexOf(e.local)>=0)throw this.newParseError(`Illegal property element name: ${e.local}`);t.predicateSubPredicates=[],t.predicateSubObjects=[];let r=!1,i=!1,s=null,l=!0;const c=[],u=[];for(const n in e.attributes){const d=e.attributes[n];if(d.uri!==o.RDF||"version"!==d.local){if(d.uri===o.RDF)switch(d.local){case"resource":if(s)throw this.newParseError(`Found both rdf:resource (${d.value}) and rdf:nodeID (${s}).`);if(r)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:resource (${d.value})`);t.hadChildren=!0,s=d.value,l=!1;continue;case"datatype":if(i)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:datatype (${d.value}).`);if(r)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${d.value})`);t.datatype=this.valueToUri(d.value,t);continue;case"nodeID":if(i)throw this.newParseError(`Found both non-rdf:* property attributes and rdf:nodeID (${d.value}).`);if(t.hadChildren)throw this.newParseError(`Found both rdf:resource and rdf:nodeID (${d.value}).`);if(r)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID (${d.value})`);this.validateNcname(d.value),t.hadChildren=!0,s=d.value,l=!0;continue;case"bagID":throw this.newParseError("rdf:bagID is not supported.");case"parseType":if(i)throw this.newParseError("rdf:parseType is not allowed when non-rdf:* property attributes are present");if(t.datatype)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:datatype (${t.datatype.value})`);if(s)throw this.newParseError(`rdf:parseType is not allowed on property elements with rdf:nodeID or rdf:resource (${s})`);if("Resource"===d.value){r=!0,t.childrenParseType=a.PROPERTY;const e=this.dataFactory.blankNode();this.emitTriple(t.subject,t.predicate,e,t.reifiedStatementId,t.childrenTripleTerms,t.reifier),t.subject=e,t.predicate=null}else"Collection"===d.value?(r=!0,t.hadChildren=!0,t.childrenCollectionSubject=t.subject,t.childrenCollectionPredicate=t.predicate,l=!1):"Literal"===d.value?(r=!0,t.childrenTagsToString=!0,t.childrenStringTags=[]):"Triple"===d.value&&(r=!0,t.childrenTagsToTripleTerms=!0,t.childrenTripleTerms=[]);continue;case"ID":this.validateNcname(d.value),t.reifiedStatementId=this.valueToUri("#"+d.value,t),this.claimNodeId(t.reifiedStatementId);continue;case"annotation":t.reifier=this.dataFactory.namedNode(d.value);continue;case"annotationNodeID":t.reifier=this.dataFactory.blankNode(d.value);continue}else{if(d.uri===o.XML&&"lang"===d.local){t.language=""===d.value?null:d.value.toLowerCase();continue}if(d.uri===o.ITS&&"dir"===d.local){this.setDirection(t,d.value);continue}if(d.uri===o.ITS&&"version"===d.local)continue}if("xml"!==d.prefix&&"xmlns"!==d.prefix&&(""!==d.prefix||"xmlns"!==d.local)&&d.uri){if(r||t.datatype)throw this.newParseError(`Found illegal rdf:* properties on property element with attribute: ${d.value}`);t.hadChildren=!0,i=!0,c.push(this.uriToNamedNode(d.uri+d.local)),u.push(this.createLiteral(d.value,t))}}else this.setVersion(t,d.value)}if(null!==s){const e=t.subject;t.subject=l?this.dataFactory.blankNode(s):this.valueToUri(s,t),this.emitTriple(e,t.predicate,t.subject,t.reifiedStatementId,t.childrenTripleTerms,t.reifier);for(let e=0;e<c.length;e++)this.emitTriple(t.subject,c[e],u[e],null,t.childrenTripleTerms,t.reifier);t.predicateEmitted=!0}else l&&(t.predicateSubPredicates=c,t.predicateSubObjects=u,t.predicateEmitted=!1)}emitTriple(e,t,n,r,i,s){const a=this.dataFactory.quad(e,t,n,this.defaultGraph);i?i.push(a):this.push(a),s&&this.push(this.dataFactory.quad(s,this.dataFactory.namedNode(o.RDF+"reifies"),a)),r&&(this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"type"),this.dataFactory.namedNode(o.RDF+"Statement"),this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"subject"),e,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"predicate"),t,this.defaultGraph)),this.push(this.dataFactory.quad(r,this.dataFactory.namedNode(o.RDF+"object"),n,this.defaultGraph)))}claimNodeId(e){if(!this.allowDuplicateRdfIds){if(this.nodeIds[e.value])throw this.newParseError(`Found multiple occurrences of rdf:ID='${e.value}'.`);this.nodeIds[e.value]=!0}}onText(e){const t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;t&&(t.childrenStringTags?t.childrenStringTags.push(e):t.predicate&&(t.text=e))}onCloseTag(){const e=this.activeTagStack.pop(),t=this.activeTagStack.length?this.activeTagStack[this.activeTagStack.length-1]:null;if(e.childrenStringEmitClosingTag&&e.childrenStringTags.push(e.childrenStringEmitClosingTag),e.childrenTagsToString&&(e.datatype=this.dataFactory.namedNode(o.RDF+"XMLLiteral"),e.text=e.childrenStringTags.join(""),e.hadChildren=!1),e.childrenTagsToTripleTerms&&e.predicate&&e.rdfVersion){if(1!==e.childrenTripleTerms.length)throw this.newParseError(`Expected exactly one triple term in rdf:parseType="Triple" but got ${e.childrenTripleTerms.length}`);for(const n of e.childrenTripleTerms)this.emitTriple(e.subject,e.predicate,n,null,t.childrenTripleTerms,t.reifier);e.predicateEmitted=!0}if(e.childrenCollectionSubject)this.emitTriple(e.childrenCollectionSubject,e.childrenCollectionPredicate,this.dataFactory.namedNode(o.RDF+"nil"),null,e.childrenTripleTerms);else if(e.predicate)if(e.hadChildren||e.childrenParseType===a.PROPERTY){if(!e.predicateEmitted){const t=this.dataFactory.blankNode();this.emitTriple(e.subject,e.predicate,t,e.reifiedStatementId,e.childrenTripleTerms,e.reifier);for(let n=0;n<e.predicateSubPredicates.length;n++)this.emitTriple(t,e.predicateSubPredicates[n],e.predicateSubObjects[n],null,e.childrenTripleTerms)}}else this.emitTriple(e.subject,e.predicate,this.createLiteral(e.text||"",e),e.reifiedStatementId,e.childrenTripleTerms,e.reifier)}onDoctype(e){e.replace(/<!ENTITY\s+([^\s]+)\s+["']([^"']+)["']\s*>/g,(e,t,n)=>(this.saxParser.ENTITIES[t]=n,""))}setDirection(e,t){if(t){if("ltr"!==t&&"rtl"!==t)throw this.newParseError(`Base directions must either be 'ltr' or 'rtl', while '${t}' was found.`);e.direction=t}else delete e.direction}setVersion(e,t){e.rdfVersion=t,this.emit("version",t)}};var a,l;return Zt.RdfXmlParser=o,o.MIME_TYPE="application/rdf+xml",o.RDF="http://www.w3.org/1999/02/22-rdf-syntax-ns#",o.XML="http://www.w3.org/XML/1998/namespace",o.ITS="http://www.w3.org/2005/11/its",o.FORBIDDEN_NODE_ELEMENTS=["RDF","ID","about","bagID","parseType","resource","nodeID","li","aboutEach","aboutEachPrefix"],o.FORBIDDEN_PROPERTY_ELEMENTS=["Description","RDF","ID","about","bagID","parseType","resource","nodeID","aboutEach","aboutEachPrefix"],o.NCNAME_MATCHER=/^([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_])([A-Za-z\xC0-\xD6\xD8-\xF6\u{F8}-\u{2FF}\u{370}-\u{37D}\u{37F}-\u{1FFF}\u{200C}-\u{200D}\u{2070}-\u{218F}\u{2C00}-\u{2FEF}\u{3001}-\u{D7FF}\u{F900}-\u{FDCF}\u{FDF0}-\u{FFFD}\u{10000}-\u{EFFFF}_\-.0-9#xB7\u{0300}-\u{036F}\u{203F}-\u{2040}])*$/u,(l=a||(Zt.ParseType=a={}))[l.RESOURCE=0]="RESOURCE",l[l.PROPERTY=1]="PROPERTY",Zt}function wf(){return vl||(vl=1,e=Yt,t=Yt&&Yt.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=Yt&&Yt.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(_f(),e)),Yt;var e,t,n}var es,xl,vf=wf(),Zi={};function Fa(){return xl||(xl=1,es=class e{constructor(e,t=new Map,n=0){this.prefix=e,this._existing=t,this.counter=n}clone(){const{prefix:t,_existing:n,counter:r}=this;return new e(t,new Map(n),r)}getId(e){const t=e&&this._existing.get(e);if(t)return t;const n=this.prefix+this.counter;return this.counter++,e&&this._existing.set(e,n),n}hasId(e){return this._existing.has(e)}getOldIds(){return[...this._existing.keys()]}}),es}var El,rs,Sl,ns,Il,is,Nl,ss,Rl,as,Tl,os,Al,ls,Dl,ts={};function xf(){return El||(El=1,function(e){if(!e.setImmediate){var t,n,r,i=1,s={},o=!1,a=e.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(e);l=l&&l.setTimeout?l:e,"[object process]"==={}.toString.call(e.process)?t=function(e){process.nextTick(function(){u(e)})}:function(){if(e.postMessage&&!e.importScripts){var t=!0,n=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=n,t}}()?(n="setImmediate$"+Math.random()+"$",r=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(n)&&u(+t.data.slice(n.length))},e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),t=function(t){e.postMessage(n+t,"*")}):e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){u(e.data)},t=function(t){e.port2.postMessage(t)}}():a&&"onreadystatechange"in a.createElement("script")?function(){var e=a.documentElement;t=function(t){var n=a.createElement("script");n.onreadystatechange=function(){u(t),n.onreadystatechange=null,e.removeChild(n),n=null},e.appendChild(n)}}():t=function(e){setTimeout(u,0,e)},l.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var n=new Array(arguments.length-1),r=0;r<n.length;r++)n[r]=arguments[r+1];var o={callback:e,args:n};return s[i]=o,t(i),i++},l.clearImmediate=c}function c(e){delete s[e]}function u(e){if(o)setTimeout(u,0,e);else{var t=s[e];if(t){o=!0;try{!function(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(void 0,n)}}(t)}finally{c(e),o=!1}}}}}(typeof self>"u"?typeof Sr>"u"?ts:Sr:self)),ts}function pi(){if(Sl)return rs;Sl=1,xf();const e=self.crypto||self.msCrypto;return rs=class{constructor(t){if(!e||!e.subtle)throw new Error("crypto.subtle not found.");if("sha256"===t)this.algorithm={name:"SHA-256"};else{if("sha1"!==t)throw new Error(`Unsupported algorithm "${t}".`);this.algorithm={name:"SHA-1"}}this._content=""}update(e){this._content+=e}async digest(){const t=(new TextEncoder).encode(this._content),n=new Uint8Array(await e.subtle.digest(this.algorithm,t));let r="";for(let e=0;e<n.length;++e)r+=n[e].toString(16).padStart(2,"0");return r}}}function Pc(){return Il||(Il=1,ns=class{constructor(e){this.current=e.sort(),this.done=!1,this.dir=new Map;for(let t=0;t<e.length;++t)this.dir.set(e[t],!0)}hasNext(){return!this.done}next(){const{current:e,dir:t}=this,n=e.slice();let r=null,i=0;const s=e.length;for(let n=0;n<s;++n){const o=e[n],a=t.get(o);(null===r||o>r)&&(a&&n>0&&o>e[n-1]||!a&&n<s-1&&o>e[n+1])&&(r=o,i=n)}if(null===r)this.done=!0;else{const n=t.get(r)?i-1:i+1;e[i]=e[n],e[n]=r;for(const n of e)n>r&&t.set(n,!t.get(n))}return n}}),ns}function ka(){if(Nl)return is;Nl=1;const e="http://www.w3.org/1999/02/22-rdf-syntax-ns#langString",t="http://www.w3.org/2001/XMLSchema#string",n="NamedNode",r="BlankNode",i="Literal",s="DefaultGraph",o={};function a(e,t){return e.subject.termType===t.subject.termType&&e.object.termType===t.object.termType&&e.subject.value===t.subject.value&&e.predicate.value===t.predicate.value&&e.object.value===t.object.value&&(e.object.termType!==i||e.object.datatype.termType===t.object.datatype.termType&&e.object.language===t.object.language&&e.object.datatype.value===t.object.datatype.value)}(()=>{const e="(?:<([^:]+:[^>]*)>)",t="A-Za-zÀ-ÖØ-öø-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�_",n=t+"0-9-·̀-ͯ‿-⁀",r="(_:(?:["+t+"0-9])(?:(?:["+n+".])*(?:["+n+"]))?)",i="[ \\t]+",s="[ \\t]*",a="(?:"+e+"|"+r+")"+i,l=e+i,c="(?:"+e+"|"+r+'|(?:"([^"\\\\]*(?:\\\\.[^"\\\\]*)*)"(?:(?:\\^\\^'+e+")|(?:@([a-zA-Z]+(?:-[a-zA-Z0-9]+)*)))?))"+s,u="(?:\\.|(?:(?:"+e+"|"+r+")"+s+"\\.))";o.eoln=/(?:\r\n)|(?:\n)|(?:\r)/g,o.empty=new RegExp("^"+s+"$"),o.quad=new RegExp("^"+s+a+l+c+u+s+"$")})(),is=class c{static parse(l){const c=[],d={},h=l.split(o.eoln);let p=0;for(const l of h){if(p++,o.empty.test(l))continue;const h=l.match(o.quad);if(null===h)throw new Error("N-Quads parse error on line "+p+".");const f={subject:null,predicate:null,object:null,graph:null};if(void 0!==h[1]?f.subject={termType:n,value:h[1]}:f.subject={termType:r,value:h[2]},f.predicate={termType:n,value:h[3]},void 0!==h[4]?f.object={termType:n,value:h[4]}:void 0!==h[5]?f.object={termType:r,value:h[5]}:(f.object={termType:i,value:void 0,datatype:{termType:n}},void 0!==h[7]?f.object.datatype.value=h[7]:void 0!==h[8]?(f.object.datatype.value=e,f.object.language=h[8]):f.object.datatype.value=t,f.object.value=u(h[6])),void 0!==h[9]?f.graph={termType:n,value:h[9]}:void 0!==h[10]?f.graph={termType:r,value:h[10]}:f.graph={termType:s,value:""},f.graph.value in d){let e=!0;const t=d[f.graph.value];for(const n of t)if(a(n,f)){e=!1;break}e&&(t.push(f),c.push(f))}else d[f.graph.value]=[f],c.push(f)}return c}static serialize(e){Array.isArray(e)||(e=c.legacyDatasetToQuads(e));const t=[];for(const n of e)t.push(c.serializeQuad(n));return t.sort().join("")}static serializeQuadComponents(i,s,o,a){let c="";return i.termType===n?c+=`<${i.value}>`:c+=`${i.value}`,c+=` <${s.value}> `,o.termType===n?c+=`<${o.value}>`:o.termType===r?c+=o.value:(c+=`"${u=o.value,u.replace(l,function(e){switch(e){case'"':return'\\"';case"\\":return"\\\\";case"\n":return"\\n";case"\r":return"\\r"}})}"`,o.datatype.value===e?o.language&&(c+=`@${o.language}`):o.datatype.value!==t&&(c+=`^^<${o.datatype.value}>`)),a.termType===n?c+=` <${a.value}>`:a.termType===r&&(c+=` ${a.value}`),c+=" .\n",c;var u}static serializeQuad(e){return c.serializeQuadComponents(e.subject,e.predicate,e.object,e.graph)}static legacyDatasetToQuads(o){const a=[],l={"blank node":r,IRI:n,literal:i};for(const c in o)o[c].forEach(o=>{const u={};for(const r in o){const s=o[r],a={termType:l[s.type],value:s.value};a.termType===i&&(a.datatype={termType:n},"datatype"in s&&(a.datatype.value=s.datatype),"language"in s?("datatype"in s||(a.datatype.value=e),a.language=s.language):"datatype"in s||(a.datatype.value=t)),u[r]=a}u.graph="@default"===c?{termType:s,value:""}:{termType:c.startsWith("_:")?r:n,value:c},a.push(u)});return a}};const l=/["\\\n\r]/g,c=/(?:\\([tbnrf"'\\]))|(?:\\u([0-9A-Fa-f]{4}))|(?:\\U([0-9A-Fa-f]{8}))/g;function u(e){return e.replace(c,function(e,t,n,r){if(t)switch(t){case"t":return"\t";case"b":return"\b";case"n":return"\n";case"r":return"\r";case"f":return"\f";case'"':return'"';case"'":return"'";case"\\":return"\\"}if(n)return String.fromCharCode(parseInt(n,16));if(r)throw new Error("Unsupported U escape")})}return is}function Mc(){if(Rl)return ss;Rl=1;const e=Fa(),t=pi(),n=Pc(),r=ka();function i(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}return ss=class{constructor({createMessageDigest:n=()=>new t("sha256"),canonicalIdMap:r=new Map,maxDeepIterations:i=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new e("_:c14n",r),this.createMessageDigest=n,this.maxDeepIterations=i,this.quads=null,this.deepIterations=null}async main(t){this.deepIterations=new Map,this.quads=t;for(const e of t)this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});const n=new Map,s=[...this.blankNodeInfo.keys()];let o=0;for(const e of s)++o%100==0&&await this._yield(),await this._hashAndTrackBlankNode({id:e,hashToBlankNodes:n});const a=[...n.keys()].sort(),l=[];for(const e of a){const t=n.get(e);if(t.length>1){l.push(t);continue}const r=t[0];this.canonicalIssuer.getId(r)}for(const t of l){const n=[];for(const r of t){if(this.canonicalIssuer.hasId(r))continue;const t=new e("_:b");t.getId(r);const i=await this.hashNDegreeQuads(r,t);n.push(i)}n.sort(i);for(const e of n){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const c=[];for(const e of this.quads){const t=r.serializeQuadComponents(this._componentWithCanonicalId(e.subject),e.predicate,this._componentWithCanonicalId(e.object),this._componentWithCanonicalId(e.graph));c.push(t)}return c.sort(),c.join("")}async hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),i=n.quads;for(const n of i){const i={subject:null,predicate:n.predicate,object:null,graph:null};i.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),i.object=this.modifyFirstDegreeComponent(e,n.object,"object"),i.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(r.serializeQuad(i))}t.sort();const s=this.createMessageDigest();for(const e of t)s.update(e);return n.hash=await s.digest(),n.hash}async hashRelatedBlankNode(e,t,n,r){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const s=this.createMessageDigest();return s.update(r),"g"!==r&&s.update(this.getRelatedPredicate(t)),s.update(i),s.digest()}async hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const i=this.createMessageDigest(),s=await this.createHashToRelated(e,t),o=[...s.keys()].sort();for(const e of o){i.update(e);let r,o="";const a=new n(s.get(e));let l=0;for(;a.hasNext();){const e=a.next();++l%3==0&&await this._yield();let n=t.clone(),i="";const s=[];let c=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),i+=n.getId(t)),0!==o.length&&i>o){c=!0;break}if(!c){for(const e of s){const t=await this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==o.length&&i>o){c=!0;break}}c||(0===o.length||i<o)&&(o=i,r=n)}}i.update(o),t=r}return{hash:await i.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let i=0;for(const s of r)++i%100==0&&await this._yield(),await Promise.all([this._addRelatedBlankNodeHash({quad:s,component:s.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:s,component:s.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:s,component:s.graph,position:"g",id:e,issuer:t,hashToRelated:n})]);return n}async _hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=await this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}async _addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:i,hashToRelated:s}){if("BlankNode"!==t.termType||t.value===r)return;const o=t.value,a=await this.hashRelatedBlankNode(o,e,i,n),l=s.get(a);l?l.push(o):s.set(a,[o])}_componentWithCanonicalId(e){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}async _yield(){return new Promise(e=>setImmediate(e))}}}function Ef(){if(Tl)return as;Tl=1;const e=pi(),t=Mc();return as=class extends t{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new e("sha1")}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}async createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;let i=0;for(const s of r){let r,o;if("BlankNode"===s.subject.termType&&s.subject.value!==e)o=s.subject.value,r="p";else{if("BlankNode"!==s.object.termType||s.object.value===e)continue;o=s.object.value,r="r"}++i%100==0&&await this._yield();const a=await this.hashRelatedBlankNode(o,s,t,r),l=n.get(a);l?l.push(o):n.set(a,[o])}return n}}}function Bc(){if(Al)return os;Al=1;const e=Fa(),t=pi(),n=Pc(),r=ka();function i(e,t){return e.hash<t.hash?-1:e.hash>t.hash?1:0}return os=class{constructor({createMessageDigest:n=()=>new t("sha256"),canonicalIdMap:r=new Map,maxDeepIterations:i=1/0}={}){this.name="URDNA2015",this.blankNodeInfo=new Map,this.canonicalIssuer=new e("_:c14n",r),this.createMessageDigest=n,this.maxDeepIterations=i,this.quads=null,this.deepIterations=null}main(t){this.deepIterations=new Map,this.quads=t;for(const e of t)this._addBlankNodeQuadInfo({quad:e,component:e.subject}),this._addBlankNodeQuadInfo({quad:e,component:e.object}),this._addBlankNodeQuadInfo({quad:e,component:e.graph});const n=new Map,s=[...this.blankNodeInfo.keys()];for(const e of s)this._hashAndTrackBlankNode({id:e,hashToBlankNodes:n});const o=[...n.keys()].sort(),a=[];for(const e of o){const t=n.get(e);if(t.length>1){a.push(t);continue}const r=t[0];this.canonicalIssuer.getId(r)}for(const t of a){const n=[];for(const r of t){if(this.canonicalIssuer.hasId(r))continue;const t=new e("_:b");t.getId(r);const i=this.hashNDegreeQuads(r,t);n.push(i)}n.sort(i);for(const e of n){const t=e.issuer.getOldIds();for(const e of t)this.canonicalIssuer.getId(e)}}const l=[];for(const e of this.quads){const t=r.serializeQuadComponents(this._componentWithCanonicalId({component:e.subject}),e.predicate,this._componentWithCanonicalId({component:e.object}),this._componentWithCanonicalId({component:e.graph}));l.push(t)}return l.sort(),l.join("")}hashFirstDegreeQuads(e){const t=[],n=this.blankNodeInfo.get(e),i=n.quads;for(const n of i){const i={subject:null,predicate:n.predicate,object:null,graph:null};i.subject=this.modifyFirstDegreeComponent(e,n.subject,"subject"),i.object=this.modifyFirstDegreeComponent(e,n.object,"object"),i.graph=this.modifyFirstDegreeComponent(e,n.graph,"graph"),t.push(r.serializeQuad(i))}t.sort();const s=this.createMessageDigest();for(const e of t)s.update(e);return n.hash=s.digest(),n.hash}hashRelatedBlankNode(e,t,n,r){let i;i=this.canonicalIssuer.hasId(e)?this.canonicalIssuer.getId(e):n.hasId(e)?n.getId(e):this.blankNodeInfo.get(e).hash;const s=this.createMessageDigest();return s.update(r),"g"!==r&&s.update(this.getRelatedPredicate(t)),s.update(i),s.digest()}hashNDegreeQuads(e,t){const r=this.deepIterations.get(e)||0;if(r>this.maxDeepIterations)throw new Error(`Maximum deep iterations (${this.maxDeepIterations}) exceeded.`);this.deepIterations.set(e,r+1);const i=this.createMessageDigest(),s=this.createHashToRelated(e,t),o=[...s.keys()].sort();for(const e of o){i.update(e);let r,o="";const a=new n(s.get(e));for(;a.hasNext();){const e=a.next();let n=t.clone(),i="";const s=[];let l=!1;for(const t of e)if(this.canonicalIssuer.hasId(t)?i+=this.canonicalIssuer.getId(t):(n.hasId(t)||s.push(t),i+=n.getId(t)),0!==o.length&&i>o){l=!0;break}if(!l){for(const e of s){const t=this.hashNDegreeQuads(e,n);if(i+=n.getId(e),i+=`<${t.hash}>`,n=t.issuer,0!==o.length&&i>o){l=!0;break}}l||(0===o.length||i<o)&&(o=i,r=n)}}i.update(o),t=r}return{hash:i.digest(),issuer:t}}modifyFirstDegreeComponent(e,t){return"BlankNode"!==t.termType?t:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return`<${e.predicate.value}>`}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const i of r)this._addRelatedBlankNodeHash({quad:i,component:i.subject,position:"s",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.object,position:"o",id:e,issuer:t,hashToRelated:n}),this._addRelatedBlankNodeHash({quad:i,component:i.graph,position:"g",id:e,issuer:t,hashToRelated:n});return n}_hashAndTrackBlankNode({id:e,hashToBlankNodes:t}){const n=this.hashFirstDegreeQuads(e),r=t.get(n);r?r.push(e):t.set(n,[e])}_addBlankNodeQuadInfo({quad:e,component:t}){if("BlankNode"!==t.termType)return;const n=t.value,r=this.blankNodeInfo.get(n);r?r.quads.add(e):this.blankNodeInfo.set(n,{quads:new Set([e]),hash:null})}_addRelatedBlankNodeHash({quad:e,component:t,position:n,id:r,issuer:i,hashToRelated:s}){if("BlankNode"!==t.termType||t.value===r)return;const o=t.value,a=this.hashRelatedBlankNode(o,e,i,n),l=s.get(a);l?l.push(o):s.set(a,[o])}_componentWithCanonicalId({component:e}){return"BlankNode"!==e.termType||e.value.startsWith(this.canonicalIssuer.prefix)?e:{termType:"BlankNode",value:this.canonicalIssuer.getId(e.value)}}}}function Sf(){if(Dl)return ls;Dl=1;const e=pi(),t=Bc();return ls=class extends t{constructor(){super(),this.name="URGNA2012",this.createMessageDigest=()=>new e("sha1")}modifyFirstDegreeComponent(e,t,n){return"BlankNode"!==t.termType?t:"graph"===n?{termType:"BlankNode",value:"_:g"}:{termType:"BlankNode",value:t.value===e?"_:a":"_:z"}}getRelatedPredicate(e){return e.predicate.value}createHashToRelated(e,t){const n=new Map,r=this.blankNodeInfo.get(e).quads;for(const i of r){let r,s;if("BlankNode"===i.subject.termType&&i.subject.value!==e)s=i.subject.value,r="p";else{if("BlankNode"!==i.object.termType||i.object.value===e)continue;s=i.object.value,r="r"}const o=this.hashRelatedBlankNode(s,i,t,r),a=n.get(o);a?a.push(s):n.set(o,[s])}return n}}}const If={},Nf=Object.freeze(Object.defineProperty({__proto__:null,default:If},Symbol.toStringTag,{value:"Module"})),Rf=rd(Nf);var Ll,us,Ol,cs,Cl,ds,jl,hs,$l,fs,Fl,ps,kl,gs,Pl,ms,Ml,ys,Bl,bs,ql,_s,Ul,ws,Hl,vs,Vl,xs,Gl,Es,Wl,Ss,zl,Is,Ql,Ns,Xl,Rs,Jl,Ts,Kl,As,Yl,Ds,Zl,Ls,eu,Os,tu,Cs,ru,js,nu,$s,iu,Fs,su;function Tf(){return Ll||(Ll=1,function(e){const t=Mc(),n=Ef(),r=Bc(),i=Sf();let s;try{s=Rf}catch{}function o(t){return Array.isArray(t)?t:e.NQuads.legacyDatasetToQuads(t)}e.NQuads=ka(),e.IdentifierIssuer=Fa(),e._rdfCanonizeNative=function(e){return e&&(s=e),s},e.canonize=async function(e,r){const i=o(e);if(r.useNative){if(!s)throw new Error("rdf-canonize-native not available");if(r.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return new Promise((e,t)=>s.canonize(i,r,(n,r)=>n?t(n):e(r)))}if("URDNA2015"===r.algorithm)return new t(r).main(i);if("URGNA2012"===r.algorithm){if(r.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new n(r).main(i)}throw"algorithm"in r?new Error("Invalid RDF Dataset Canonicalization algorithm: "+r.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")},e._canonizeSync=function(e,t){const n=o(e);if(t.useNative){if(!s)throw new Error("rdf-canonize-native not available");if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "useNative".');return s.canonizeSync(n,t)}if("URDNA2015"===t.algorithm)return new r(t).main(n);if("URGNA2012"===t.algorithm){if(t.createMessageDigest)throw new Error('"createMessageDigest" cannot be used with "URGNA2012".');return new i(t).main(n)}throw"algorithm"in t?new Error("Invalid RDF Dataset Canonicalization algorithm: "+t.algorithm):new Error("No RDF Dataset Canonicalization algorithm specified.")}}(Zi)),Zi}function Pa(){return Ol||(Ol=1,us=Tf()),us}function ut(){if(Cl)return cs;Cl=1;const e={};return cs=e,e.isArray=Array.isArray,e.isBoolean=e=>"boolean"==typeof e||"[object Boolean]"===Object.prototype.toString.call(e),e.isDouble=t=>e.isNumber(t)&&(-1!==String(t).indexOf(".")||Math.abs(t)>=1e21),e.isEmptyObject=t=>e.isObject(t)&&0===Object.keys(t).length,e.isNumber=e=>"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e),e.isNumeric=e=>!isNaN(parseFloat(e))&&isFinite(e),e.isObject=e=>"[object Object]"===Object.prototype.toString.call(e),e.isString=e=>"string"==typeof e||"[object String]"===Object.prototype.toString.call(e),e.isUndefined=e=>typeof e>"u",cs}function kt(){if(jl)return ds;jl=1;const e=ut(),t={};return ds=t,t.isSubject=t=>!(!e.isObject(t)||"@value"in t||"@set"in t||"@list"in t)&&(Object.keys(t).length>1||!("@id"in t)),t.isSubjectReference=t=>e.isObject(t)&&1===Object.keys(t).length&&"@id"in t,t.isValue=t=>e.isObject(t)&&"@value"in t,t.isList=t=>e.isObject(t)&&"@list"in t,t.isGraph=t=>e.isObject(t)&&"@graph"in t&&1===Object.keys(t).filter(e=>"@id"!==e&&"@index"!==e).length,t.isSimpleGraph=e=>t.isGraph(e)&&!("@id"in e),t.isBlankNode=t=>{if(e.isObject(t)){if("@id"in t){const n=t["@id"];return!e.isString(n)||0===n.indexOf("_:")}return 0===Object.keys(t).length||!("@value"in t||"@set"in t||"@list"in t)}return!1},ds}function gt(){return $l||($l=1,hs=class extends Error{constructor(e="An unspecified JSON-LD error occurred.",t="jsonld.Error",n={}){super(e),this.name=t,this.message=e,this.details=n}}),hs}function ht(){if(Fl)return fs;Fl=1;const e=kt(),t=ut(),n=Pa().IdentifierIssuer,r=gt(),i=/(?:<[^>]*?>|"[^"]*?"|[^,])+/g,s=/\s*<([^>]*?)>\s*(?:;\s*(.*))?/,o=/(.*?)=(?:(?:"([^"]*?)")|([^"]*?))\s*(?:(?:;\s*)|$)/g,a="application/ld+json, application/json",l={};function c(n,r){if(t.isArray(r))for(let e=0;e<r.length;++e)r[e]=c(n,r[e]);else if(e.isList(r))r["@list"]=c(n,r["@list"]);else if(t.isObject(r)){e.isBlankNode(r)&&(r["@id"]=n.getId(r["@id"]));const t=Object.keys(r).sort();for(let e=0;e<t.length;++e){const i=t[e];"@id"!==i&&(r[i]=c(n,r[i]))}}return r}return fs=l,l.IdentifierIssuer=n,l.REGEX_BCP47=/^[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*$/,l.REGEX_KEYWORD=/^@[a-zA-Z]+$/,l.clone=function(e){if(e&&"object"==typeof e){let n;if(t.isArray(e)){n=[];for(let t=0;t<e.length;++t)n[t]=l.clone(e[t])}else if(e instanceof Map){n=new Map;for(const[t,r]of e)n.set(t,l.clone(r))}else if(e instanceof Set){n=new Set;for(const t of e)n.add(l.clone(t))}else if(t.isObject(e)){n={};for(const t in e)n[t]=l.clone(e[t])}else n=e.toString();return n}return e},l.asArray=function(e){return Array.isArray(e)?e:[e]},l.buildHeaders=(e={})=>{if(Object.keys(e).some(e=>"accept"===e.toLowerCase()))throw new RangeError('Accept header may not be specified; only "'+a+'" is supported.');return Object.assign({Accept:a},e)},l.parseLinkHeader=e=>{const t={},n=e.match(i);for(let e=0;e<n.length;++e){let r=n[e].match(s);if(!r)continue;const i={target:r[1]},a=r[2];for(;r=o.exec(a);)i[r[1]]=void 0===r[2]?r[3]:r[2];const l=i.rel||"";Array.isArray(t[l])?t[l].push(i):t.hasOwnProperty(l)?t[l]=[t[l],i]:t[l]=i}return t},l.validateTypeValue=(e,n)=>{if(!(t.isString(e)||t.isArray(e)&&e.every(e=>t.isString(e)))){if(n&&t.isObject(e))switch(Object.keys(e).length){case 0:return;case 1:if("@default"in e&&l.asArray(e["@default"]).every(e=>t.isString(e)))return}throw new r('Invalid JSON-LD syntax; "@type" value must a string, an array of strings, an empty object, or a default object.',"jsonld.SyntaxError",{code:"invalid type value",value:e})}},l.hasProperty=(e,n)=>{if(e.hasOwnProperty(n)){const r=e[n];return!t.isArray(r)||r.length>0}return!1},l.hasValue=(n,r,i)=>{if(l.hasProperty(n,r)){let s=n[r];const o=e.isList(s);if(t.isArray(s)||o){o&&(s=s["@list"]);for(let e=0;e<s.length;++e)if(l.compareValues(i,s[e]))return!0}else if(!t.isArray(i))return l.compareValues(i,s)}return!1},l.addValue=(e,n,r,i)=>{if("propertyIsArray"in(i=i||{})||(i.propertyIsArray=!1),"valueIsArray"in i||(i.valueIsArray=!1),"allowDuplicate"in i||(i.allowDuplicate=!0),"prependValue"in i||(i.prependValue=!1),i.valueIsArray)e[n]=r;else if(t.isArray(r)){0===r.length&&i.propertyIsArray&&!e.hasOwnProperty(n)&&(e[n]=[]),i.prependValue&&(r=r.concat(e[n]),e[n]=[]);for(let t=0;t<r.length;++t)l.addValue(e,n,r[t],i)}else if(e.hasOwnProperty(n)){const s=!i.allowDuplicate&&l.hasValue(e,n,r);!t.isArray(e[n])&&(!s||i.propertyIsArray)&&(e[n]=[e[n]]),s||(i.prependValue?e[n].unshift(r):e[n].push(r))}else e[n]=i.propertyIsArray?[r]:r},l.getValues=(e,t)=>[].concat(e[t]||[]),l.removeProperty=(e,t)=>{delete e[t]},l.removeValue=(e,t,n,r)=>{"propertyIsArray"in(r=r||{})||(r.propertyIsArray=!1);const i=l.getValues(e,t).filter(e=>!l.compareValues(e,n));0===i.length?l.removeProperty(e,t):1!==i.length||r.propertyIsArray?e[t]=i:e[t]=i[0]},l.relabelBlankNodes=(e,t)=>c((t=t||{}).issuer||new n("_:b"),e),l.compareValues=(n,r)=>!!(n===r||e.isValue(n)&&e.isValue(r)&&n["@value"]===r["@value"]&&n["@type"]===r["@type"]&&n["@language"]===r["@language"]&&n["@index"]===r["@index"])||!!(t.isObject(n)&&"@id"in n&&t.isObject(r)&&"@id"in r)&&n["@id"]===r["@id"],l.compareShortestLeast=(e,t)=>e.length<t.length?-1:t.length<e.length?1:e===t?0:e<t?-1:1,fs}function Ma(){if(kl)return ps;kl=1;const e="http://www.w3.org/1999/02/22-rdf-syntax-ns#",t="http://www.w3.org/2001/XMLSchema#";return ps={LINK_HEADER_REL:"http://www.w3.org/ns/json-ld#context",LINK_HEADER_CONTEXT:"http://www.w3.org/ns/json-ld#context",RDF:e,RDF_LIST:e+"List",RDF_FIRST:e+"first",RDF_REST:e+"rest",RDF_NIL:e+"nil",RDF_TYPE:e+"type",RDF_PLAIN_LITERAL:e+"PlainLiteral",RDF_XML_LITERAL:e+"XMLLiteral",RDF_JSON_LITERAL:e+"JSON",RDF_OBJECT:e+"object",RDF_LANGSTRING:e+"langString",XSD:t,XSD_BOOLEAN:t+"boolean",XSD_DOUBLE:t+"double",XSD_INTEGER:t+"integer",XSD_STRING:t+"string"}}function qc(){return Pl||(Pl=1,gs=class{constructor(){this._requests={}}wrapLoader(e){const t=this;return t._loader=e,function(){return t.add.apply(t,arguments)}}async add(e){let t=this._requests[e];if(t)return Promise.resolve(t);t=this._requests[e]=this._loader(e);try{return await t}finally{delete this._requests[e]}}}),gs}function Jt(){if(Ml)return ms;Ml=1;const e=ut(),t={};ms=t,t.parsers={simple:{keys:["href","scheme","authority","path","query","fragment"],regex:/^(?:([^:\/?#]+):)?(?:\/\/([^\/?#]*))?([^?#]*)(?:\?([^#]*))?(?:#(.*))?/},full:{keys:["href","protocol","scheme","authority","auth","user","password","hostname","port","path","directory","file","query","fragment"],regex:/^(([a-zA-Z][a-zA-Z0-9+-.]*):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?(?:(((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/}},t.parse=(e,n)=>{const r={},i=t.parsers[n||"full"],s=i.regex.exec(e);let o=i.keys.length;for(;o--;)r[i.keys[o]]=void 0===s[o]?null:s[o];return("https"===r.scheme&&"443"===r.port||"http"===r.scheme&&"80"===r.port)&&(r.href=r.href.replace(":"+r.port,""),r.authority=r.authority.replace(":"+r.port,""),r.port=null),r.normalizedPath=t.removeDotSegments(r.path),r},t.prependBase=(n,r)=>{if(null===n||t.isAbsolute(r))return r;(!n||e.isString(n))&&(n=t.parse(n||""));const i=t.parse(r),s={protocol:n.protocol||""};if(null!==i.authority)s.authority=i.authority,s.path=i.path,s.query=i.query;else if(s.authority=n.authority,""===i.path)s.path=n.path,null!==i.query?s.query=i.query:s.query=n.query;else{if(0===i.path.indexOf("/"))s.path=i.path;else{let e=n.path;e=e.substr(0,e.lastIndexOf("/")+1),(e.length>0||n.authority)&&"/"!==e.substr(-1)&&(e+="/"),e+=i.path,s.path=e}s.query=i.query}""!==i.path&&(s.path=t.removeDotSegments(s.path));let o=s.protocol;return null!==s.authority&&(o+="//"+s.authority),o+=s.path,null!==s.query&&(o+="?"+s.query),null!==i.fragment&&(o+="#"+i.fragment),""===o&&(o="./"),o},t.removeBase=(n,r)=>{if(null===n)return r;(!n||e.isString(n))&&(n=t.parse(n||""));let i="";if(""!==n.href?i+=(n.protocol||"")+"//"+(n.authority||""):r.indexOf("//")&&(i+="//"),0!==r.indexOf(i))return r;const s=t.parse(r.substr(i.length)),o=n.normalizedPath.split("/"),a=s.normalizedPath.split("/"),l=s.fragment||s.query?0:1;for(;o.length>0&&a.length>l&&o[0]===a[0];)o.shift(),a.shift();let c="";if(o.length>0){o.pop();for(let e=0;e<o.length;++e)c+="../"}return c+=a.join("/"),null!==s.query&&(c+="?"+s.query),null!==s.fragment&&(c+="#"+s.fragment),""===c&&(c="./"),c},t.removeDotSegments=e=>{if(0===e.length)return"";const t=e.split("/"),n=[];for(;t.length>0;){const e=t.shift(),r=0===t.length;"."!==e?".."!==e?n.push(e):(n.pop(),r&&n.push("")):r&&n.push("")}return"/"===e[0]&&n.length>0&&""!==n[0]&&n.unshift(""),1===n.length&&""===n[0]?"/":n.join("/")};const n=/^([A-Za-z][A-Za-z0-9+-.]*|_):[^\s]*$/;return t.isAbsolute=t=>e.isString(t)&&n.test(t),t.isRelative=t=>e.isString(t),ms}function Af(){if(Bl)return ys;Bl=1;const{parseLinkHeader:e,buildHeaders:t}=ht(),{LINK_HEADER_CONTEXT:n}=Ma(),r=gt(),i=qc(),{prependBase:s}=Jt(),o=/(^|(\r\n))link:/i;return ys=({secure:a,headers:l={},xhr:c}={headers:{}})=>(l=t(l),(new i).wrapLoader(async function t(i){if(0!==i.indexOf("http:")&&0!==i.indexOf("https:"))throw new r('URL could not be dereferenced; only "http" and "https" URLs are supported.',"jsonld.InvalidUrl",{code:"loading document failed",url:i});if(a&&0!==i.indexOf("https"))throw new r('URL could not be dereferenced; secure mode is enabled and the URL\'s scheme is not "https".',"jsonld.InvalidUrl",{code:"loading document failed",url:i});let u;try{u=await function(e,t,n){const r=new(e=e||XMLHttpRequest);return new Promise((e,i)=>{r.onload=()=>e(r),r.onerror=e=>i(e),r.open("GET",t,!0);for(const e in n)r.setRequestHeader(e,n[e]);r.send()})}(c,i,l)}catch(e){throw new r("URL could not be dereferenced, an error occurred.","jsonld.LoadDocumentError",{code:"loading document failed",url:i,cause:e})}if(u.status>=400)throw new r("URL could not be dereferenced: "+u.statusText,"jsonld.LoadDocumentError",{code:"loading document failed",url:i,httpStatusCode:u.status});let d={contextUrl:null,documentUrl:i,document:u.response},h=null;const p=u.getResponseHeader("Content-Type");let f;if(o.test(u.getAllResponseHeaders())&&(f=u.getResponseHeader("Link")),f&&"application/ld+json"!==p){const o=e(f),a=o[n];if(Array.isArray(a))throw new r("URL could not be dereferenced, it has more than one associated HTTP Link Header.","jsonld.InvalidUrl",{code:"multiple context link headers",url:i});a&&(d.contextUrl=a.target),h=o.alternate,h&&"application/ld+json"==h.type&&!(p||"").match(/^application\/(\w*\+)?json$/)&&(d=await t(s(i,h.target)))}return d}))}function Df(){if(ql)return bs;ql=1;const e=Af(),t={};return bs=t,t.setupDocumentLoaders=function(t){typeof XMLHttpRequest<"u"&&(t.documentLoaders.xhr=e,t.useDocumentLoader("xhr"))},t.setupGlobals=function(e){typeof globalThis.JsonLdProcessor>"u"&&Object.defineProperty(globalThis,"JsonLdProcessor",{writable:!0,enumerable:!1,configurable:!0,value:e.JsonLdProcessor})},bs}function Lf(){return Ul||(Ul=1,_s=function(e){e.prototype[Symbol.iterator]=function*(){for(let e=this.head;e;e=e.next)yield e.value}}),_s}function Of(){if(Hl)return ws;function e(t){var n=this;if(n instanceof e||(n=new e),n.tail=null,n.head=null,n.length=0,t&&"function"==typeof t.forEach)t.forEach(function(e){n.push(e)});else if(arguments.length>0)for(var r=0,i=arguments.length;r<i;r++)n.push(arguments[r]);return n}function t(e,t,n){var r=t===e.head?new i(n,null,t,e):new i(n,t,t.next,e);return null===r.next&&(e.tail=r),null===r.prev&&(e.head=r),e.length++,r}function n(e,t){e.tail=new i(t,e.tail,null,e),e.head||(e.head=e.tail),e.length++}function r(e,t){e.head=new i(t,null,e.head,e),e.tail||(e.tail=e.head),e.length++}function i(e,t,n,r){if(!(this instanceof i))return new i(e,t,n,r);this.list=r,this.value=e,t?(t.next=this,this.prev=t):this.prev=null,n?(n.prev=this,this.next=n):this.next=null}Hl=1,ws=e,e.Node=i,e.create=e,e.prototype.removeNode=function(e){if(e.list!==this)throw new Error("removing node which does not belong to this list");var t=e.next,n=e.prev;return t&&(t.prev=n),n&&(n.next=t),e===this.head&&(this.head=t),e===this.tail&&(this.tail=n),e.list.length--,e.next=null,e.prev=null,e.list=null,t},e.prototype.unshiftNode=function(e){if(e!==this.head){e.list&&e.list.removeNode(e);var t=this.head;e.list=this,e.next=t,t&&(t.prev=e),this.head=e,this.tail||(this.tail=e),this.length++}},e.prototype.pushNode=function(e){if(e!==this.tail){e.list&&e.list.removeNode(e);var t=this.tail;e.list=this,e.prev=t,t&&(t.next=e),this.tail=e,this.head||(this.head=e),this.length++}},e.prototype.push=function(){for(var e=0,t=arguments.length;e<t;e++)n(this,arguments[e]);return this.length},e.prototype.unshift=function(){for(var e=0,t=arguments.length;e<t;e++)r(this,arguments[e]);return this.length},e.prototype.pop=function(){if(this.tail){var e=this.tail.value;return this.tail=this.tail.prev,this.tail?this.tail.next=null:this.head=null,this.length--,e}},e.prototype.shift=function(){if(this.head){var e=this.head.value;return this.head=this.head.next,this.head?this.head.prev=null:this.tail=null,this.length--,e}},e.prototype.forEach=function(e,t){t=t||this;for(var n=this.head,r=0;null!==n;r++)e.call(t,n.value,r,this),n=n.next},e.prototype.forEachReverse=function(e,t){t=t||this;for(var n=this.tail,r=this.length-1;null!==n;r--)e.call(t,n.value,r,this),n=n.prev},e.prototype.get=function(e){for(var t=0,n=this.head;null!==n&&t<e;t++)n=n.next;if(t===e&&null!==n)return n.value},e.prototype.getReverse=function(e){for(var t=0,n=this.tail;null!==n&&t<e;t++)n=n.prev;if(t===e&&null!==n)return n.value},e.prototype.map=function(t,n){n=n||this;for(var r=new e,i=this.head;null!==i;)r.push(t.call(n,i.value,this)),i=i.next;return r},e.prototype.mapReverse=function(t,n){n=n||this;for(var r=new e,i=this.tail;null!==i;)r.push(t.call(n,i.value,this)),i=i.prev;return r},e.prototype.reduce=function(e,t){var n,r=this.head;if(arguments.length>1)n=t;else{if(!this.head)throw new TypeError("Reduce of empty list with no initial value");r=this.head.next,n=this.head.value}for(var i=0;null!==r;i++)n=e(n,r.value,i),r=r.next;return n},e.prototype.reduceReverse=function(e,t){var n,r=this.tail;if(arguments.length>1)n=t;else{if(!this.tail)throw new TypeError("Reduce of empty list with no initial value");r=this.tail.prev,n=this.tail.value}for(var i=this.length-1;null!==r;i--)n=e(n,r.value,i),r=r.prev;return n},e.prototype.toArray=function(){for(var e=new Array(this.length),t=0,n=this.head;null!==n;t++)e[t]=n.value,n=n.next;return e},e.prototype.toArrayReverse=function(){for(var e=new Array(this.length),t=0,n=this.tail;null!==n;t++)e[t]=n.value,n=n.prev;return e},e.prototype.slice=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var r=new e;if(n<t||n<0)return r;t<0&&(t=0),n>this.length&&(n=this.length);for(var i=0,s=this.head;null!==s&&i<t;i++)s=s.next;for(;null!==s&&i<n;i++,s=s.next)r.push(s.value);return r},e.prototype.sliceReverse=function(t,n){(n=n||this.length)<0&&(n+=this.length),(t=t||0)<0&&(t+=this.length);var r=new e;if(n<t||n<0)return r;t<0&&(t=0),n>this.length&&(n=this.length);for(var i=this.length,s=this.tail;null!==s&&i>n;i--)s=s.prev;for(;null!==s&&i>t;i--,s=s.prev)r.push(s.value);return r},e.prototype.splice=function(e,n,...r){e>this.length&&(e=this.length-1),e<0&&(e=this.length+e);for(var i=0,s=this.head;null!==s&&i<e;i++)s=s.next;var o=[];for(i=0;s&&i<n;i++)o.push(s.value),s=this.removeNode(s);for(null===s&&(s=this.tail),s!==this.head&&s!==this.tail&&(s=s.prev),i=0;i<r.length;i++)s=t(this,s,r[i]);return o},e.prototype.reverse=function(){for(var e=this.head,t=this.tail,n=e;null!==n;n=n.prev){var r=n.prev;n.prev=n.next,n.next=r}return this.head=t,this.tail=e,this};try{Lf()(e)}catch{}return ws}function Uc(){if(Vl)return vs;Vl=1;const e=Of(),t=Symbol("max"),n=Symbol("length"),r=Symbol("lengthCalculator"),i=Symbol("allowStale"),s=Symbol("maxAge"),o=Symbol("dispose"),a=Symbol("noDisposeOnSet"),l=Symbol("lruList"),c=Symbol("cache"),u=Symbol("updateAgeOnGet"),d=()=>1,h=(e,t,n)=>{const r=e[c].get(t);if(r){const t=r.value;if(p(e,t)){if(g(e,r),!e[i])return}else n&&(e[u]&&(r.value.now=Date.now()),e[l].unshiftNode(r));return t.value}},p=(e,t)=>{if(!t||!t.maxAge&&!e[s])return!1;const n=Date.now()-t.now;return t.maxAge?n>t.maxAge:e[s]&&n>e[s]},f=e=>{if(e[n]>e[t])for(let r=e[l].tail;e[n]>e[t]&&null!==r;){const t=r.prev;g(e,r),r=t}},g=(e,t)=>{if(t){const r=t.value;e[o]&&e[o](r.key,r.value),e[n]-=r.length,e[c].delete(r.key),e[l].removeNode(t)}};class m{constructor(e,t,n,r,i){this.key=e,this.value=t,this.length=n,this.now=r,this.maxAge=i||0}}const b=(e,t,n,r)=>{let s=n.value;p(e,s)&&(g(e,n),e[i]||(s=void 0)),s&&t.call(r,s.value,s.key,e)};return vs=class{constructor(e){if("number"==typeof e&&(e={max:e}),e||(e={}),e.max&&("number"!=typeof e.max||e.max<0))throw new TypeError("max must be a non-negative number");this[t]=e.max||1/0;const n=e.length||d;if(this[r]="function"!=typeof n?d:n,this[i]=e.stale||!1,e.maxAge&&"number"!=typeof e.maxAge)throw new TypeError("maxAge must be a number");this[s]=e.maxAge||0,this[o]=e.dispose,this[a]=e.noDisposeOnSet||!1,this[u]=e.updateAgeOnGet||!1,this.reset()}set max(e){if("number"!=typeof e||e<0)throw new TypeError("max must be a non-negative number");this[t]=e||1/0,f(this)}get max(){return this[t]}set allowStale(e){this[i]=!!e}get allowStale(){return this[i]}set maxAge(e){if("number"!=typeof e)throw new TypeError("maxAge must be a non-negative number");this[s]=e,f(this)}get maxAge(){return this[s]}set lengthCalculator(e){"function"!=typeof e&&(e=d),e!==this[r]&&(this[r]=e,this[n]=0,this[l].forEach(e=>{e.length=this[r](e.value,e.key),this[n]+=e.length})),f(this)}get lengthCalculator(){return this[r]}get length(){return this[n]}get itemCount(){return this[l].length}rforEach(e,t){t=t||this;for(let n=this[l].tail;null!==n;){const r=n.prev;b(this,e,n,t),n=r}}forEach(e,t){t=t||this;for(let n=this[l].head;null!==n;){const r=n.next;b(this,e,n,t),n=r}}keys(){return this[l].toArray().map(e=>e.key)}values(){return this[l].toArray().map(e=>e.value)}reset(){this[o]&&this[l]&&this[l].length&&this[l].forEach(e=>this[o](e.key,e.value)),this[c]=new Map,this[l]=new e,this[n]=0}dump(){return this[l].map(e=>!p(this,e)&&{k:e.key,v:e.value,e:e.now+(e.maxAge||0)}).toArray().filter(e=>e)}dumpLru(){return this[l]}set(e,i,u){if((u=u||this[s])&&"number"!=typeof u)throw new TypeError("maxAge must be a number");const d=u?Date.now():0,h=this[r](i,e);if(this[c].has(e)){if(h>this[t])return g(this,this[c].get(e)),!1;const r=this[c].get(e).value;return this[o]&&(this[a]||this[o](e,r.value)),r.now=d,r.maxAge=u,r.value=i,this[n]+=h-r.length,r.length=h,this.get(e),f(this),!0}const p=new m(e,i,h,d,u);return p.length>this[t]?(this[o]&&this[o](e,i),!1):(this[n]+=p.length,this[l].unshift(p),this[c].set(e,this[l].head),f(this),!0)}has(e){if(!this[c].has(e))return!1;const t=this[c].get(e).value;return!p(this,t)}get(e){return h(this,e,!0)}peek(e){return h(this,e,!1)}pop(){const e=this[l].tail;return e?(g(this,e),e.value):null}del(e){g(this,this[c].get(e))}load(e){this.reset();const t=Date.now();for(let n=e.length-1;n>=0;n--){const r=e[n],i=r.e||0;if(0===i)this.set(r.k,r.v);else{const e=i-t;e>0&&this.set(r.k,r.v,e)}}}prune(){this[c].forEach((e,t)=>h(this,t,!1))}}}function Cf(){if(Gl)return xs;Gl=1;const e=Uc();return xs=class{constructor({document:t}){this.document=t,this.cache=new e({max:10})}getProcessed(e){return this.cache.get(e)}setProcessed(e,t){this.cache.set(e,t)}}}function jf(){if(Wl)return Es;Wl=1;const{isArray:e,isObject:t,isString:n}=ut(),{asArray:r}=ht(),{prependBase:i}=Jt(),s=gt(),o=Cf();function a(e){throw new s("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:e})}function l({context:r,base:s}){if(!r)return;const o=r["@context"];if(n(o))r["@context"]=i(s,o);else if(e(o))for(let e=0;e<o.length;++e){const r=o[e];n(r)?o[e]=i(s,r):t(r)&&l({context:{"@context":r},base:s})}else if(t(o))for(const e in o)l({context:o[e],base:s})}return Es=class{constructor({sharedCache:e}){this.perOpCache=new Map,this.sharedCache=e}async resolve({activeCtx:i,context:s,documentLoader:l,base:c,cycles:u=new Set}){s&&t(s)&&s["@context"]&&(s=s["@context"]),s=r(s);const d=[];for(const r of s){if(n(r)){let t=this._get(r);t||(t=await this._resolveRemoteContext({activeCtx:i,url:r,documentLoader:l,base:c,cycles:u})),e(t)?d.push(...t):d.push(t);continue}if(null===r){d.push(new o({document:null}));continue}t(r)||a(s);const h=JSON.stringify(r);let p=this._get(h);p||(p=new o({document:r}),this._cacheResolvedContext({key:h,resolved:p,tag:"static"})),d.push(p)}return d}_get(e){let t=this.perOpCache.get(e);if(!t){const n=this.sharedCache.get(e);n&&(t=n.get("static"),t&&this.perOpCache.set(e,t))}return t}_cacheResolvedContext({key:e,resolved:t,tag:n}){if(this.perOpCache.set(e,t),void 0!==n){let r=this.sharedCache.get(e);r||(r=new Map,this.sharedCache.set(e,r)),r.set(n,t)}return t}async _resolveRemoteContext({activeCtx:e,url:t,documentLoader:n,base:r,cycles:s}){t=i(r,t);const{context:o,remoteDoc:a}=await this._fetchContext({activeCtx:e,url:t,documentLoader:n,cycles:s});l({context:o,base:r=a.documentUrl||t});const c=await this.resolve({activeCtx:e,context:o,documentLoader:n,base:r,cycles:s});return this._cacheResolvedContext({key:t,resolved:c,tag:a.tag}),c}async _fetchContext({activeCtx:r,url:i,documentLoader:o,cycles:a}){if(a.size>10)throw new s("Maximum number of @context URLs exceeded.","jsonld.ContextUrlError",{code:"json-ld-1.0"===r.processingMode?"loading remote context failed":"context overflow",max:10});if(a.has(i))throw new s("Cyclical @context URLs detected.","jsonld.ContextUrlError",{code:"json-ld-1.0"===r.processingMode?"recursive context inclusion":"context overflow",url:i});let l,c;a.add(i);try{c=await o(i),l=c.document||null,n(l)&&(l=JSON.parse(l))}catch(e){throw new s(`Dereferencing a URL did not result in a valid JSON-LD object. Possible causes are an inaccessible URL perhaps due to a same-origin policy (ensure the server uses CORS if you are using client-side JavaScript), too many redirects, a non-JSON response, or more than one HTTP Link Header was provided for a remote context. URL: "${i}".`,"jsonld.InvalidUrl",{code:"loading remote context failed",url:i,cause:e})}if(!t(l))throw new s(`Dereferencing a URL did not result in a JSON object. The response was valid JSON, but it was not a JSON object. URL: "${i}".`,"jsonld.InvalidUrl",{code:"invalid remote context",url:i});return l="@context"in l?{"@context":l["@context"]}:{"@context":{}},c.contextUrl&&(e(l["@context"])||(l["@context"]=[l["@context"]]),l["@context"].push(c.contextUrl)),{context:l,remoteDoc:c}}}}function $f(){return zl||(zl=1,Ss=Pa().NQuads),Ss}function An(){if(Ql)return Is;Ql=1;const e=gt(),{isArray:t}=ut(),{asArray:n}=ht(),r={};function i({event:n,handlers:r}){let s=!0;for(let o=0;s&&o<r.length;++o){s=!1;const a=r[o];if(t(a))s=i({event:n,handlers:a});else if("function"==typeof a)a({event:n,next:()=>{s=!0}});else{if("object"!=typeof a)throw new e("Invalid event handler.","jsonld.InvalidEventHandler",{event:n});n.code in a?a[n.code]({event:n,next:()=>{s=!0}}):s=!0}}return s}Is=r,r.defaultEventHandler=null,r.setupEventHandler=({options:e={}})=>{const t=[].concat(e.safe?r.safeEventHandler:[],e.eventHandler?n(e.eventHandler):[],r.defaultEventHandler?r.defaultEventHandler:[]);return 0===t.length?null:t},r.handleEvent=({event:e,options:t})=>{i({event:e,handlers:t.eventHandler})};const s=new Set(["empty object","free-floating scalar","invalid @language value","invalid property","null @id value","null @value value","object with only @id","object with only @language","object with only @list","object with only @value","relative @id reference","relative @type reference","relative @vocab reference","reserved @id value","reserved @reverse value","reserved term","blank node predicate","relative graph reference","relative object reference","relative predicate reference","relative subject reference","rdfDirection not set"]);return r.safeEventHandler=function({event:t,next:n}){if("warning"===t.level&&s.has(t.code))throw new e("Safe mode validation error.","jsonld.ValidationError",{event:t});n()},r.logEventHandler=function({event:e,next:t}){console.log(`EVENT: ${e.message}`,{event:e}),t()},r.logWarningEventHandler=function({event:e,next:t}){"warning"===e.level&&console.warn(`WARNING: ${e.message}`,{event:e}),t()},r.unhandledEventHandler=function({event:t}){throw new e("No handler for event.","jsonld.UnhandledEvent",{event:t})},r.setDefaultEventHandler=function({eventHandler:e}={}){r.defaultEventHandler=e?n(e):null},Is}function hr(){if(Xl)return Ns;Xl=1;const e=ht(),t=gt(),{isArray:n,isObject:r,isString:i,isUndefined:s}=ut(),{isAbsolute:o,isRelative:a,prependBase:l}=Jt(),{handleEvent:c}=An(),{REGEX_BCP47:u,REGEX_KEYWORD:d,asArray:h,compareShortestLeast:p}=ht(),f=new Map,g={};function m(e,t,n,s,a,c){if(null===t||!i(t)||g.isKeyword(t))return t;if(t.match(d))return null;if(s&&s.hasOwnProperty(t)&&!0!==a.get(t)&&g.createTermDefinition({activeCtx:e,localCtx:s,term:t,defined:a,options:c}),(n=n||{}).vocab){const n=e.mappings.get(t);if(null===n)return null;if(r(n)&&"@id"in n)return n["@id"]}const u=t.indexOf(":");if(u>0){const n=t.substr(0,u),r=t.substr(u+1);if("_"===n||0===r.indexOf("//"))return t;s&&s.hasOwnProperty(n)&&g.createTermDefinition({activeCtx:e,localCtx:s,term:n,defined:a,options:c});const i=e.mappings.get(n);if(i&&i._prefix)return i["@id"]+r;if(o(t))return t}if(n.vocab&&"@vocab"in e)t=e["@vocab"]+t;else if(n.base){let n,r;"@base"in e?e["@base"]?(r=l(c.base,e["@base"]),n=l(r,t)):(r=e["@base"],n=t):(r=c.base,n=l(c.base,t)),t=n}return t}function b(e,t){if(!e||"object"!=typeof e||!t||"object"!=typeof t)return e===t;const n=Array.isArray(e);if(n!==Array.isArray(t))return!1;if(n){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(!b(e[n],t[n]))return!1;return!0}const r=Object.keys(e),i=Object.keys(t);if(r.length!==i.length)return!1;for(const n in e){let r=e[n],i=t[n];if("@container"===n&&Array.isArray(r)&&Array.isArray(i)&&(r=r.slice().sort(),i=i.slice().sort()),!b(r,i))return!1}return!0}return Ns=g,g.process=async({activeCtx:e,localCtx:s,options:d,propagate:p=!0,overrideProtected:f=!1,cycles:b=new Set})=>{if(r(s)&&"@context"in s&&n(s["@context"])&&(s=s["@context"]),0===h(s).length)return e;const y=[],v=[({event:e,next:t})=>{y.push(e),t()}];d.eventHandler&&v.push(d.eventHandler);const w=d;d={...d,eventHandler:v};const _=await d.contextResolver.resolve({activeCtx:e,context:s,documentLoader:d.documentLoader,base:d.base});r(_[0].document)&&"boolean"==typeof _[0].document["@propagate"]&&(p=_[0].document["@propagate"]);let x=e;!p&&!x.previousContext&&(x=x.clone(),x.previousContext=e);for(const n of _){let{document:h}=n;if(e=x,null===h){if(!f&&0!==Object.keys(e.protected).length)throw new t("Tried to nullify a context with protected terms outside of a term definition.","jsonld.SyntaxError",{code:"invalid context nullification"});x=e=g.getInitialContext(d).clone();continue}const p=n.getProcessed(e);if(p){if(w.eventHandler)for(const e of p.events)c({event:e,options:w});x=e=p.context;continue}if(r(h)&&"@context"in h&&(h=h["@context"]),!r(h))throw new t("Invalid JSON-LD syntax; @context must be an object.","jsonld.SyntaxError",{code:"invalid local context",context:h});x=x.clone();const v=new Map;if("@version"in h){if(1.1!==h["@version"])throw new t("Unsupported JSON-LD version: "+h["@version"],"jsonld.UnsupportedVersion",{code:"invalid @version value",context:h});if(e.processingMode&&"json-ld-1.0"===e.processingMode)throw new t("@version: "+h["@version"]+" not compatible with "+e.processingMode,"jsonld.ProcessingModeConflict",{code:"processing mode conflict",context:h});x.processingMode="json-ld-1.1",x["@version"]=h["@version"],v.set("@version",!0)}if(x.processingMode=x.processingMode||e.processingMode,"@base"in h){let e=h["@base"];if(null!==e&&!o(e)){if(!a(e))throw new t('Invalid JSON-LD syntax; the value of "@base" in a @context must be an absolute IRI, a relative IRI, or null.',"jsonld.SyntaxError",{code:"invalid base IRI",context:h});e=l(x["@base"],e)}x["@base"]=e,v.set("@base",!0)}if("@vocab"in h){const e=h["@vocab"];if(null===e)delete x["@vocab"];else{if(!i(e))throw new t('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});if(!o(e)&&g.processingMode(x,1))throw new t('Invalid JSON-LD syntax; the value of "@vocab" in a @context must be an absolute IRI.',"jsonld.SyntaxError",{code:"invalid vocab mapping",context:h});{const t=m(x,e,{vocab:!0,base:!0},void 0,void 0,d);o(t)||d.eventHandler&&c({event:{type:["JsonLdEvent"],code:"relative @vocab reference",level:"warning",message:"Relative @vocab reference found.",details:{vocab:t}},options:d}),x["@vocab"]=t}}v.set("@vocab",!0)}if("@language"in h){const e=h["@language"];if(null===e)delete x["@language"];else{if(!i(e))throw new t('Invalid JSON-LD syntax; the value of "@language" in a @context must be a string or null.',"jsonld.SyntaxError",{code:"invalid default language",context:h});e.match(u)||d.eventHandler&&c({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:d}),x["@language"]=e.toLowerCase()}v.set("@language",!0)}if("@direction"in h){const n=h["@direction"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @direction not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context member",context:h});if(null===n)delete x["@direction"];else{if("ltr"!==n&&"rtl"!==n)throw new t('Invalid JSON-LD syntax; the value of "@direction" in a @context must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:h});x["@direction"]=n}v.set("@direction",!0)}if("@propagate"in h){const n=h["@propagate"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @propagate not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:h});if("boolean"!=typeof n)throw new t("Invalid JSON-LD syntax; @propagate value must be a boolean.","jsonld.SyntaxError",{code:"invalid @propagate value",context:s});v.set("@propagate",!0)}if("@import"in h){const n=h["@import"];if("json-ld-1.0"===e.processingMode)throw new t("Invalid JSON-LD syntax; @import not compatible with "+e.processingMode,"jsonld.SyntaxError",{code:"invalid context entry",context:h});if(!i(n))throw new t("Invalid JSON-LD syntax; @import must be a string.","jsonld.SyntaxError",{code:"invalid @import value",context:s});const r=await d.contextResolver.resolve({activeCtx:e,context:n,documentLoader:d.documentLoader,base:d.base});if(1!==r.length)throw new t("Invalid JSON-LD syntax; @import must reference a single context.","jsonld.SyntaxError",{code:"invalid remote context",context:s});const o=r[0].getProcessed(e);if(o)h=o;else{const n=r[0].document;if("@import"in n)throw new t("Invalid JSON-LD syntax: imported context must not include @import.","jsonld.SyntaxError",{code:"invalid context entry",context:s});for(const e in n)h.hasOwnProperty(e)||(h[e]=n[e]);r[0].setProcessed(e,h)}v.set("@import",!0)}v.set("@protected",h["@protected"]||!1);for(const e in h)if(g.createTermDefinition({activeCtx:x,localCtx:h,term:e,defined:v,options:d,overrideProtected:f}),r(h[e])&&"@context"in h[e]){const n=h[e]["@context"];let r=!0;if(i(n)){const e=l(d.base,n);b.has(e)?r=!1:b.add(e)}if(r)try{await g.process({activeCtx:x.clone(),localCtx:h[e]["@context"],overrideProtected:!0,options:d,cycles:b})}catch{throw new t("Invalid JSON-LD syntax; invalid scoped context.","jsonld.SyntaxError",{code:"invalid scoped context",context:h[e]["@context"],term:e})}}n.setProcessed(e,{context:x,events:y})}return x},g.createTermDefinition=({activeCtx:e,localCtx:s,term:a,defined:l,options:u,overrideProtected:h=!1})=>{if(l.has(a)){if(l.get(a))return;throw new t("Cyclical context definition detected.","jsonld.CyclicalContext",{code:"cyclic IRI mapping",context:s,term:a})}let p;if(l.set(a,!1),s.hasOwnProperty(a)&&(p=s[a]),"@type"===a&&r(p)&&"@set"===(p["@container"]||"@set")&&g.processingMode(e,1.1)){const e=["@container","@id","@protected"],n=Object.keys(p);if(0===n.length||n.some(t=>!e.includes(t)))throw new t("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:s,term:a})}else{if(g.isKeyword(a))throw new t("Invalid JSON-LD syntax; keywords cannot be overridden.","jsonld.SyntaxError",{code:"keyword redefinition",context:s,term:a});if(a.match(d))return void(u.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved term",level:"warning",message:'Terms beginning with "@" are reserved for future use and dropped.',details:{term:a}},options:u}));if(""===a)throw new t("Invalid JSON-LD syntax; a term cannot be an empty string.","jsonld.SyntaxError",{code:"invalid term definition",context:s})}const f=e.mappings.get(a);e.mappings.has(a)&&e.mappings.delete(a);let y=!1;if((i(p)||null===p)&&(y=!0,p={"@id":p}),!r(p))throw new t("Invalid JSON-LD syntax; @context term values must be strings or objects.","jsonld.SyntaxError",{code:"invalid term definition",context:s});const v={};e.mappings.set(a,v),v.reverse=!1;const w=["@container","@id","@language","@reverse","@type"];g.processingMode(e,1.1)&&w.push("@context","@direction","@index","@nest","@prefix","@protected");for(const e in p)if(!w.includes(e))throw new t("Invalid JSON-LD syntax; a term definition must not contain "+e,"jsonld.SyntaxError",{code:"invalid term definition",context:s});const _=a.indexOf(":");if(v._termHasColon=_>0,"@reverse"in p){if("@id"in p)throw new t("Invalid JSON-LD syntax; a @reverse term definition must not contain @id.","jsonld.SyntaxError",{code:"invalid reverse property",context:s});if("@nest"in p)throw new t("Invalid JSON-LD syntax; a @reverse term definition must not contain @nest.","jsonld.SyntaxError",{code:"invalid reverse property",context:s});const n=p["@reverse"];if(!i(n))throw new t("Invalid JSON-LD syntax; a @context @reverse value must be a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s});if(n.match(d))return u.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved @reverse value",level:"warning",message:'@reverse values beginning with "@" are reserved for future use and dropped.',details:{reverse:n}},options:u}),void(f?e.mappings.set(a,f):e.mappings.delete(a));const r=m(e,n,{vocab:!0,base:!1},s,l,u);if(!o(r))throw new t("Invalid JSON-LD syntax; a @context @reverse value must be an absolute IRI or a blank node identifier.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s});v["@id"]=r,v.reverse=!0}else if("@id"in p){let n=p["@id"];if(n&&!i(n))throw new t("Invalid JSON-LD syntax; a @context @id value must be an array of strings or a string.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s});if(null===n)v["@id"]=null;else{if(!g.isKeyword(n)&&n.match(d))return u.eventHandler&&c({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:'@id values beginning with "@" are reserved for future use and dropped.',details:{id:n}},options:u}),void(f?e.mappings.set(a,f):e.mappings.delete(a));if(n!==a){if(n=m(e,n,{vocab:!0,base:!1},s,l,u),!o(n)&&!g.isKeyword(n))throw new t("Invalid JSON-LD syntax; a @context @id value must be an absolute IRI, a blank node identifier, or a keyword.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s});if(a.match(/(?::[^:])|\//)&&m(e,a,{vocab:!0,base:!1},s,new Map(l).set(a,!0),u)!==n)throw new t("Invalid JSON-LD syntax; term in form of IRI must expand to definition.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s});v["@id"]=n,v._prefix=y&&!v._termHasColon&&null!==n.match(/[:\/\?#\[\]@]$/)}}}if(!("@id"in v))if(v._termHasColon){const t=a.substr(0,_);if(s.hasOwnProperty(t)&&g.createTermDefinition({activeCtx:e,localCtx:s,term:t,defined:l,options:u}),e.mappings.has(t)){const n=a.substr(_+1);v["@id"]=e.mappings.get(t)["@id"]+n}else v["@id"]=a}else if("@type"===a)v["@id"]=a;else{if(!("@vocab"in e))throw new t("Invalid JSON-LD syntax; @context terms must define an @id.","jsonld.SyntaxError",{code:"invalid IRI mapping",context:s,term:a});v["@id"]=e["@vocab"]+a}if((!0===p["@protected"]||!0===l.get("@protected")&&!1!==p["@protected"])&&(e.protected[a]=!0,v.protected=!0),l.set(a,!0),"@type"in p){let n=p["@type"];if(!i(n))throw new t("Invalid JSON-LD syntax; an @context @type value must be a string.","jsonld.SyntaxError",{code:"invalid type mapping",context:s});if("@json"===n||"@none"===n){if(g.processingMode(e,1))throw new t(`Invalid JSON-LD syntax; an @context @type value must not be "${n}" in JSON-LD 1.0 mode.`,"jsonld.SyntaxError",{code:"invalid type mapping",context:s})}else if("@id"!==n&&"@vocab"!==n){if(n=m(e,n,{vocab:!0,base:!1},s,l,u),!o(n))throw new t("Invalid JSON-LD syntax; an @context @type value must be an absolute IRI.","jsonld.SyntaxError",{code:"invalid type mapping",context:s});if(0===n.indexOf("_:"))throw new t("Invalid JSON-LD syntax; an @context @type value must be an IRI, not a blank node identifier.","jsonld.SyntaxError",{code:"invalid type mapping",context:s})}v["@type"]=n}if("@container"in p){const r=i(p["@container"])?[p["@container"]]:p["@container"]||[],o=["@list","@set","@index","@language"];let a=!0;const l=r.includes("@set");if(g.processingMode(e,1.1)){if(o.push("@graph","@id","@type"),r.includes("@list")){if(1!==r.length)throw new t("Invalid JSON-LD syntax; @context @container with @list must have no other values","jsonld.SyntaxError",{code:"invalid container mapping",context:s})}else if(r.includes("@graph")){if(r.some(e=>"@graph"!==e&&"@id"!==e&&"@index"!==e&&"@set"!==e))throw new t("Invalid JSON-LD syntax; @context @container with @graph must have no other values other than @id, @index, and @set","jsonld.SyntaxError",{code:"invalid container mapping",context:s})}else a&=r.length<=(l?2:1);if(r.includes("@type")&&(v["@type"]=v["@type"]||"@id",!["@id","@vocab"].includes(v["@type"])))throw new t("Invalid JSON-LD syntax; container: @type requires @type to be @id or @vocab.","jsonld.SyntaxError",{code:"invalid type mapping",context:s})}else a&=!n(p["@container"]),a&=r.length<=1;if(a&=r.every(e=>o.includes(e)),a&=!(l&&r.includes("@list")),!a)throw new t("Invalid JSON-LD syntax; @context @container value must be one of the following: "+o.join(", "),"jsonld.SyntaxError",{code:"invalid container mapping",context:s});if(v.reverse&&!r.every(e=>["@index","@set"].includes(e)))throw new t("Invalid JSON-LD syntax; @context @container value for a @reverse type definition must be @index or @set.","jsonld.SyntaxError",{code:"invalid reverse property",context:s});v["@container"]=r}if("@index"in p){if(!("@container"in p)||!v["@container"].includes("@index"))throw new t(`Invalid JSON-LD syntax; @index without @index in @container: "${p["@index"]}" on term "${a}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:s});if(!i(p["@index"])||0===p["@index"].indexOf("@"))throw new t(`Invalid JSON-LD syntax; @index must expand to an IRI: "${p["@index"]}" on term "${a}".`,"jsonld.SyntaxError",{code:"invalid term definition",context:s});v["@index"]=p["@index"]}if("@context"in p&&(v["@context"]=p["@context"]),"@language"in p&&!("@type"in p)){let e=p["@language"];if(null!==e&&!i(e))throw new t("Invalid JSON-LD syntax; @context @language value must be a string or null.","jsonld.SyntaxError",{code:"invalid language mapping",context:s});null!==e&&(e=e.toLowerCase()),v["@language"]=e}if("@prefix"in p){if(a.match(/:|\//))throw new t("Invalid JSON-LD syntax; @context @prefix used on a compact IRI term","jsonld.SyntaxError",{code:"invalid term definition",context:s});if(g.isKeyword(v["@id"]))throw new t("Invalid JSON-LD syntax; keywords may not be used as prefixes","jsonld.SyntaxError",{code:"invalid term definition",context:s});if("boolean"!=typeof p["@prefix"])throw new t("Invalid JSON-LD syntax; @context value for @prefix must be boolean","jsonld.SyntaxError",{code:"invalid @prefix value",context:s});v._prefix=!0===p["@prefix"]}if("@direction"in p){const e=p["@direction"];if(null!==e&&"ltr"!==e&&"rtl"!==e)throw new t('Invalid JSON-LD syntax; @direction value must be null, "ltr", or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",context:s});v["@direction"]=e}if("@nest"in p){const e=p["@nest"];if(!i(e)||"@nest"!==e&&0===e.indexOf("@"))throw new t("Invalid JSON-LD syntax; @context @nest value must be a string which is not a keyword other than @nest.","jsonld.SyntaxError",{code:"invalid @nest value",context:s});v["@nest"]=e}const x=v["@id"];if("@context"===x||"@preserve"===x)throw new t("Invalid JSON-LD syntax; @context and @preserve cannot be aliased.","jsonld.SyntaxError",{code:"invalid keyword alias",context:s});if(f&&f.protected&&!h&&(e.protected[a]=!0,v.protected=!0,!b(f,v)))throw new t("Invalid JSON-LD syntax; tried to redefine a protected term.","jsonld.SyntaxError",{code:"protected term redefinition",context:s,term:a})},g.expandIri=(e,t,n,r)=>m(e,t,n,void 0,void 0,r),g.getInitialContext=t=>{const n=JSON.stringify({processingMode:t.processingMode}),r=f.get(n);if(r)return r;const i={processingMode:t.processingMode,mappings:new Map,inverse:null,getInverse:function(){const e=this;if(e.inverse)return e.inverse;const t=e.inverse={},n=e.fastCurieMap={},r={},i=(e["@language"]||"@none").toLowerCase(),a=e["@direction"],l=e.mappings,c=[...l.keys()].sort(p);for(const e of c){const s=l.get(e);if(null===s)continue;let c=s["@container"]||"@none";if(c=[].concat(c).sort().join(""),null===s["@id"])continue;const u=h(s["@id"]);for(const l of u){let u=t[l];const d=g.isKeyword(l);if(u)!d&&!s._termHasColon&&r[l].push(e);else if(t[l]=u={},!d&&!s._termHasColon){r[l]=[e];const t={iri:l,terms:r[l]};l[0]in n?n[l[0]].push(t):n[l[0]]=[t]}if(u[c]||(u[c]={"@language":{},"@type":{},"@any":{}}),u=u[c],o(e,u["@any"],"@none"),s.reverse)o(e,u["@type"],"@reverse");else if("@none"===s["@type"])o(e,u["@any"],"@none"),o(e,u["@language"],"@none"),o(e,u["@type"],"@none");else if("@type"in s)o(e,u["@type"],s["@type"]);else if("@language"in s&&"@direction"in s){const t=s["@language"],n=s["@direction"];o(e,u["@language"],t&&n?`${t}_${n}`.toLowerCase():t?t.toLowerCase():n?`_${n}`:"@null")}else"@language"in s?o(e,u["@language"],(s["@language"]||"@null").toLowerCase()):"@direction"in s?s["@direction"]?o(e,u["@language"],`_${s["@direction"]}`):o(e,u["@language"],"@none"):a?(o(e,u["@language"],`_${a}`),o(e,u["@language"],"@none"),o(e,u["@type"],"@none")):(o(e,u["@language"],i),o(e,u["@language"],"@none"),o(e,u["@type"],"@none"))}}for(const e in n)s(n,e,1);return t},clone:function(){const t={};return t.mappings=e.clone(this.mappings),t.clone=this.clone,t.inverse=null,t.getInverse=this.getInverse,t.protected=e.clone(this.protected),this.previousContext&&(t.previousContext=this.previousContext.clone()),t.revertToPreviousContext=this.revertToPreviousContext,"@base"in this&&(t["@base"]=this["@base"]),"@language"in this&&(t["@language"]=this["@language"]),"@vocab"in this&&(t["@vocab"]=this["@vocab"]),t},revertToPreviousContext:function(){return this.previousContext?this.previousContext.clone():this},protected:{}};return 1e4===f.size&&f.clear(),f.set(n,i),i;function s(e,t,n){const r=e[t],i=e[t]={};let o,a;for(const e of r)o=e.iri,a=n>=o.length?"":o[n],a in i?i[a].push(e):i[a]=[e];for(const e in i)""!==e&&s(i,e,n+1)}function o(e,t,n){t.hasOwnProperty(n)||(t[n]=e)}},g.getContextValue=(e,t,n)=>{if(null===t)return"@context"===n?void 0:null;if(e.mappings.has(t)){const r=e.mappings.get(t);if(s(n))return r;if(r.hasOwnProperty(n))return r[n]}return"@language"===n&&n in e||"@direction"===n&&n in e?e[n]:"@context"!==n?null:void 0},g.processingMode=(e,t)=>t.toString()>="1.1"?!e.processingMode||e.processingMode>="json-ld-"+t.toString():"json-ld-1.0"===e.processingMode,g.isKeyword=e=>{if(!i(e)||"@"!==e[0])return!1;switch(e){case"@base":case"@container":case"@context":case"@default":case"@direction":case"@embed":case"@explicit":case"@graph":case"@id":case"@included":case"@index":case"@json":case"@language":case"@list":case"@nest":case"@none":case"@omitDefault":case"@prefix":case"@preserve":case"@protected":case"@requireAll":case"@reverse":case"@set":case"@type":case"@value":case"@version":case"@vocab":return!0}return!1},Ns}function Ff(){if(Jl)return Rs;Jl=1;const e=gt(),{isArray:t,isObject:n,isEmptyObject:r,isString:i,isUndefined:s}=ut(),{isList:o,isValue:a,isGraph:l,isSubject:c}=kt(),{expandIri:u,getContextValue:d,isKeyword:h,process:p,processingMode:f}=hr(),{isAbsolute:g}=Jt(),{REGEX_BCP47:m,REGEX_KEYWORD:b,addValue:y,asArray:v,getValues:w,validateTypeValue:_}=ht(),{handleEvent:x}=An(),S={};function E({value:e,count:t,options:n}){if(0===t||"@value"in e||"@list"in e||1===t&&"@id"in e){if(n.eventHandler){let r,i;0===t?(r="empty object",i="Dropping empty object."):"@value"in e?(r="object with only @value",i="Dropping object with only @value."):"@list"in e?(r="object with only @list",i="Dropping object with only @list."):1===t&&"@id"in e&&(r="object with only @id",i="Dropping object with only @id."),x({event:{type:["JsonLdEvent"],code:r,level:"warning",message:i,details:{value:e}},options:n})}return null}return e}async function I({activeCtx:l,activeProperty:b,expandedActiveProperty:w,element:j,expandedParent:k,options:R={},insideList:C,typeKey:A,typeScopedContext:O}){const L=Object.keys(j).sort(),$=[];let D;const P=j[A]&&"@json"===u(l,t(j[A])?j[A][0]:j[A],{vocab:!0},{...R,typeExpansion:!0});for(const I of L){let C,A=j[I];if("@context"===I)continue;const L=u(l,I,{vocab:!0},R);if(null===L||!g(L)&&!h(L)){R.eventHandler&&x({event:{type:["JsonLdEvent"],code:"invalid property",level:"warning",message:"Dropping property that did not expand into an absolute IRI or keyword.",details:{property:I,expandedProperty:L}},options:R});continue}if(h(L)){if("@reverse"===w)throw new e("Invalid JSON-LD syntax; a keyword cannot be used as a @reverse property.","jsonld.SyntaxError",{code:"invalid reverse property map",value:A});if(L in k&&"@included"!==L&&"@type"!==L)throw new e("Invalid JSON-LD syntax; colliding keywords detected.","jsonld.SyntaxError",{code:"colliding keywords",keyword:L})}if("@id"===L){if(!i(A)){if(!R.isFrame)throw new e('Invalid JSON-LD syntax; "@id" value must a string.',"jsonld.SyntaxError",{code:"invalid @id value",value:A});if(n(A)){if(!r(A))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:A})}else{if(!t(A))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:A});if(!A.every(e=>i(e)))throw new e('Invalid JSON-LD syntax; "@id" value an empty object or array of strings, if framing',"jsonld.SyntaxError",{code:"invalid @id value",value:A})}}y(k,"@id",v(A).map(e=>{if(i(e)){const t=u(l,e,{base:!0},R);return R.eventHandler&&(null===t?x(null===e?{event:{type:["JsonLdEvent"],code:"null @id value",level:"warning",message:"Null @id found.",details:{id:e}},options:R}:{event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:e}},options:R}):g(t)||x({event:{type:["JsonLdEvent"],code:"relative @id reference",level:"warning",message:"Relative @id reference found.",details:{id:e,expandedId:t}},options:R})),t}return e}),{propertyIsArray:R.isFrame});continue}if("@type"===L){n(A)&&(A=Object.fromEntries(Object.entries(A).map(([e,t])=>[u(O,e,{vocab:!0}),v(t).map(e=>u(O,e,{base:!0,vocab:!0},{...R,typeExpansion:!0}))]))),_(A,R.isFrame),y(k,"@type",v(A).map(e=>{if(i(e)){const t=u(O,e,{base:!0,vocab:!0},{...R,typeExpansion:!0});return"@json"!==t&&!g(t)&&R.eventHandler&&x({event:{type:["JsonLdEvent"],code:"relative @type reference",level:"warning",message:"Relative @type reference found.",details:{type:e}},options:R}),t}return e}),{propertyIsArray:!!R.isFrame});continue}if("@included"===L&&f(l,1.1)){const t=v(await S.expand({activeCtx:l,activeProperty:b,element:A,options:R}));if(!t.every(e=>c(e)))throw new e("Invalid JSON-LD syntax; values of @included must expand to node objects.","jsonld.SyntaxError",{code:"invalid @included value",value:A});y(k,"@included",t,{propertyIsArray:!0});continue}if("@graph"===L&&!n(A)&&!t(A))throw new e('Invalid JSON-LD syntax; "@graph" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid @graph value",value:A});if("@value"===L){D=A,P&&f(l,1.1)?k["@value"]=A:y(k,"@value",A,{propertyIsArray:R.isFrame});continue}if("@language"===L){if(null===A)continue;if(!i(A)&&!R.isFrame)throw new e('Invalid JSON-LD syntax; "@language" value must be a string.',"jsonld.SyntaxError",{code:"invalid language-tagged string",value:A});A=v(A).map(e=>i(e)?e.toLowerCase():e);for(const e of A)i(e)&&!e.match(m)&&R.eventHandler&&x({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:R});y(k,"@language",A,{propertyIsArray:R.isFrame});continue}if("@direction"===L){if(!i(A)&&!R.isFrame)throw new e('Invalid JSON-LD syntax; "@direction" value must be a string.',"jsonld.SyntaxError",{code:"invalid base direction",value:A});A=v(A);for(const t of A)if(i(t)&&"ltr"!==t&&"rtl"!==t)throw new e('Invalid JSON-LD syntax; "@direction" must be "ltr" or "rtl".',"jsonld.SyntaxError",{code:"invalid base direction",value:A});y(k,"@direction",A,{propertyIsArray:R.isFrame});continue}if("@index"===L){if(!i(A))throw new e('Invalid JSON-LD syntax; "@index" value must be a string.',"jsonld.SyntaxError",{code:"invalid @index value",value:A});y(k,"@index",A);continue}if("@reverse"===L){if(!n(A))throw new e('Invalid JSON-LD syntax; "@reverse" value must be an object.',"jsonld.SyntaxError",{code:"invalid @reverse value",value:A});if(C=await S.expand({activeCtx:l,activeProperty:"@reverse",element:A,options:R}),"@reverse"in C)for(const e in C["@reverse"])y(k,e,C["@reverse"][e],{propertyIsArray:!0});let t=k["@reverse"]||null;for(const n in C){if("@reverse"===n)continue;null===t&&(t=k["@reverse"]={}),y(t,n,[],{propertyIsArray:!0});const r=C[n];for(let i=0;i<r.length;++i){const s=r[i];if(a(s)||o(s))throw new e('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:C});y(t,n,s,{propertyIsArray:!0})}}continue}if("@nest"===L){$.push(I);continue}let M=l;const F=d(l,I,"@context");s(F)||(M=await p({activeCtx:l,localCtx:F,propagate:!0,overrideProtected:!0,options:R}));const B=d(l,I,"@container")||[];if(B.includes("@language")&&n(A))C=T(M,A,d(M,I,"@direction"),R);else if(B.includes("@index")&&n(A)){const e=B.includes("@graph"),t=d(M,I,"@index")||"@index",n="@index"!==t&&u(l,t,{vocab:!0},R);C=await N({activeCtx:M,options:R,activeProperty:I,value:A,asGraph:e,indexKey:t,propertyIndex:n})}else if(B.includes("@id")&&n(A)){const e=B.includes("@graph");C=await N({activeCtx:M,options:R,activeProperty:I,value:A,asGraph:e,indexKey:"@id"})}else if(B.includes("@type")&&n(A))C=await N({activeCtx:M.revertToPreviousContext(),options:R,activeProperty:I,value:A,asGraph:!1,indexKey:"@type"});else{const e="@list"===L;if(e||"@set"===L){let t=b;e&&"@graph"===w&&(t=null),C=await S.expand({activeCtx:M,activeProperty:t,element:A,options:R,insideList:e})}else C="@json"===d(l,I,"@type")?{"@type":"@json","@value":A}:await S.expand({activeCtx:M,activeProperty:I,element:A,options:R,insideList:!1})}if(null!==C||"@value"===L){if("@list"!==L&&!o(C)&&B.includes("@list")&&(C={"@list":v(C)}),B.includes("@graph")&&!B.some(e=>"@id"===e||"@index"===e)){if(C=v(C),R.isFrame||(C=C.filter(e=>null!==E({value:e,count:Object.keys(e).length,options:R}))),0===C.length)continue;C=C.map(e=>({"@graph":v(e)}))}if(M.mappings.has(I)&&M.mappings.get(I).reverse){const t=k["@reverse"]=k["@reverse"]||{};C=v(C);for(let n=0;n<C.length;++n){const r=C[n];if(a(r)||o(r))throw new e('Invalid JSON-LD syntax; "@reverse" value must not be a @value or an @list.',"jsonld.SyntaxError",{code:"invalid reverse property value",value:C});y(t,L,r,{propertyIsArray:!0})}continue}y(k,L,C,{propertyIsArray:!0})}}if("@value"in k&&("@json"!==k["@type"]||!f(l,1.1))&&(n(D)||t(D))&&!R.isFrame)throw new e('Invalid JSON-LD syntax; "@value" value must not be an object or an array.',"jsonld.SyntaxError",{code:"invalid value object value",value:D});for(const r of $){const i=t(j[r])?j[r]:[j[r]];for(const t of i){if(!n(t)||Object.keys(t).some(e=>"@value"===u(l,e,{vocab:!0},R)))throw new e("Invalid JSON-LD syntax; nested value must be a node object.","jsonld.SyntaxError",{code:"invalid @nest value",value:t});await I({activeCtx:l,activeProperty:b,expandedActiveProperty:w,element:t,expandedParent:k,options:R,insideList:C,typeScopedContext:O,typeKey:A})}}}function j({activeCtx:e,activeProperty:t,value:n,options:r}){if(null==n)return null;const s=u(e,t,{vocab:!0},r);if("@id"===s)return u(e,n,{base:!0},r);if("@type"===s)return u(e,n,{vocab:!0,base:!0},{...r,typeExpansion:!0});const o=d(e,t,"@type");if(("@id"===o||"@graph"===s)&&i(n)){const i=u(e,n,{base:!0},r);return null===i&&n.match(b)&&r.eventHandler&&x({event:{type:["JsonLdEvent"],code:"reserved @id value",level:"warning",message:"Reserved @id found.",details:{id:t}},options:r}),{"@id":i}}if("@vocab"===o&&i(n))return{"@id":u(e,n,{vocab:!0,base:!0},r)};if(h(s))return n;const a={};if(o&&!["@id","@vocab","@none"].includes(o))a["@type"]=o;else if(i(n)){const n=d(e,t,"@language");null!==n&&(a["@language"]=n);const r=d(e,t,"@direction");null!==r&&(a["@direction"]=r)}return["boolean","number","string"].includes(typeof n)||(n=n.toString()),a["@value"]=n,a}function T(n,r,s,o){const a=[],l=Object.keys(r).sort();for(const c of l){const l=u(n,c,{vocab:!0},o);let d=r[c];t(d)||(d=[d]);for(const t of d){if(null===t)continue;if(!i(t))throw new e("Invalid JSON-LD syntax; language map values must be strings.","jsonld.SyntaxError",{code:"invalid language map value",languageMap:r});const n={"@value":t};"@none"!==l&&(c.match(m)||o.eventHandler&&x({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:c}},options:o}),n["@language"]=c.toLowerCase()),s&&(n["@direction"]=s),a.push(n)}}return a}async function N({activeCtx:n,options:r,activeProperty:i,value:o,asGraph:c,indexKey:h,propertyIndex:f}){const g=[],m=Object.keys(o).sort(),b="@type"===h;for(let v of m){if(b){const e=d(n,v,"@context");s(e)||(n=await p({activeCtx:n,localCtx:e,propagate:!1,options:r}))}let m,w=o[v];t(w)||(w=[w]),w=await S.expand({activeCtx:n,activeProperty:i,element:w,options:r,insideList:!1,insideIndex:!0}),m=f?"@none"===v?"@none":j({activeCtx:n,activeProperty:h,value:v,options:r}):u(n,v,{vocab:!0},r),"@id"===h?v=u(n,v,{base:!0},r):b&&(v=m);for(let t of w){if(c&&!l(t)&&(t={"@graph":[t]}),"@type"===h)"@none"===m||(t["@type"]?t["@type"]=[v].concat(t["@type"]):t["@type"]=[v]);else{if(a(t)&&!["@language","@type","@index"].includes(h))throw new e(`Invalid JSON-LD syntax; Attempt to add illegal key to value object: "${h}".`,"jsonld.SyntaxError",{code:"invalid value object",value:t});f?"@none"!==m&&y(t,f,m,{propertyIsArray:!0,prependValue:!0}):"@none"!==m&&!(h in t)&&(t[h]=v)}g.push(t)}}return g}return Rs=S,S.expand=async({activeCtx:o,activeProperty:a=null,element:l,options:c={},insideList:h=!1,insideIndex:m=!1,typeScopedContext:b=null})=>{if(null==l)return null;if("@default"===a&&(c=Object.assign({},c,{isFrame:!1})),!t(l)&&!n(l))return h||null!==a&&"@graph"!==u(o,a,{vocab:!0},c)?j({activeCtx:o,activeProperty:a,value:l,options:c}):(c.eventHandler&&x({event:{type:["JsonLdEvent"],code:"free-floating scalar",level:"warning",message:"Dropping free-floating scalar not in a list.",details:{value:l}},options:c}),null);if(t(l)){let e=[];const n=d(o,a,"@container")||[];h=h||n.includes("@list");for(let n=0;n<l.length;++n){let r=await S.expand({activeCtx:o,activeProperty:a,element:l[n],options:c,insideIndex:m,typeScopedContext:b});h&&t(r)&&(r={"@list":r}),null!==r&&(t(r)?e=e.concat(r):e.push(r))}return e}const y=u(o,a,{vocab:!0},c),_=d(o,a,"@context");b=b||(o.previousContext?o:null);let T=Object.keys(l).sort(),N=!m;if(N&&b&&T.length<=2&&!T.includes("@context"))for(const e of T){const t=u(b,e,{vocab:!0},c);if("@value"===t){N=!1,o=b;break}if("@id"===t&&1===T.length){N=!1;break}}N&&(o=o.revertToPreviousContext()),s(_)||(o=await p({activeCtx:o,localCtx:_,propagate:!0,overrideProtected:!0,options:c})),"@context"in l&&(o=await p({activeCtx:o,localCtx:l["@context"],options:c})),b=o;let k=null;for(const e of T)if("@type"===u(o,e,{vocab:!0},c)){k=k||e;const t=l[e],n=Array.isArray(t)?t.length>1?t.slice().sort():t:[t];for(const e of n){const t=d(b,e,"@context");s(t)||(o=await p({activeCtx:o,localCtx:t,options:c,propagate:!1}))}}let R={};await I({activeCtx:o,activeProperty:a,expandedActiveProperty:y,element:l,expandedParent:R,options:c,insideList:h,typeKey:k,typeScopedContext:b}),T=Object.keys(R);let C=T.length;if("@value"in R){if("@type"in R&&("@language"in R||"@direction"in R))throw new e('Invalid JSON-LD syntax; an element containing "@value" may not contain both "@type" and either "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:R});let t=C-1;if("@type"in R&&(t-=1),"@index"in R&&(t-=1),"@language"in R&&(t-=1),"@direction"in R&&(t-=1),0!==t)throw new e('Invalid JSON-LD syntax; an element containing "@value" may only have an "@index" property and either "@type" or either or both "@language" or "@direction".',"jsonld.SyntaxError",{code:"invalid value object",element:R});const n=null===R["@value"]?[]:v(R["@value"]),s=w(R,"@type");if(!f(o,1.1)||!s.includes("@json")||1!==s.length)if(0===n.length)c.eventHandler&&x({event:{type:["JsonLdEvent"],code:"null @value value",level:"warning",message:"Dropping null @value value.",details:{value:R}},options:c}),R=null;else{if(!n.every(e=>i(e)||r(e))&&"@language"in R)throw new e("Invalid JSON-LD syntax; only strings may be language-tagged.","jsonld.SyntaxError",{code:"invalid language-tagged value",element:R});if(!s.every(e=>g(e)&&!(i(e)&&0===e.indexOf("_:"))||r(e)))throw new e('Invalid JSON-LD syntax; an element containing "@value" and "@type" must have an absolute IRI for the value of "@type".',"jsonld.SyntaxError",{code:"invalid typed value",element:R})}}else if("@type"in R&&!t(R["@type"]))R["@type"]=[R["@type"]];else if("@set"in R||"@list"in R){if(C>1&&(2!==C||!("@index"in R)))throw new e('Invalid JSON-LD syntax; if an element has the property "@set" or "@list", then it can have at most one other property that is "@index".',"jsonld.SyntaxError",{code:"invalid set or list object",element:R});"@set"in R&&(R=R["@set"],T=Object.keys(R),C=T.length)}else 1===C&&"@language"in R&&(c.eventHandler&&x({event:{type:["JsonLdEvent"],code:"object with only @language",level:"warning",message:"Dropping object with only @language.",details:{value:R}},options:c}),R=null);return n(R)&&!c.keepFreeFloatingNodes&&!h&&(null===a||"@graph"===y||(d(o,a,"@container")||[]).includes("@graph"))&&(R=E({value:R,count:C,options:c})),R},Rs}function gi(){if(Kl)return Ts;Kl=1;const{isKeyword:e}=hr(),t=kt(),n=ut(),r=ht(),i=gt(),s={};return Ts=s,s.createMergedNodeMap=(e,t)=>{const n=(t=t||{}).issuer||new r.IdentifierIssuer("_:b"),i={"@default":{}};return s.createNodeMap(e,i,"@default",n),s.mergeNodeMaps(i)},s.createNodeMap=(o,a,l,c,u,d)=>{if(n.isArray(o)){for(const e of o)s.createNodeMap(e,a,l,c,void 0,d);return}if(!n.isObject(o))return void(d&&d.push(o));if(t.isValue(o)){if("@type"in o){let e=o["@type"];0===e.indexOf("_:")&&(o["@type"]=e=c.getId(e))}return void(d&&d.push(o))}if(d&&t.isList(o)){const e=[];return s.createNodeMap(o["@list"],a,l,c,u,e),void d.push({"@list":e})}if("@type"in o){const e=o["@type"];for(const t of e)0===t.indexOf("_:")&&c.getId(t)}n.isUndefined(u)&&(u=t.isBlankNode(o)?c.getId(o["@id"]):o["@id"]),d&&d.push({"@id":u});const h=a[l],p=h[u]=h[u]||{};p["@id"]=u;const f=Object.keys(o).sort();for(let n of f){if("@id"===n)continue;if("@reverse"===n){const e={"@id":u},n=o["@reverse"];for(const i in n){const o=n[i];for(const n of o){let o=n["@id"];t.isBlankNode(n)&&(o=c.getId(o)),s.createNodeMap(n,a,l,c,o),r.addValue(h[o],i,e,{propertyIsArray:!0,allowDuplicate:!1})}}continue}if("@graph"===n){u in a||(a[u]={}),s.createNodeMap(o[n],a,u,c);continue}if("@included"===n){s.createNodeMap(o[n],a,l,c);continue}if("@type"!==n&&e(n)){if("@index"===n&&n in p&&(o[n]!==p[n]||o[n]["@id"]!==p[n]["@id"]))throw new i("Invalid JSON-LD syntax; conflicting @index property detected.","jsonld.SyntaxError",{code:"conflicting indexes",subject:p});p[n]=o[n];continue}const d=o[n];if(0===n.indexOf("_:")&&(n=c.getId(n)),0!==d.length)for(let e of d)if("@type"===n&&(e=0===e.indexOf("_:")?c.getId(e):e),t.isSubject(e)||t.isSubjectReference(e)){if("@id"in e&&!e["@id"])continue;const i=t.isBlankNode(e)?c.getId(e["@id"]):e["@id"];r.addValue(p,n,{"@id":i},{propertyIsArray:!0,allowDuplicate:!1}),s.createNodeMap(e,a,l,c,i)}else if(t.isValue(e))r.addValue(p,n,e,{propertyIsArray:!0,allowDuplicate:!1});else if(t.isList(e)){const t=[];s.createNodeMap(e["@list"],a,l,c,u,t),e={"@list":t},r.addValue(p,n,e,{propertyIsArray:!0,allowDuplicate:!1})}else s.createNodeMap(e,a,l,c,u),r.addValue(p,n,e,{propertyIsArray:!0,allowDuplicate:!1});else r.addValue(p,n,[],{propertyIsArray:!0})}},s.mergeNodeMapGraphs=t=>{const n={};for(const i of Object.keys(t).sort())for(const s of Object.keys(t[i]).sort()){const o=t[i][s];s in n||(n[s]={"@id":s});const a=n[s];for(const t of Object.keys(o).sort())if(e(t)&&"@type"!==t)a[t]=r.clone(o[t]);else for(const e of o[t])r.addValue(a,t,r.clone(e),{propertyIsArray:!0,allowDuplicate:!1})}return n},s.mergeNodeMaps=e=>{const n=e["@default"],r=Object.keys(e).sort();for(const i of r){if("@default"===i)continue;const r=e[i];let s=n[i];s?"@graph"in s||(s["@graph"]=[]):n[i]=s={"@id":i,"@graph":[]};const o=s["@graph"];for(const e of Object.keys(r).sort()){const n=r[e];t.isSubjectReference(n)||o.push(n)}}return n},Ts}function kf(){if(Yl)return As;Yl=1;const{isSubjectReference:e}=kt(),{createMergedNodeMap:t}=gi(),n={};return As=n,n.flatten=n=>{const r=t(n),i=[],s=Object.keys(r).sort();for(let t=0;t<s.length;++t){const n=r[s[t]];e(n)||i.push(n)}return i},As}function Pf(){if(Zl)return Ds;Zl=1;const e=gt(),t=kt(),n=ut(),{REGEX_BCP47:r,addValue:i}=ht(),{handleEvent:s}=An(),{RDF_LIST:o,RDF_FIRST:a,RDF_REST:l,RDF_NIL:c,RDF_TYPE:u,RDF_JSON_LITERAL:d,XSD_BOOLEAN:h,XSD_DOUBLE:p,XSD_INTEGER:f,XSD_STRING:g}=Ma(),m={};function b(t,i,o,a){if(t.termType.endsWith("Node"))return{"@id":t.value};const l={"@value":t.value};if(t.language)t.language.match(r)||a.eventHandler&&s({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:t.language}},options:a}),l["@language"]=t.language;else{let c=t.datatype.value;if(c||(c=g),c===d){c="@json";try{l["@value"]=JSON.parse(l["@value"])}catch(t){throw new e("JSON literal could not be parsed.","jsonld.InvalidJsonLiteral",{code:"invalid JSON literal",value:l["@value"],cause:t})}}if(i){if(c===h)"true"===l["@value"]?l["@value"]=!0:"false"===l["@value"]&&(l["@value"]=!1);else if(n.isNumeric(l["@value"]))if(c===f){const e=parseInt(l["@value"],10);e.toFixed(0)===l["@value"]&&(l["@value"]=e)}else c===p&&(l["@value"]=parseFloat(l["@value"]));[h,f,p,g].includes(c)||(l["@type"]=c)}else if("i18n-datatype"===o&&c.startsWith("https://www.w3.org/ns/i18n#")){const[,e,t]=c.split(/[#_]/);e.length>0&&(l["@language"]=e,e.match(r)||a.eventHandler&&s({event:{type:["JsonLdEvent"],code:"invalid @language value",level:"warning",message:"@language value must be valid BCP47.",details:{language:e}},options:a})),l["@direction"]=t}else c!==g&&(l["@type"]=c)}return l}return Ds=m,m.fromRDF=async(r,s)=>{const{useRdfType:d=!1,useNativeTypes:h=!1,rdfDirection:p=null}=s,f={},g={"@default":f},m={};if(p){if("compound-literal"===p)throw new e("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:p});if("i18n-datatype"!==p)throw new e("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:p})}for(const e of r){const t="DefaultGraph"===e.graph.termType?"@default":e.graph.value;t in g||(g[t]={}),"@default"!==t&&!(t in f)&&(f[t]={"@id":t});const n=g[t],r=e.subject.value,o=e.predicate.value,a=e.object;r in n||(n[r]={"@id":r});const l=n[r],y=a.termType.endsWith("Node");if(y&&!(a.value in n)&&(n[a.value]={"@id":a.value}),o===u&&!d&&y){i(l,"@type",a.value,{propertyIsArray:!0});continue}const v=b(a,h,p,s);if(i(l,o,v,{propertyIsArray:!0}),y)if(a.value===c){const e=n[a.value];"usages"in e||(e.usages=[]),e.usages.push({node:l,property:o,value:v})}else a.value in m?m[a.value]=!1:m[a.value]={node:l,property:o,value:v}}for(const e in g){const r=g[e];if(!(c in r))continue;const i=r[c];if(i.usages){for(let e of i.usages){let i=e.node,s=e.property,c=e.value;const u=[],d=[];let h=Object.keys(i).length;for(;s===l&&n.isObject(m[i["@id"]])&&n.isArray(i[a])&&1===i[a].length&&n.isArray(i[l])&&1===i[l].length&&(3===h||4===h&&n.isArray(i["@type"])&&1===i["@type"].length&&i["@type"][0]===o)&&(u.push(i[a][0]),d.push(i["@id"]),e=m[i["@id"]],i=e.node,s=e.property,c=e.value,h=Object.keys(i).length,t.isBlankNode(i)););delete c["@id"],c["@list"]=u.reverse();for(const e of d)delete r[e]}delete i.usages}}const y=[],v=Object.keys(f).sort();for(const e of v){const n=f[e];if(e in g){const r=n["@graph"]=[],i=g[e],s=Object.keys(i).sort();for(const e of s){const n=i[e];t.isSubjectReference(n)||r.push(n)}}t.isSubjectReference(n)||y.push(n)}return y},Ds}function Mf(){return eu||(eu=1,Ls=function e(t){return null===t||"object"!=typeof t||null!=t.toJSON?JSON.stringify(t):Array.isArray(t)?"["+t.reduce((t,n,r)=>t+(0===r?"":",")+e(void 0===n||"symbol"==typeof n?null:n),"")+"]":"{"+Object.keys(t).sort().reduce((n,r,i)=>void 0===t[r]||"symbol"==typeof t[r]?n:n+(0===n.length?"":",")+e(r)+":"+e(t[r]),"")+"}"}),Ls}function Bf(){if(tu)return Os;tu=1;const{createNodeMap:e}=gi(),{isKeyword:t}=hr(),n=kt(),r=Mf(),i=gt(),s=ut(),o=ht(),{handleEvent:a}=An(),{RDF_FIRST:l,RDF_REST:c,RDF_NIL:u,RDF_TYPE:d,RDF_JSON_LITERAL:h,RDF_LANGSTRING:p,XSD_BOOLEAN:f,XSD_DOUBLE:g,XSD_INTEGER:m,XSD_STRING:b}=Ma(),{isAbsolute:y}=Jt(),v={};function w(e,n,r,i,s){const o=Object.keys(n).sort();for(const l of o){const o=n[l],c=Object.keys(o).sort();for(let n of c){const c=o[n];if("@type"===n)n=d;else if(t(n))continue;for(const t of c){const o={termType:l.startsWith("_:")?"BlankNode":"NamedNode",value:l};if(!y(l)){s.eventHandler&&a({event:{type:["JsonLdEvent"],code:"relative subject reference",level:"warning",message:"Relative subject reference found.",details:{subject:l}},options:s});continue}const c={termType:n.startsWith("_:")?"BlankNode":"NamedNode",value:n};if(!y(n)){s.eventHandler&&a({event:{type:["JsonLdEvent"],code:"relative predicate reference",level:"warning",message:"Relative predicate reference found.",details:{predicate:n}},options:s});continue}if("BlankNode"===c.termType&&!s.produceGeneralizedRdf){s.eventHandler&&a({event:{type:["JsonLdEvent"],code:"blank node predicate",level:"warning",message:"Dropping blank node predicate.",details:{property:i.getOldIds().find(e=>i.getId(e)===n)}},options:s});continue}const u=_(t,i,e,r,s.rdfDirection,s);u&&e.push({subject:o,predicate:c,object:u,graph:r})}}}}function _(e,t,o,d,v,w){const x={};if(n.isValue(e)){x.termType="Literal",x.value=void 0,x.datatype={termType:"NamedNode"};let t=e["@value"];const n=e["@type"]||null;if("@json"===n)x.value=r(t),x.datatype.value=h;else if(s.isBoolean(t))x.value=t.toString(),x.datatype.value=n||f;else if(s.isDouble(t)||n===g)s.isDouble(t)||(t=parseFloat(t)),x.value=t.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),x.datatype.value=n||g;else if(s.isNumber(t))x.value=t.toFixed(0),x.datatype.value=n||m;else if("@direction"in e&&"i18n-datatype"===v){const n=`https://www.w3.org/ns/i18n#${(e["@language"]||"").toLowerCase()}_${e["@direction"]}`;x.datatype.value=n,x.value=t}else{if("@direction"in e&&"compound-literal"===v)throw new i("Unsupported rdfDirection value.","jsonld.InvalidRdfDirection",{value:v});if("@direction"in e&&v)throw new i("Unknown rdfDirection value.","jsonld.InvalidRdfDirection",{value:v});"@language"in e?("@direction"in e&&!v&&w.eventHandler&&a({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:x.value}},options:w}),x.value=t,x.datatype.value=n||p,x.language=e["@language"]):("@direction"in e&&!v&&w.eventHandler&&a({event:{type:["JsonLdEvent"],code:"rdfDirection not set",level:"warning",message:"rdfDirection not set for @direction.",details:{object:x.value}},options:w}),x.value=t,x.datatype.value=n||b)}}else if(n.isList(e)){const n=function(e,t,n,r,i,s){const o={termType:"NamedNode",value:l},a={termType:"NamedNode",value:c},d={termType:"NamedNode",value:u},h=e.pop(),p=h?{termType:"BlankNode",value:t.getId()}:d;let f=p;for(const l of e){const e=_(l,t,n,r,i,s),c={termType:"BlankNode",value:t.getId()};n.push({subject:f,predicate:o,object:e,graph:r}),n.push({subject:f,predicate:a,object:c,graph:r}),f=c}if(h){const e=_(h,t,n,r,i,s);n.push({subject:f,predicate:o,object:e,graph:r}),n.push({subject:f,predicate:a,object:d,graph:r})}return p}(e["@list"],t,o,d,v,w);x.termType=n.termType,x.value=n.value}else{const t=s.isObject(e)?e["@id"]:e;x.termType=t.startsWith("_:")?"BlankNode":"NamedNode",x.value=t}return"NamedNode"!==x.termType||y(x.value)?x:(w.eventHandler&&a({event:{type:["JsonLdEvent"],code:"relative object reference",level:"warning",message:"Relative object reference found.",details:{object:x.value}},options:w}),null)}return Os=v,v.toRDF=(t,n)=>{const r=new o.IdentifierIssuer("_:b"),i={"@default":{}};e(t,i,"@default",r);const s=[],l=Object.keys(i).sort();for(const e of l){let t;if("@default"===e)t={termType:"DefaultGraph",value:""};else{if(!y(e)){n.eventHandler&&a({event:{type:["JsonLdEvent"],code:"relative graph reference",level:"warning",message:"Relative graph reference found.",details:{graph:e}},options:n});continue}t=e.startsWith("_:")?{termType:"BlankNode"}:{termType:"NamedNode"},t.value=e}w(s,i[e],t,r,n)}return s},Os}function qf(){if(ru)return Cs;ru=1;const{isKeyword:e}=hr(),t=kt(),n=ut(),r=ht(),i=Jt(),s=gt(),{createNodeMap:o,mergeNodeMapGraphs:a}=gi(),l={};function c(e){const t={};for(const n in e)void 0!==e[n]&&(t["@"+n]=[e[n]]);return[t]}function u(e,t,n){for(let r=n.length-1;r>=0;--r){const i=n[r];if(i.graph===t&&i.subject["@id"]===e["@id"])return!0}return!1}function d(e,t,n){const r="@"+n;let i=r in e?e[r][0]:t[n];if("embed"===n)if(!0===i)i="@once";else if(!1===i)i="@never";else if("@always"!==i&&"@never"!==i&&"@link"!==i&&"@first"!==i&&"@last"!==i&&"@once"!==i)throw new s("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:e});return i}function h(e){if(!n.isArray(e)||1!==e.length||!n.isObject(e[0]))throw new s("Invalid JSON-LD syntax; a JSON-LD frame must be a single object.","jsonld.SyntaxError",{frame:e});if("@id"in e[0])for(const t of r.asArray(e[0]["@id"]))if(!n.isObject(t)&&!i.isAbsolute(t)||n.isString(t)&&0===t.indexOf("_:"))throw new s("Invalid JSON-LD syntax; invalid @id in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e});if("@type"in e[0])for(const t of r.asArray(e[0]["@type"]))if(!n.isObject(t)&&!i.isAbsolute(t)&&"@json"!==t||n.isString(t)&&0===t.indexOf("_:"))throw new s("Invalid JSON-LD syntax; invalid @type in frame.","jsonld.SyntaxError",{code:"invalid frame",frame:e})}function p(i,s,o,a){let l=!0,c=!1;for(const u in o){let d=!1;const p=r.getValues(s,u),f=0===r.getValues(o,u).length;if("@id"===u){if(n.isEmptyObject(o["@id"][0]||{})?d=!0:o["@id"].length>=0&&(d=o["@id"].includes(p[0])),!a.requireAll)return d}else if("@type"===u){if(l=!1,f){if(p.length>0)return!1;d=!0}else if(1===o["@type"].length&&n.isEmptyObject(o["@type"][0]))d=p.length>0;else for(const e of o["@type"])d=!(!n.isObject(e)||!("@default"in e))||d||p.some(t=>t===e);if(!a.requireAll)return d}else{if(e(u))continue;{const e=r.getValues(o,u)[0];let s=!1;if(e&&(h([e]),s="@default"in e),l=!1,0===p.length&&s)continue;if(p.length>0&&f)return!1;if(void 0===e){if(p.length>0)return!1;d=!0}else if(t.isList(e)){const n=e["@list"][0];if(t.isList(p[0])){const e=p[0]["@list"];t.isValue(n)?d=e.some(e=>y(n,e)):(t.isSubject(n)||t.isSubjectReference(n))&&(d=e.some(e=>b(i,n,e,a)))}}else d=t.isValue(e)?p.some(t=>y(e,t)):t.isSubjectReference(e)?p.some(t=>b(i,e,t,a)):!!n.isObject(e)&&p.length>0}}if(!d&&a.requireAll)return!1;c=c||d}return l||c}function f(e,t){const i=e.uniqueEmbeds[e.graph],s=i[t],o=s.parent,a=s.property,l={"@id":t};if(n.isArray(o)){for(let e=0;e<o.length;++e)if(r.compareValues(o[e],l)){o[e]=l;break}}else{const e=n.isArray(o[a]);r.removeValue(o,a,l,{propertyIsArray:e}),r.addValue(o,a,l,{propertyIsArray:e})}const c=e=>{const t=Object.keys(i);for(const r of t)r in i&&n.isObject(i[r].parent)&&i[r].parent["@id"]===e&&(delete i[r],c(r))};c(t)}function g(e,r){if(n.isArray(e))return e.map(e=>g(e,r));if(n.isObject(e)){if("@preserve"in e)return e["@preserve"][0];if(t.isValue(e))return e;if(t.isList(e))return e["@list"]=g(e["@list"],r),e;if("@id"in e){const t=e["@id"];if(r.link.hasOwnProperty(t)){const n=r.link[t].indexOf(e);if(-1!==n)return r.link[t][n];r.link[t].push(e)}else r.link[t]=[e]}for(const t in e)"@id"===t&&r.bnodesToClear.includes(e[t])?delete e["@id"]:e[t]=g(e[t],r)}return e}function m(e,t,i){n.isObject(e)?r.addValue(e,t,i,{propertyIsArray:!0}):e.push(i)}function b(e,t,n,r){if(!("@id"in n))return!1;const i=e.subjects[n["@id"]];return i&&p(e,i,t,r)}function y(e,t){const r=t["@value"],i=t["@type"],s=t["@language"],o=e["@value"]?n.isArray(e["@value"])?e["@value"]:[e["@value"]]:[],a=e["@type"]?n.isArray(e["@type"])?e["@type"]:[e["@type"]]:[],l=e["@language"]?n.isArray(e["@language"])?e["@language"]:[e["@language"]]:[];return 0===o.length&&0===a.length&&0===l.length||!(!o.includes(r)&&!n.isEmptyObject(o[0])||!(!i&&0===a.length||a.includes(i)||i&&n.isEmptyObject(a[0]))||!(!s&&0===l.length||l.includes(s)||s&&n.isEmptyObject(l[0])))}return Cs=l,l.frameMergedOrDefault=(e,t,n)=>{const i={options:n,embedded:!1,graph:"@default",graphMap:{"@default":{}},subjectStack:[],link:{},bnodeMap:{}},s=new r.IdentifierIssuer("_:b");o(e,i.graphMap,"@default",s),n.merged&&(i.graphMap["@merged"]=a(i.graphMap),i.graph="@merged"),i.subjects=i.graphMap[i.graph];const c=[];return l.frame(i,Object.keys(i.subjects).sort(),t,c),n.pruneBlankNodeIdentifiers&&(n.bnodesToClear=Object.keys(i.bnodeMap).filter(e=>1===i.bnodeMap[e].length)),n.link={},g(c,n)},l.frame=(i,o,a,g,b=null)=>{h(a),a=a[0];const v=i.options,w={embed:d(a,v,"embed"),explicit:d(a,v,"explicit"),requireAll:d(a,v,"requireAll")};i.link.hasOwnProperty(i.graph)||(i.link[i.graph]={});const _=i.link[i.graph],x=function(e,t,n,r){const i={};for(const s of t){const t=e.graphMap[e.graph][s];p(e,t,n,r)&&(i[s]=t)}return i}(i,o,a,w),S=Object.keys(x).sort();for(const h of S){const p=x[h];if(null===b?i.uniqueEmbeds={[i.graph]:{}}:i.uniqueEmbeds[i.graph]=i.uniqueEmbeds[i.graph]||{},"@link"===w.embed&&h in _){m(g,b,_[h]);continue}const S={"@id":h};if(0===h.indexOf("_:")&&r.addValue(i.bnodeMap,h,S,{propertyIsArray:!0}),_[h]=S,("@first"===w.embed||"@last"===w.embed)&&i.is11)throw new s("Invalid JSON-LD syntax; invalid value of @embed.","jsonld.SyntaxError",{code:"invalid @embed value",frame:a});if(i.embedded||!i.uniqueEmbeds[i.graph].hasOwnProperty(h)){if(i.embedded&&("@never"===w.embed||u(p,i.graph,i.subjectStack))){m(g,b,S);continue}if(i.embedded&&("@first"==w.embed||"@once"==w.embed)&&i.uniqueEmbeds[i.graph].hasOwnProperty(h)){m(g,b,S);continue}if("@last"===w.embed&&h in i.uniqueEmbeds[i.graph]&&f(i,h),i.uniqueEmbeds[i.graph][h]={parent:g,property:b},i.subjectStack.push({subject:p,graph:i.graph}),h in i.graphMap){let e=!1,t=null;"@graph"in a?(t=a["@graph"][0],e=!("@merged"===h||"@default"===h),n.isObject(t)||(t={})):(e="@merged"!==i.graph,t={}),e&&l.frame({...i,graph:h,embedded:!1},Object.keys(i.graphMap[h]).sort(),[t],S,"@graph")}"@included"in a&&l.frame({...i,embedded:!1},o,a["@included"],S,"@included");for(const n of Object.keys(p).sort())if(e(n)){if(S[n]=r.clone(p[n]),"@type"===n)for(const e of p["@type"])0===e.indexOf("_:")&&r.addValue(i.bnodeMap,e,S,{propertyIsArray:!0})}else if(!w.explicit||n in a)for(const e of p[n]){const s=n in a?a[n]:c(w);if(t.isList(e)){const s=a[n]&&a[n][0]&&a[n][0]["@list"]?a[n][0]["@list"]:c(w),o={"@list":[]};m(S,n,o);const u=e["@list"];for(const e of u)t.isSubjectReference(e)?l.frame({...i,embedded:!0},[e["@id"]],s,o,"@list"):m(o,"@list",r.clone(e))}else t.isSubjectReference(e)?l.frame({...i,embedded:!0},[e["@id"]],s,S,n):y(s[0],e)&&m(S,n,r.clone(e))}for(const t of Object.keys(a).sort()){if("@type"===t){if(!n.isObject(a[t][0])||!("@default"in a[t][0]))continue}else if(e(t))continue;const i=a[t][0]||{};if(!d(i,v,"omitDefault")&&!(t in S)){let e="@null";"@default"in i&&(e=r.clone(i["@default"])),n.isArray(e)||(e=[e]),S[t]=[{"@preserve":e}]}}for(const e of Object.keys(a["@reverse"]||{}).sort()){const t=a["@reverse"][e];for(const n of Object.keys(i.subjects))r.getValues(i.subjects[n],e).some(e=>e["@id"]===h)&&(S["@reverse"]=S["@reverse"]||{},r.addValue(S["@reverse"],e,[],{propertyIsArray:!0}),l.frame({...i,embedded:!0},[n],t,S["@reverse"][e],b))}m(g,b,S),i.subjectStack.pop()}}},l.cleanupNull=(e,t)=>{if(n.isArray(e))return e.map(e=>l.cleanupNull(e,t)).filter(e=>e);if("@null"===e)return null;if(n.isObject(e)){if("@id"in e){const n=e["@id"];if(t.link.hasOwnProperty(n)){const r=t.link[n].indexOf(e);if(-1!==r)return t.link[n][r];t.link[n].push(e)}else t.link[n]=[e]}for(const n in e)e[n]=l.cleanupNull(e[n],t)}return e},Cs}function Uf(){if(nu)return js;nu=1;const e=gt(),{isArray:t,isObject:n,isString:r,isUndefined:i}=ut(),{isList:s,isValue:o,isGraph:a,isSimpleGraph:l,isSubjectReference:c}=kt(),{expandIri:u,getContextValue:d,isKeyword:h,process:p,processingMode:f}=hr(),{removeBase:g,prependBase:m}=Jt(),{REGEX_KEYWORD:b,addValue:y,asArray:v,compareShortestLeast:w}=ht(),_={};function x(t,n,r){if("@nest"!==u(t,n,{vocab:!0},r))throw new e("JSON-LD compact error; nested property must have an @nest value resolving to @nest.","jsonld.SyntaxError",{code:"invalid @nest value"})}return js=_,_.compact=async({activeCtx:u,activeProperty:g=null,element:m,options:b={}})=>{if(t(m)){let e=[];for(let t=0;t<m.length;++t){const n=await _.compact({activeCtx:u,activeProperty:g,element:m[t],options:b});null!==n&&e.push(n)}return b.compactArrays&&1===e.length&&0===(d(u,g,"@container")||[]).length&&(e=e[0]),e}const w=d(u,g,"@context");if(i(w)||(u=await p({activeCtx:u,localCtx:w,propagate:!0,overrideProtected:!0,options:b})),n(m)){if(b.link&&"@id"in m&&b.link.hasOwnProperty(m["@id"])){const e=b.link[m["@id"]];for(let t=0;t<e.length;++t)if(e[t].expanded===m)return e[t].compacted}if(o(m)||c(m)){const e=_.compactValue({activeCtx:u,activeProperty:g,value:m,options:b});return b.link&&c(m)&&(b.link.hasOwnProperty(m["@id"])||(b.link[m["@id"]]=[]),b.link[m["@id"]].push({expanded:m,compacted:e})),e}if(s(m)&&(d(u,g,"@container")||[]).includes("@list"))return _.compact({activeCtx:u,activeProperty:g,element:m["@list"],options:b});const w="@reverse"===g,S={},E=u;!o(m)&&!c(m)&&(u=u.revertToPreviousContext());const I=d(E,g,"@context");i(I)||(u=await p({activeCtx:u,localCtx:I,propagate:!0,overrideProtected:!0,options:b})),b.link&&"@id"in m&&(b.link.hasOwnProperty(m["@id"])||(b.link[m["@id"]]=[]),b.link[m["@id"]].push({expanded:m,compacted:S}));let j=m["@type"]||[];j.length>1&&(j=Array.from(j).sort());const T=u;for(const e of j){const t=_.compactIri({activeCtx:T,iri:e,relativeTo:{vocab:!0}}),n=d(E,t,"@context");i(n)||(u=await p({activeCtx:u,localCtx:n,options:b,propagate:!1}))}const N=Object.keys(m).sort();for(const i of N){const c=m[i];if("@id"===i){let e=v(c).map(e=>_.compactIri({activeCtx:u,iri:e,relativeTo:{vocab:!1},base:b.base}));1===e.length&&(e=e[0]),S[_.compactIri({activeCtx:u,iri:"@id",relativeTo:{vocab:!0}})]=e;continue}if("@type"===i){let e=v(c).map(e=>_.compactIri({activeCtx:E,iri:e,relativeTo:{vocab:!0}}));1===e.length&&(e=e[0]);const n=_.compactIri({activeCtx:u,iri:"@type",relativeTo:{vocab:!0}}),r=(d(u,n,"@container")||[]).includes("@set")&&f(u,1.1)||t(e)&&0===c.length;y(S,n,e,{propertyIsArray:r});continue}if("@reverse"===i){const e=await _.compact({activeCtx:u,activeProperty:"@reverse",element:c,options:b});for(const t in e)if(u.mappings.has(t)&&u.mappings.get(t).reverse){const n=e[t],r=(d(u,t,"@container")||[]).includes("@set")||!b.compactArrays;y(S,t,n,{propertyIsArray:r}),delete e[t]}if(Object.keys(e).length>0){const t=_.compactIri({activeCtx:u,iri:i,relativeTo:{vocab:!0}});y(S,t,e)}continue}if("@preserve"===i){const e=await _.compact({activeCtx:u,activeProperty:g,element:c,options:b});t(e)&&0===e.length||y(S,i,e);continue}if("@index"===i){if((d(u,g,"@container")||[]).includes("@index"))continue;const e=_.compactIri({activeCtx:u,iri:i,relativeTo:{vocab:!0}});y(S,e,c);continue}if("@graph"!==i&&"@list"!==i&&"@included"!==i&&h(i)){const e=_.compactIri({activeCtx:u,iri:i,relativeTo:{vocab:!0}});y(S,e,c);continue}if(!t(c))throw new e("JSON-LD expansion error; expanded value must be an array.","jsonld.SyntaxError");if(0===c.length){const e=_.compactIri({activeCtx:u,iri:i,value:c,relativeTo:{vocab:!0},reverse:w}),t=u.mappings.has(e)?u.mappings.get(e)["@nest"]:null;let r=S;t&&(x(u,t,b),n(S[t])||(S[t]={}),r=S[t]),y(r,e,c,{propertyIsArray:!0})}for(const e of c){const c=_.compactIri({activeCtx:u,iri:i,value:e,relativeTo:{vocab:!0},reverse:w}),h=u.mappings.has(c)?u.mappings.get(c)["@nest"]:null;let p=S;h&&(x(u,h,b),n(S[h])||(S[h]={}),p=S[h]);const f=d(u,c,"@container")||[],g=a(e),m=s(e);let E;m?E=e["@list"]:g&&(E=e["@graph"]);let I=await _.compact({activeCtx:u,activeProperty:c,element:m||g?E:e,options:b});if(m){if(t(I)||(I=[I]),f.includes("@list")){y(p,c,I,{valueIsArray:!0,allowDuplicate:!0});continue}I={[_.compactIri({activeCtx:u,iri:"@list",relativeTo:{vocab:!0}})]:I},"@index"in e&&(I[_.compactIri({activeCtx:u,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"])}if(g)if(f.includes("@graph")&&(f.includes("@id")||f.includes("@index")&&l(e))){let t;p.hasOwnProperty(c)?t=p[c]:p[c]=t={};const n=(f.includes("@id")?e["@id"]:e["@index"])||_.compactIri({activeCtx:u,iri:"@none",relativeTo:{vocab:!0}});y(t,n,I,{propertyIsArray:!b.compactArrays||f.includes("@set")})}else f.includes("@graph")&&l(e)?(t(I)&&I.length>1&&(I={"@included":I}),y(p,c,I,{propertyIsArray:!b.compactArrays||f.includes("@set")})):(t(I)&&1===I.length&&b.compactArrays&&(I=I[0]),I={[_.compactIri({activeCtx:u,iri:"@graph",relativeTo:{vocab:!0}})]:I},"@id"in e&&(I[_.compactIri({activeCtx:u,iri:"@id",relativeTo:{vocab:!0}})]=e["@id"]),"@index"in e&&(I[_.compactIri({activeCtx:u,iri:"@index",relativeTo:{vocab:!0}})]=e["@index"]),y(p,c,I,{propertyIsArray:!b.compactArrays||f.includes("@set")}));else if(f.includes("@language")||f.includes("@index")||f.includes("@id")||f.includes("@type")){let t,n;if(p.hasOwnProperty(c)?t=p[c]:p[c]=t={},f.includes("@language"))o(I)&&(I=I["@value"]),n=e["@language"];else if(f.includes("@index")){const t=d(u,c,"@index")||"@index",i=_.compactIri({activeCtx:u,iri:t,relativeTo:{vocab:!0}});if("@index"===t)n=e["@index"],delete I[i];else{let e;if([n,...e]=v(I[t]||[]),r(n))switch(e.length){case 0:delete I[t];break;case 1:I[t]=e[0];break;default:I[t]=e}else n=null}}else if(f.includes("@id")){const e=_.compactIri({activeCtx:u,iri:"@id",relativeTo:{vocab:!0}});n=I[e],delete I[e]}else if(f.includes("@type")){const t=_.compactIri({activeCtx:u,iri:"@type",relativeTo:{vocab:!0}});let r;switch([n,...r]=v(I[t]||[]),r.length){case 0:delete I[t];break;case 1:I[t]=r[0];break;default:I[t]=r}1===Object.keys(I).length&&"@id"in e&&(I=await _.compact({activeCtx:u,activeProperty:c,element:{"@id":e["@id"]},options:b}))}n||(n=_.compactIri({activeCtx:u,iri:"@none",relativeTo:{vocab:!0}})),y(t,n,I,{propertyIsArray:f.includes("@set")})}else{const e=!b.compactArrays||f.includes("@set")||f.includes("@list")||t(I)&&0===I.length||"@list"===i||"@graph"===i;y(p,c,I,{propertyIsArray:e})}}}return S}return m},_.compactIri=({activeCtx:t,iri:r,value:i=null,relativeTo:l={vocab:!1},reverse:c=!1,base:u=null})=>{if(null===r)return r;t.isPropertyTermScoped&&t.previousContext&&(t=t.previousContext);const d=t.getInverse();if(h(r)&&r in d&&"@none"in d[r]&&"@type"in d[r]["@none"]&&"@none"in d[r]["@none"]["@type"])return d[r]["@none"]["@type"]["@none"];if(l.vocab&&r in d){const e=t["@language"]||"@none",l=[];n(i)&&"@index"in i&&!("@graph"in i)&&l.push("@index","@index@set"),n(i)&&"@preserve"in i&&(i=i["@preserve"][0]),a(i)?("@index"in i&&l.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i&&l.push("@graph@id","@graph@id@set"),l.push("@graph","@graph@set","@set"),"@index"in i||l.push("@graph@index","@graph@index@set","@index","@index@set"),"@id"in i||l.push("@graph@id","@graph@id@set")):n(i)&&!o(i)&&l.push("@id","@id@set","@type","@set@type");let u="@language",d="@null";if(c)u="@type",d="@reverse",l.push("@set");else if(s(i)){"@index"in i||l.push("@list");const t=i["@list"];if(0===t.length)u="@any",d="@none";else{let n=0===t.length?e:null,r=null;for(let e=0;e<t.length;++e){const i=t[e];let s="@none",a="@none";if(o(i)?"@direction"in i?s=`${(i["@language"]||"").toLowerCase()}_${i["@direction"]}`:"@language"in i?s=i["@language"].toLowerCase():"@type"in i?a=i["@type"]:s="@null":a="@id",null===n?n=s:s!==n&&o(i)&&(n="@none"),null===r?r=a:a!==r&&(r="@none"),"@none"===n&&"@none"===r)break}n=n||"@none",r=r||"@none","@none"!==r?(u="@type",d=r):d=n}}else{if(o(i))if("@language"in i&&!("@index"in i)){l.push("@language","@language@set"),d=i["@language"];const e=i["@direction"];e&&(d=`${d}_${e}`)}else"@direction"in i&&!("@index"in i)?d=`_${i["@direction"]}`:"@type"in i&&(u="@type",d=i["@type"]);else u="@type",d="@id";l.push("@set")}l.push("@none"),n(i)&&!("@index"in i)&&l.push("@index","@index@set"),o(i)&&1===Object.keys(i).length&&l.push("@language","@language@set");const h=function(e,t,r,i,s,o){null===o&&(o="@null");const a=[];if(("@id"===o||"@reverse"===o)&&n(r)&&"@id"in r){"@reverse"===o&&a.push("@reverse");const t=_.compactIri({activeCtx:e,iri:r["@id"],relativeTo:{vocab:!0}});e.mappings.has(t)&&e.mappings.get(t)&&e.mappings.get(t)["@id"]===r["@id"]?a.push.apply(a,["@vocab","@id"]):a.push.apply(a,["@id","@vocab"])}else{a.push(o);const e=a.find(e=>e.includes("_"));e&&a.push(e.replace(/^[^_]+_/,"_"))}a.push("@none");const l=e.inverse[t];for(const e of i){if(!(e in l))continue;const t=l[e][s];for(const e of a)if(e in t)return t[e]}return null}(t,r,i,l,u,d);if(null!==h)return h}if(l.vocab&&"@vocab"in t){const e=t["@vocab"];if(0===r.indexOf(e)&&r!==e){const n=r.substr(e.length);if(!t.mappings.has(n))return n}}let p=null;const f=[];let y=t.fastCurieMap;const v=r.length-1;for(let e=0;e<v&&r[e]in y;++e)y=y[r[e]],""in y&&f.push(y[""][0]);for(let e=f.length-1;e>=0;--e){const n=f[e],s=n.terms;for(const e of s){const s=e+":"+r.substr(n.iri.length);t.mappings.get(e)._prefix&&(!t.mappings.has(s)||null===i&&t.mappings.get(s)["@id"]===r)&&(null===p||w(s,p)<0)&&(p=s)}}if(null!==p)return p;for(const[n,i]of t.mappings)if(i&&i._prefix&&r.startsWith(n+":"))throw new e(`Absolute IRI "${r}" confused with prefix "${n}".`,"jsonld.SyntaxError",{code:"IRI confused with prefix",context:t});if(!l.vocab){if("@base"in t){if(t["@base"]){const e=g(m(u,t["@base"]),r);return b.test(e)?`./${e}`:e}return r}return g(u,r)}return r},_.compactValue=({activeCtx:e,activeProperty:t,value:n,options:i})=>{if(o(n)){const i=d(e,t,"@type"),s=d(e,t,"@language"),o=d(e,t,"@direction"),a=d(e,t,"@container")||[],l="@index"in n&&!a.includes("@index");if(!l&&"@none"!==i&&(n["@type"]===i||"@language"in n&&n["@language"]===s&&"@direction"in n&&n["@direction"]===o||"@language"in n&&n["@language"]===s||"@direction"in n&&n["@direction"]===o))return n["@value"];const c=Object.keys(n).length,u=1===c||2===c&&"@index"in n&&!l,h="@language"in e,p=r(n["@value"]),f=e.mappings.has(t)&&null===e.mappings.get(t)["@language"];if(u&&"@none"!==i&&(!h||!p||f))return n["@value"];const g={};return l&&(g[_.compactIri({activeCtx:e,iri:"@index",relativeTo:{vocab:!0}})]=n["@index"]),"@type"in n?g[_.compactIri({activeCtx:e,iri:"@type",relativeTo:{vocab:!0}})]=_.compactIri({activeCtx:e,iri:n["@type"],relativeTo:{vocab:!0}}):"@language"in n&&(g[_.compactIri({activeCtx:e,iri:"@language",relativeTo:{vocab:!0}})]=n["@language"]),"@direction"in n&&(g[_.compactIri({activeCtx:e,iri:"@direction",relativeTo:{vocab:!0}})]=n["@direction"]),g[_.compactIri({activeCtx:e,iri:"@value",relativeTo:{vocab:!0}})]=n["@value"],g}const s=u(e,t,{vocab:!0},i),a=d(e,t,"@type"),l=_.compactIri({activeCtx:e,iri:n["@id"],relativeTo:{vocab:"@vocab"===a},base:i.base});return"@id"===a||"@vocab"===a||"@graph"===s?l:{[_.compactIri({activeCtx:e,iri:"@id",relativeTo:{vocab:!0}})]:l}},js}function Hf(){return iu||(iu=1,$s=e=>{class t{toString(){return"[object JsonLdProcessor]"}}return Object.defineProperty(t,"prototype",{writable:!1,enumerable:!1}),Object.defineProperty(t.prototype,"constructor",{writable:!0,enumerable:!1,configurable:!0,value:t}),t.compact=function(t,n){return arguments.length<2?Promise.reject(new TypeError("Could not compact, too few arguments.")):e.compact(t,n)},t.expand=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not expand, too few arguments.")):e.expand(t)},t.flatten=function(t){return arguments.length<1?Promise.reject(new TypeError("Could not flatten, too few arguments.")):e.flatten(t)},t}),$s}function Vf(){if(su)return Fs;su=1;const e=Pa(),t=Df(),n=ht(),r=jf(),i=n.IdentifierIssuer,s=gt(),o=Uc(),a=$f(),{expand:l}=Ff(),{flatten:c}=kf(),{fromRDF:u}=Pf(),{toRDF:d}=Bf(),{frameMergedOrDefault:h,cleanupNull:p}=qf(),{isArray:f,isObject:g,isString:m}=ut(),{isSubjectReference:b}=kt(),{expandIri:y,getInitialContext:v,process:w,processingMode:_}=hr(),{compact:x,compactIri:S}=Uf(),{createNodeMap:E,createMergedNodeMap:I,mergeNodeMaps:j}=gi(),{logEventHandler:T,logWarningEventHandler:N,safeEventHandler:k,setDefaultEventHandler:R,setupEventHandler:C,strictEventHandler:A,unhandledEventHandler:O}=An(),L=function(L){const $={},D=new o({max:100});function P(e,{documentLoader:t=L.documentLoader,...n}){if(e&&"compactionMap"in e)throw new s('"compactionMap" not supported.',"jsonld.OptionsError");if(e&&"expansionMap"in e)throw new s('"expansionMap" not supported.',"jsonld.OptionsError");return Object.assign({},{documentLoader:t},n,e,{eventHandler:C({options:e})})}return L.compact=async function(e,t,o){if(arguments.length<2)throw new TypeError("Could not compact, too few arguments.");if(null===t)throw new s("The compaction context must not be null.","jsonld.CompactError",{code:"invalid local context"});if(null===e)return null;let a;(o=P(o,{base:m(e)?e:"",compactArrays:!0,compactToRelative:!0,graph:!1,skipExpansion:!1,link:!1,issuer:new i("_:b"),contextResolver:new r({sharedCache:D})})).link&&(o.skipExpansion=!0),o.compactToRelative||delete o.base,a=o.skipExpansion?e:await L.expand(e,o);const l=await L.processContext(v(o),t,o);let c=await x({activeCtx:l,element:a,options:o});o.compactArrays&&!o.graph&&f(c)?1===c.length?c=c[0]:0===c.length&&(c={}):o.graph&&g(c)&&(c=[c]),g(t)&&"@context"in t&&(t=t["@context"]),t=n.clone(t),f(t)||(t=[t]);const u=t;t=[];for(let e=0;e<u.length;++e)(!g(u[e])||Object.keys(u[e]).length>0)&&t.push(u[e]);const d=t.length>0;if(1===t.length&&(t=t[0]),f(c)){const e=S({activeCtx:l,iri:"@graph",relativeTo:{vocab:!0}}),n=c;c={},d&&(c["@context"]=t),c[e]=n}else if(g(c)&&d){const e=c;c={"@context":t};for(const t in e)c[t]=e[t]}return c},L.expand=async function(e,t){if(arguments.length<1)throw new TypeError("Could not expand, too few arguments.");const i={},s=[];if("expandContext"in(t=P(t,{keepFreeFloatingNodes:!1,contextResolver:new r({sharedCache:D})}))){const e=n.clone(t.expandContext);g(e)&&"@context"in e?i.expandContext=e:i.expandContext={"@context":e},s.push(i.expandContext)}let o;if(m(e)){const n=await L.get(e,t);o=n.documentUrl,i.input=n.document,n.contextUrl&&(i.remoteContext={"@context":n.contextUrl},s.push(i.remoteContext))}else i.input=n.clone(e);"base"in t||(t.base=o||"");let a=v(t);for(const e of s)a=await w({activeCtx:a,localCtx:e,options:t});let c=await l({activeCtx:a,element:i.input,options:t});return g(c)&&"@graph"in c&&1===Object.keys(c).length?c=c["@graph"]:null===c&&(c=[]),f(c)||(c=[c]),c},L.flatten=async function(e,t,n){if(arguments.length<1)return new TypeError("Could not flatten, too few arguments.");t="function"==typeof t?null:t||null,n=P(n,{base:m(e)?e:"",contextResolver:new r({sharedCache:D})});const i=await L.expand(e,n),s=c(i);return null===t?s:(n.graph=!0,n.skipExpansion=!0,await L.compact(s,t,n))},L.frame=async function(e,t,n){if(arguments.length<2)throw new TypeError("Could not frame, too few arguments.");if(n=P(n,{base:m(e)?e:"",embed:"@once",explicit:!1,requireAll:!1,omitDefault:!1,bnodesToClear:[],contextResolver:new r({sharedCache:D})}),m(t)){const e=await L.get(t,n);if(t=e.document,e.contextUrl){let n=t["@context"];n?f(n)?n.push(e.contextUrl):n=[n,e.contextUrl]:n=e.contextUrl,t["@context"]=n}}const i=t&&t["@context"]||{},s=await L.processContext(v(n),i,n);n.hasOwnProperty("omitGraph")||(n.omitGraph=_(s,1.1)),n.hasOwnProperty("pruneBlankNodeIdentifiers")||(n.pruneBlankNodeIdentifiers=_(s,1.1));const o=await L.expand(e,n),a={...n};a.isFrame=!0,a.keepFreeFloatingNodes=!0;const l=await L.expand(t,a),c=Object.keys(t).map(e=>y(s,e,{vocab:!0}));a.merged=!c.includes("@graph"),a.is11=_(s,1.1);const u=h(o,l,a);a.graph=!n.omitGraph,a.skipExpansion=!0,a.link={},a.framing=!0;let d=await L.compact(u,i,a);return a.link={},d=p(d,a),d},L.link=async function(e,t,n){const r={};return t&&(r["@context"]=t),r["@embed"]="@link",L.frame(e,r,n)},L.normalize=L.canonize=async function(t,n){if(arguments.length<1)throw new TypeError("Could not canonize, too few arguments.");if("inputFormat"in(n=P(n,{base:m(t)?t:null,algorithm:"URDNA2015",skipExpansion:!1,safe:!0,contextResolver:new r({sharedCache:D})}))){if("application/n-quads"!==n.inputFormat&&"application/nquads"!==n.inputFormat)throw new s("Unknown canonicalization input format.","jsonld.CanonizeError");const r=a.parse(t);return e.canonize(r,n)}const i={...n};delete i.format,i.produceGeneralizedRdf=!1;const o=await L.toRDF(t,i);return e.canonize(o,n)},L.fromRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert from RDF, too few arguments.");t=P(t,{format:m(e)?"application/n-quads":void 0});const{format:n}=t;let{rdfParser:r}=t;if(n){if(r=r||$[n],!r)throw new s("Unknown input format.","jsonld.UnknownFormat",{format:n})}else r=()=>e;const i=await r(e);return u(i,t)},L.toRDF=async function(e,t){if(arguments.length<1)throw new TypeError("Could not convert to RDF, too few arguments.");let n;n=(t=P(t,{base:m(e)?e:"",skipExpansion:!1,contextResolver:new r({sharedCache:D})})).skipExpansion?e:await L.expand(e,t);const i=d(n,t);if(t.format){if("application/n-quads"===t.format||"application/nquads"===t.format)return a.serialize(i);throw new s("Unknown output format.","jsonld.UnknownFormat",{format:t.format})}return i},L.createNodeMap=async function(e,t){if(arguments.length<1)throw new TypeError("Could not create node map, too few arguments.");t=P(t,{base:m(e)?e:"",contextResolver:new r({sharedCache:D})});const n=await L.expand(e,t);return I(n,t)},L.merge=async function(e,t,s){if(arguments.length<1)throw new TypeError("Could not merge, too few arguments.");if(!f(e))throw new TypeError('Could not merge, "docs" must be an array.');t="function"==typeof t?null:t||null,s=P(s,{contextResolver:new r({sharedCache:D})});const o=await Promise.all(e.map(e=>{const t={...s};return L.expand(e,t)}));let a=!0;"mergeNodes"in s&&(a=s.mergeNodes);const l=s.issuer||new i("_:b"),c={"@default":{}};for(let e=0;e<o.length;++e){const t=n.relabelBlankNodes(o[e],{issuer:new i("_:b"+e+"-")}),r=a||0===e?c:{"@default":{}};if(E(t,r,"@default",l),r!==c)for(const e in r){const t=r[e];if(!(e in c)){c[e]=t;continue}const n=c[e];for(const e in t)e in n||(n[e]=t[e])}}const u=j(c),d=[],h=Object.keys(u).sort();for(let e=0;e<h.length;++e){const t=u[h[e]];b(t)||d.push(t)}return null===t?d:(s.graph=!0,s.skipExpansion=!0,await L.compact(d,t,s))},Object.defineProperty(L,"documentLoader",{get:()=>L._documentLoader,set:e=>L._documentLoader=e}),L.documentLoader=async e=>{throw new s("Could not retrieve a JSON-LD document from the URL. URL dereferencing not implemented.","jsonld.LoadDocumentError",{code:"loading document failed",url:e})},L.get=async function(e,t){let n;n="function"==typeof t.documentLoader?t.documentLoader:L.documentLoader;const r=await n(e);try{if(!r.document)throw new s("No remote document found at the given URL.","jsonld.NullRemoteDocument");m(r.document)&&(r.document=JSON.parse(r.document))}catch(e){throw new s("Could not retrieve a JSON-LD document from the URL.","jsonld.LoadDocumentError",{code:"loading document failed",cause:e,remoteDoc:r})}return r},L.processContext=async function(e,t,i){return i=P(i,{base:"",contextResolver:new r({sharedCache:D})}),null===t?v(i):(t=n.clone(t),g(t)&&"@context"in t||(t={"@context":t}),w({activeCtx:e,localCtx:t,options:i}))},L.getContextValue=hr().getContextValue,L.documentLoaders={},L.useDocumentLoader=function(e){if(!(e in L.documentLoaders))throw new s('Unknown document loader type: "'+e+'"',"jsonld.UnknownDocumentLoader",{type:e});L.documentLoader=L.documentLoaders[e].apply(L,Array.prototype.slice.call(arguments,1))},L.registerRDFParser=function(e,t){$[e]=t},L.unregisterRDFParser=function(e){delete $[e]},L.registerRDFParser("application/n-quads",a.parse),L.registerRDFParser("application/nquads",a.parse),L.url=Jt(),L.logEventHandler=T,L.logWarningEventHandler=N,L.safeEventHandler=k,L.setDefaultEventHandler=R,L.strictEventHandler=A,L.unhandledEventHandler=O,L.util=n,Object.assign(L,n),L.promises=L,L.RequestQueue=qc(),L.JsonLdProcessor=Hf()(L),t.setupGlobals(L),t.setupDocumentLoaders(L),L},$=function(){return L(function(){return $()})};return L($),Fs=$}var Gf=Vf();const ks={},Ps={};class Wf{constructor(e){this.loadedExternalUrls=[],this.loadedClasses=[],this.config=e}async loadGraphs(){this.loadedExternalUrls=[],this.loadedClasses=[],this.config.prefixes={};const e=[],t=new et;if(e.push(this.importRDF(this.config.attributes.shapes?this.config.attributes.shapes:this.config.attributes.shapesUrl?this.fetchRDF(this.config.attributes.shapesUrl):"",t,mn)),e.push(this.importRDF(this.config.attributes.values?this.config.attributes.values:this.config.attributes.valuesUrl?this.fetchRDF(this.config.attributes.valuesUrl):"",t,Dt)),await Promise.all(e),0===t.countQuads(null,null,null,mn)&&this.config.attributes.valuesSubject){const e=[...t.getObjects(this.config.attributes.valuesSubject,sa,Dt)],n=[];for(const r of e){const e=this.toURL(r.value);e&&this.loadedExternalUrls.indexOf(e)<0&&(this.loadedExternalUrls.push(e),n.push(this.importRDF(this.fetchRDF(e),t,mn)))}try{await Promise.allSettled(n)}catch(e){console.warn(e)}}this.config.store=t}async importRDF(e,t,n){const r=async e=>{const r=[];await new Promise((i,s)=>{const o="xml"===au(e)?new vf.RdfXmlParser:new Td;o.on("data",e=>{if(t.add(new si(e.subject,e.predicate,e.object,n)),null===this.config.attributes.ignoreOwlImports&&Ea.equals(e.predicate)){const n=this.toURL(e.object.value);n&&this.loadedExternalUrls.indexOf(n)<0&&(this.loadedExternalUrls.push(n),r.push(this.importRDF(this.fetchRDF(n),t,Ne.namedNode(n))))}if(this.config.classInstanceProvider&&(Sa.equals(e.predicate)||Nr.equals(e.predicate))){const i=e.object.value;if(this.loadedClasses.indexOf(i)<0){let e;i in Ps?e=Ps[i]:(e=this.config.classInstanceProvider(i),Ps[i]=e),this.loadedClasses.push(i),r.push(this.importRDF(e,t,n))}}}).on("error",e=>{console.warn("failed parsing graph",n,e.message),s(e)}).on("prefix",(e,t)=>{e&&(this.config.prefixes[e]=t)}).on("end",()=>{i(null)}),o.write(e),o.end()});try{await Promise.allSettled(r)}catch(e){console.warn(e)}};if(e instanceof Promise&&(e=await e),e){if("json"===au(e))try{e=await Gf.toRDF(JSON.parse(e),{format:"application/n-quads"})}catch(e){console.error(e)}await r(e)}}toURL(e){if(oa(e))return e;if(this.config.prefixes){const t=e.split(":");if(2===t.length){const n=this.config.prefixes[t[0]];if(n&&oa(e=e.replace(`${t[0]}:`,n)))return e}}return null}async fetchRDF(e){if(e in ks)return ks[e];let t=e;this.config.attributes.proxy&&(t=this.config.attributes.proxy+encodeURIComponent(e));const n=fetch(t,{headers:{Accept:"text/turtle, application/trig, application/n-triples, application/n-quads, text/n3, application/ld+json"}}).then(e=>e.text());return ks[e]=n,n}}function au(e){return/^\s*\{/.test(e)?"json":/^\s*<\?xml/.test(e)?"xml":"ttl"}class Ms{constructor(){this.shapes=null,this.shapesUrl=null,this.shapeSubject=null,this.values=null,this.valuesUrl=null,this.valueSubject=null,this.valuesSubject=null,this.valuesNamespace="",this.valuesGraph=null,this.view=null,this.language=null,this.loading="Loading…",this.proxy=null,this.ignoreOwlImports=null,this.collapse=null,this.submitButton=null,this.generateNodeShapeReference=null,this.showNodeIds=null}}class ou{constructor(e,t){this.attributes=new Ms,this.loader=new Wf(this),this.prefixes={},this.editMode=!0,this.lists={},this.groups=[],this.renderedNodes=new Set,this._store=new et,this.theme=e,this.form=t,this.languages=[...new Set(navigator.languages.flatMap(e=>e.length>2?[e.toLocaleLowerCase(),e.substring(0,2)]:e)),""]}updateAttributes(e){const t=new Ms;if(Object.keys(t).forEach(n=>{const r=e.dataset[n];void 0!==r&&(t[n]=r)}),this.editMode=null===t.view,this.attributes=t,this.attributes.valueSubject&&!this.attributes.valuesSubject&&(this.attributes.valuesSubject=this.attributes.valueSubject),t.language){const e=this.languages.indexOf(t.language);e>-1&&this.languages.splice(e,1),this.languages.unshift(t.language)}t.valuesGraph&&(this.valuesGraphId=Ne.namedNode(t.valuesGraph))}static dataAttributes(){const e=new Ms;return Object.keys(e).map(e=>"data-"+e.replace(/[A-Z]/g,e=>"-"+e.toLowerCase()))}get store(){return this._store}set store(e){this._store=e,this.lists=qd(e,{ignoreErrors:!0}),this.groups=[],e.forSubjects(e=>{this.groups.push(e.id)},tt,`${xe}PropertyGroup`,null)}}function zf(e){return"_:"+e.value}function Qf(e,t){return[...e].map(e=>t(e)).join("\n")+"\n"}function Xf(){return""}function Hc(e){return"<"+e.value+">"}const Jf=/["\\\\\n\r]/,Kf=/["\\\\\n\r]/g,Yf={'"':'\\"',"\\":"\\\\","\n":"\\n","\r":"\\r"};function Zf(e){return Yf[e]}function ep(e){return Jf.test(e)?e.replace(Kf,Zf):e}function tp(e){const t=ep(e.value);return"http://www.w3.org/2001/XMLSchema#string"===e.datatype.value?'"'+t+'"':"http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"===e.datatype.value?'"'+t+'"@'+e.language:'"'+t+'"^^'+Hc(e.datatype)}function rp(e,t){const n=t(e.subject),r=t(e.predicate),i=t(e.object),s=t(e.graph);return`${n} ${r} ${i} ${s?s+" ":""}.`}function np(e){return"?"+e.value}function ot(e){if(!e)return null;if("BlankNode"===e.termType)return zf(e);if("DefaultGraph"===e.termType)return Xf();if("Literal"===e.termType)return tp(e);if("NamedNode"===e.termType)return Hc(e);if("Quad"===e.termType||e.subject&&e.predicate&&e.object&&e.graph)return rp(e,ot);if("Variable"===e.termType)return np(e);if(e[Symbol.iterator])return Qf(e,ot);throw new Error(`unknown termType ${e.termType}`)}class $r{constructor(e){if(this.index=new Map,e)for(const[t,n]of e)this.set(t,n)}get size(){return this.index.size}clear(){this.index.clear()}delete(e){return this.index.delete(ot(e))}*entries(){for(const[,{term:e,value:t}]of this.index)yield[e,t]}forEach(e,t){for(const n of this.entries())e.call(t,n[1],n[0],this)}get(e){const t=this.index.get(ot(e));return t&&t.value}has(e){return this.index.has(ot(e))}*keys(){for(const[,{term:e}]of this.index)yield e}set(e,t){const n=ot(e);return this.index.set(n,{term:e,value:t}),this}*values(){for(const[,{value:e}]of this.index)yield e}[Symbol.iterator](){return this.entries()[Symbol.iterator]()}}class lu{constructor({dataset:e,end:t,quad:n,start:r}){this.dataset=e,this.end=t,this.quad=n,this.start=r}get term(){return this.quad[this.end]}get graph(){return this.quad.graph}get startTerm(){return this.quad[this.start]}}function uu(e){try{return ot(e)}catch{return null}}class ft{constructor(e){if(this.index=new Map,e)for(const t of e)this.add(t)}get size(){return this.index.size}add(e){const t=ot(e);return this.index.has(t)||this.index.set(t,e),this}clear(){this.index.clear()}delete(e){return!!e&&this.index.delete(uu(e))}entries(){return this.values().entries()}forEach(e,t){return this.values().forEach(e,t)}has(e){return!!e&&this.index.has(uu(e))}values(){return new Set(this.index.values())}keys(){return this.values()}[Symbol.iterator](){return this.index.values()}}class Vc{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}Vc.prototype.termType="BlankNode";class Ba{equals(e){return!!e&&e.termType===this.termType}}function cu(e,t){if(!t)return null;if("BlankNode"===t.termType)return e.blankNode(t.value);if("DefaultGraph"===t.termType)return e.defaultGraph();if("Literal"===t.termType)return e.literal(t.value,t.language||e.namedNode(t.datatype.value));if("NamedNode"===t.termType)return e.namedNode(t.value);if("Quad"===t.termType){const n=e.fromTerm(t.subject),r=e.fromTerm(t.predicate),i=e.fromTerm(t.object),s=e.fromTerm(t.graph);return e.quad(n,r,i,s)}if("Variable"===t.termType)return e.variable(t.value);throw new Error(`unknown termType ${t.termType}`)}Ba.prototype.termType="DefaultGraph",Ba.prototype.value="";class Kn{constructor(e,t,n,r=""){this.value=e,this.language=t,this.datatype=n,this.direction=r}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value&&e.language===this.language&&e.datatype.equals(this.datatype)&&(e.direction||"")===this.direction}}Kn.prototype.termType="Literal";class Dn{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}Dn.prototype.termType="NamedNode";class qa{constructor(e,t,n,r){this.subject=e,this.predicate=t,this.object=n,this.graph=r}equals(e){return!!e&&("Quad"===e.termType||!e.termType)&&e.subject.equals(this.subject)&&e.predicate.equals(this.predicate)&&e.object.equals(this.object)&&e.graph.equals(this.graph)}}qa.prototype.termType="Quad",qa.prototype.value="";class Gc{constructor(e){this.value=e}equals(e){return!!e&&e.termType===this.termType&&e.value===this.value}}Gc.prototype.termType="Variable";const ip=new Dn("http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString"),du=new Dn("http://www.w3.org/1999/02/22-rdf-syntax-ns#langString"),sp=new Dn("http://www.w3.org/2001/XMLSchema#string");class Wc{constructor(){this.init()}init(){this._data={blankNodeCounter:0,defaultGraph:new Ba}}namedNode(e){return new Dn(e)}blankNode(e){return e=e||"b"+ ++this._data.blankNodeCounter,new Vc(e)}literal(e,t){return"string"==typeof t?new Kn(e,t,du):"string"==typeof t?.language?new Kn(e,t.language,t.direction?ip:du,t.direction):new Kn(e,"",t||sp)}variable(e){return new Gc(e)}defaultGraph(){return this._data.defaultGraph}quad(e,t,n,r=this.defaultGraph()){return new qa(e,t,n,r)}fromTerm(e){return cu(this,e)}fromQuad(e){return cu(this,e)}}Wc.exports=["blankNode","defaultGraph","fromQuad","fromTerm","literal","namedNode","quad","variable"];const Ua=new Wc,ap={apply:(e,t,n)=>e(n[0]),get:(e,t)=>e(t)};function mt(e,{factory:t=Ua}={}){const n=(n="")=>t.namedNode(`${e}${n.raw||n}`);return typeof Proxy>"u"?n:new Proxy(n,ap)}mt("http://www.w3.org/2001/XMLSchema#");const xt=mt("http://www.w3.org/1999/02/22-rdf-syntax-ns#");mt("http://www.w3.org/2000/01/rdf-schema#");class Fe{static add({ptr:e,start:t,end:n,subjects:r=[null],predicates:i=[null],objects:s=[null],graphs:o,callback:a}={}){if(!e.factory)throw new Error("add operation requires a factory");let l=()=>{};a&&(l=r=>{a(new lu({dataset:e.dataset,start:t,end:n,quad:r}))});for(const n of r)for(const r of i)for(const i of s)for(const s of o){const o={subject:n,predicate:r,object:i,graph:s};o[t]=e.term;const a=e.factory.quad(o.subject,o.predicate,o.object,o.graph);e.dataset.add(a),l(a)}return e}static addList({ptr:e,predicates:t,items:n,graphs:r}){if(e.isAny())throw new Error("can't attach a list to an any ptr");for(const i of t)for(const t of r){const r=n.map(()=>e.factory.blankNode());e.dataset.add(e.factory.quad(e.term,i,r[0]||xt.nil,t));for(let i=0;i<r.length;i++)e.dataset.add(e.factory.quad(r[i],xt.first,n[i],t)),e.dataset.add(e.factory.quad(r[i],xt.rest,r[i+1]||xt.nil,t))}return e}static delete({ptr:e,start:t,subjects:n=[null],predicates:r=[null],objects:i=[null]}){for(const s of n)for(const n of r)for(const r of i){const i={subject:s,predicate:n,object:r};i[t]=e.term;const o=e.dataset.match(i.subject,i.predicate,i.object);for(const t of o)e.dataset.delete(t)}return e}static deleteList({ptr:e,predicates:t}){const n=[];for(const r of t)for(const t of e.dataset.match(e.term,r)){let r=t.object;for(n.push(t);!xt.nil.equals(r);){r=n[n.length-1].object;const t=e.dataset.match(r);if(0===t.size)break;for(const e of t)n.push(e)}}for(const t of n)e.dataset.delete(t);return e}static execute({ptr:e,operation:t="traverse",quantifier:n,start:r,end:i,subjects:s,predicates:o,objects:a,graphs:l,items:c,callback:u}={}){if("add"===t)return Fe.add({ptr:e,start:r,end:i,subjects:s,predicates:o,objects:a,graphs:l,callback:u});if("addList"===t)return Fe.addList({ptr:e,predicates:o,items:c,graphs:l});if("delete"===t)return Fe.delete({ptr:e,start:r,subjects:s,predicates:o,objects:a});if("deleteList"===t)return Fe.deleteList({ptr:e,predicates:o});if("isList"===t)return Fe.isList({ptr:e});if("list"===t)return Fe.list({ptr:e});if("traverse"===t)return Fe.traverse({ptr:e,quantifier:n,start:r,end:i,subjects:s,predicates:o,objects:a,graphs:l});throw new Error(`unknown operation ${t}`)}static isList({ptr:e}){return!(e.isAny()||!xt.nil.equals(e.term)&&1!==Fe.traverse({ptr:e,predicates:[xt.first]}).length)}static list({ptr:e}){if(e.isList())return{*[Symbol.iterator](){for(;e&&!e.term.equals(xt.nil);){const t=e.out([xt.first]);if(1!==t.length)throw new Error(`Invalid list: rdf:first count not equals one on ${e.value}`);const n=e.out([xt.rest]);if(1!==n.length)throw new Error(`Invalid list: rdf:rest count not equals one on ${e.value}`);yield t[0],e=n[0]}}}}static traverse({ptr:e,quantifier:t="one",start:n="subject",end:r="object",subjects:i=[null],predicates:s=[null],objects:o=[null],graphs:a=[null],callback:l}){if("one"===t)return Fe.traverseOne({ptr:e,start:n,end:r,subjects:i,predicates:s,objects:o,graphs:a,callback:l});if("oneOrMore"===t){const t=Fe.traverse({ptr:e,end:r,start:n,subjects:i,predicates:s,objects:o,graphs:a,callback:l});return Fe.traverseMore({ptrs:t,end:r,start:n,subjects:i,predicates:s,objects:o,graphs:a,callback:l})}if("zeroOrMore"===t)return Fe.traverseMore({ptrs:[e],end:r,start:n,subjects:i,predicates:s,objects:o,graphs:a,callback:l});if("zeroOrOne"===t)return[e,...Fe.traverse({ptr:e,end:r,start:n,subjects:i,predicates:s,objects:o,graphs:a,callback:l})];throw new Error(`unknown quantifier ${t}`)}static traverseMore({ptrs:e,end:t,start:n,subjects:r,predicates:i,objects:s,graphs:o,callback:a}={}){let l,c,u=[...e];do{l=[];for(const c of e)l=[...l,...Fe.traverseOne({ptr:c,end:t,start:n,subjects:r,predicates:i,objects:s,graphs:o,callback:a})];c&&(l=l.filter(e=>!c.has(e.term))),e=l,u=[...u,...l],c=new ft(u.map(e=>e.term))}while(l.length>0);return u}static traverseOne({ptr:e,start:t,end:n,subjects:r,predicates:i,objects:s,graphs:o,callback:a=(e,t)=>t.extend(e)}={}){const l=[];for(const c of r)for(const r of i)for(const i of s)for(const s of o){const o={subject:c,predicate:r,object:i,graph:s};o[t]=e.term;for(const r of e.dataset.match(o.subject,o.predicate,o.object,o.graph))l.push(a(new lu({dataset:e.dataset,end:n,quad:r,start:t}),e))}return l}}function hu(e,t){return t?n=>t(e.extend(n)):()=>{}}class fu{constructor({dataset:e,edges:t=[],factory:n,graph:r,term:i}){if(!e&&0===t.length)throw new Error("dataset or edges is required");if(0===t.length&&typeof i>"u")throw new Error("edges or term must be given");if(t.length>0&&i)throw new Error("edges or term must be given");this.dataset=e||t[t.length-1].dataset,this.edges=t,this.factory=n,this._graph=r,0===t.length&&(this._term=i)}get edge(){return this.edges[this.edges.length-1]}get graph(){return"object"==typeof this._graph?this._graph:this.edge&&this.edge.graph}get length(){return void 0!==this._term?1:this.edges.length+1}get startTerm(){return this._term||this.edges[0].startTerm}get term(){return void 0!==this._term?this._term:this.edge.term}get value(){const e=this.term;return null===e?void 0:e.value}addIn(e,t,n){return Fe.add({ptr:this,start:"object",end:"subject",subjects:t,predicates:e,graphs:[this.graph||this.factory.defaultGraph()],callback:hu(this,n)})}addList(e,t){return Fe.addList({ptr:this,predicates:e,graphs:[this.graph||this.factory.defaultGraph()],items:t})}addOut(e,t,n){return Fe.add({ptr:this,start:"subject",end:"object",predicates:e,objects:t,graphs:[this.graph||this.factory.defaultGraph()],callback:hu(this,n)})}deleteIn(e,t){return Fe.delete({ptr:this,start:"object",subjects:t,predicates:e})}deleteList(e){return Fe.deleteList({ptr:this,predicates:e})}deleteOut(e,t){return Fe.delete({ptr:this,start:"subject",predicates:e,objects:t})}execute({operation:e,quantifier:t,start:n,end:r,subjects:i,predicates:s,objects:o,graphs:a,items:l,callback:c}){return Fe.execute({ptr:this,operation:e,quantifier:t,start:n,end:r,subjects:i,predicates:s,objects:o,graphs:a,items:l,callback:c})}extend(e){return new this.constructor({dataset:this.dataset,edges:[...this.edges,e],factory:this.factory,graph:this._graph})}hasIn(e,t){return Fe.traverse({ptr:this,start:"object",end:"object",subjects:t,predicates:e,graphs:[this.graph]})}hasOut(e,t){return Fe.traverse({ptr:this,start:"subject",end:"subject",predicates:e,objects:t,graphs:[this.graph]})}in(e,t){return Fe.traverse({ptr:this,start:"object",end:"subject",subjects:t,predicates:e,graphs:[this.graph]})}isAny(){return!this.term}isList(){return Fe.isList({ptr:this})}list(){return Fe.list({ptr:this})}*nodes(){for(let e=0;e<this.length;e++)void 0!==this._term?yield{dataset:this.dataset,term:this._term}:this.edges.length>e?yield{dataset:this.edges[e].dataset,term:this.edges[e].startTerm}:this.edges.length===e&&(yield{dataset:this.edges[e-1].dataset,term:this.edges[e-1].term})}out(e,t){return Fe.traverse({ptr:this,predicates:e,objects:t,graphs:[this.graph]})}*quads(){for(const{quad:e}of this.edges)yield e}trim(){return new this.constructor({dataset:this.dataset,factory:this.factory,graph:this.graph,term:this.term})}}function pu(e,t){return e?e.equals(t):e===t}function op(e,t){return!(e.dataset!==t.dataset||!pu(e.graph,t.graph)||!pu(e.term,t.term))}function gu(e,t){return t?n=>t(new e.constructor({factory:e.factory,ptrs:[n]})):()=>{}}class ni{constructor({dataset:e,factory:t,ptrs:n,terms:r,graphs:i}){if(this.factory=t,n)this.ptrs=[...n];else{this.ptrs=[];for(const n of r||[null])for(const r of i||[null])this.ptrs.push(new fu({dataset:e,factory:t,graph:r,term:n}))}}get dataset(){const e=new Set(this.datasets);return 1!==e.size?null:e[Symbol.iterator]().next().value}get datasets(){return this.ptrs.map(e=>e.dataset)}get term(){const e=new ft(this.terms);if(1===e.size)return e[Symbol.iterator]().next().value}get terms(){return this.ptrs.map(e=>e.term)}get value(){const e=this.term;return e?.value}get values(){return this.ptrs.map(e=>e.value)}addIn(e,t,n){const r=gu(this,n);for(const n of this.ptrs)n.addIn(e,t,r);return this}addList(e,t){if(this.isAny())throw new Error("can't attach a list to an any ptr");for(const n of this.ptrs)n.addList(e,t);return this}addOut(e,t,n){const r=gu(this,n);for(const n of this.ptrs)n.addOut(e,t,r);return this}clone(e){return new this.constructor({factory:this.factory,ptrs:this.ptrs,...e})}deleteIn(e,t){for(const n of this.ptrs)n.deleteIn(e,t);return this}deleteList(e){for(const t of this.ptrs)t.deleteList(e);return this}deleteOut(e,t){for(const n of this.ptrs)n.deleteOut(e,t);return this}distinct(){const e=this.ptrs.reduce((e,t)=>(e.some(e=>op(e,t))||e.push(t.trim()),e),[]);return this.clone({ptrs:e})}execute(e){return this.clone({ptrs:this.ptrs.flatMap(t=>t.execute(e))})}executeAll(e){let t=this;for(const n of e)t=t.execute(n);return t}filter(e){return this.clone({ptrs:[...this].filter(e).map(e=>e.ptrs[0])})}hasIn(e,t){return this.clone({ptrs:this.ptrs.flatMap(n=>n.hasIn(e,t))})}hasOut(e,t){return this.clone({ptrs:this.ptrs.flatMap(n=>n.hasOut(e,t))})}in(e,t){return this.clone({ptrs:this.ptrs.flatMap(n=>n.in(e,t))})}isAny(){return this.ptrs.length>0&&this.ptrs.some(e=>e.isAny())}isList(){return 1===this.ptrs.length&&this.ptrs[0].isList()}list(){if(!this.isList())return;const e=this.ptrs[0].list(),t=this;return function*(){for(const n of e)yield t.clone({ptrs:[n]})}()}map(e){return[...this].map(e)}node(e){const t=this.dataset,n=[...e].map(e=>new fu({dataset:t,factory:this.factory,term:e}));return this.clone({ptrs:n})}out(e,t){return this.clone({ptrs:this.ptrs.flatMap(n=>n.out(e,t))})}*quads(){for(const{edges:e}of this.ptrs)for(const{quad:t}of e)yield t}trim(){return this.clone({ptrs:this.ptrs.map(e=>e.trim())})}*[Symbol.iterator](){for(const e of this.ptrs)yield this.clone({ptrs:[e]})}}mt("http://www.w3.org/2002/07/owl#");const fr=mt("http://www.w3.org/1999/02/22-rdf-syntax-ns#"),lp=mt("http://www.w3.org/2000/01/rdf-schema#"),ae=mt("http://www.w3.org/ns/shacl#"),ha=mt("https://schemas.link/shacl-next#"),Ha=mt("http://www.w3.org/2001/XMLSchema#");function up(e){return e?`{${[...e.quads()].map(e=>ot(e)).join(" ")}}`:"{}"}function cp(e){return e?`{${e.map(e=>up(e)).join(" ")}}`:"{}"}var Bs,mu,qs,yu,Us,bu,Hs,_u,Vs,wu,Gs,vu,Ws,xu,zs,Eu,Qs,Su,Xs,Iu,Js,Nu,Ks,Ru,Ys,Tu,Zs,Au,ea,Du,ta,Lu;function dp(){if(mu)return Bs;mu=1;var e=/\s/;return Bs=function(t){for(var n=t.length;n--&&e.test(t.charAt(n)););return n}}function hp(){if(yu)return qs;yu=1;var e=dp(),t=/^\s+/;return qs=function(n){return n&&n.slice(0,e(n)+1).replace(t,"")}}function fp(){return bu?Us:(bu=1,Us=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)})}function pp(){if(_u)return Hs;_u=1;var e="object"==typeof Sr&&Sr&&Sr.Object===Object&&Sr;return Hs=e}function gp(){if(wu)return Vs;wu=1;var e=pp(),t="object"==typeof self&&self&&self.Object===Object&&self,n=e||t||Function("return this")();return Vs=n}function zc(){if(vu)return Gs;vu=1;var e=gp().Symbol;return Gs=e}function mp(){if(xu)return Ws;xu=1;var e=zc(),t=Object.prototype,n=t.hasOwnProperty,r=t.toString,i=e?e.toStringTag:void 0;return Ws=function(e){var t=n.call(e,i),s=e[i];try{e[i]=void 0;var o=!0}catch{}var a=r.call(e);return o&&(t?e[i]=s:delete e[i]),a}}function yp(){if(Eu)return zs;Eu=1;var e=Object.prototype.toString;return zs=function(t){return e.call(t)}}function bp(){if(Su)return Qs;Su=1;var e=zc(),t=mp(),n=yp(),r=e?e.toStringTag:void 0;return Qs=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":r&&r in Object(e)?t(e):n(e)}}function _p(){return Iu?Xs:(Iu=1,Xs=function(e){return null!=e&&"object"==typeof e})}function wp(){if(Nu)return Js;Nu=1;var e=bp(),t=_p();return Js=function(n){return"symbol"==typeof n||t(n)&&"[object Symbol]"==e(n)}}function vp(){if(Ru)return Ks;Ru=1;var e=hp(),t=fp(),n=wp(),r=/^[-+]0x[0-9a-f]+$/i,i=/^0b[01]+$/i,s=/^0o[0-7]+$/i,o=parseInt;return Ks=function(a){if("number"==typeof a)return a;if(n(a))return NaN;if(t(a)){var l="function"==typeof a.valueOf?a.valueOf():a;a=t(l)?l+"":l}if("string"!=typeof a)return 0===a?a:+a;a=e(a);var c=i.test(a);return c||s.test(a)?o(a.slice(2),c?2:8):r.test(a)?NaN:+a}}function xp(){if(Tu)return Ys;Tu=1;var e=vp(),t=1/0;return Ys=function(n){return n?(n=e(n))===t||n===-t?17976931348623157e292*(n<0?-1:1):n==n?n:0:0===n?n:0}}function Ep(){if(Au)return Zs;Au=1;var e=xp();return Zs=function(t){var n=e(t),r=n%1;return n==n?r?n-r:n:0}}function Sp(){if(Du)return ea;Du=1;var e=Ep();return ea=function(t,n){var r;if("function"!=typeof n)throw new TypeError("Expected a function");return t=e(t),function(){return--t>0&&(r=n.apply(this,arguments)),t<=1&&(n=void 0),r}},ea}function Ip(){if(Lu)return ta;Lu=1;var e=Sp();return ta=function(t){return e(2,t)}}var Np=Ip();const _t=td(Np);let Ou=class{constructor({details:e,factory:t,options:n,results:r=[]}={}){this.details=e,this.factory=t,this.options=n,this.results=r,this._conforms=_t(()=>!this.results.some(e=>e.severity.equals(ae.Info)||e.severity.equals(ae.Violation)||e.severity.equals(ae.Warning))),this._ptr=_t(()=>this.build())}get conforms(){return this._conforms()}get dataset(){return this.ptr.dataset}get ptr(){return this._ptr()}get term(){return this.ptr.term}build(){const e=new ni({dataset:this.factory.dataset(),factory:this.factory,terms:[this.factory.blankNode()]});e.addOut([fr.type],[ae.ValidationReport]).addOut([ae.conforms],[this.factory.literal(this.conforms.toString(),Ha.boolean)]);for(const t of this.results)e.addOut([ae.result],[this.factory.blankNode()],e=>{t.build(e,this.options)});return e}coverage(){return this.results.flatMap(e=>e.coverage())}};function Rp(e,t){return Object.entries(t).reduce((e,[t,n])=>(n&&n.termType&&(n=ot(n)),e.replace(`{$${t}}`,n).replace(`{?${t}}`,n)),e)}let Tp=class{constructor({args:e={},constraintComponent:t,factory:n,focusNode:r,message:i=[],path:s,results:o=[],severity:a,shape:l,source:c=[],value:u,valuePaths:d=[]}={}){this.args=e,this.constraintComponent=t,this.factory=n,this.focusNode=r,this.path=s||l.path,this.results=o,this.severity=a,this.shape=l,this.source=c,this.value=u,this.valuePaths=d,this._message=_t(()=>(this.shape.message.length>0&&(i=this.shape.message),0===i.length&&(i=this.shape.ptr.node([this.constraintComponent]).out([ae.message]).terms),i.map(t=>n.literal(Rp(t.value,e),t.language||null))))}get message(){return this._message()}build(e,{details:t}={}){e.addOut([fr.type],[ae.ValidationResult]).addOut([ae.focusNode],this.focusNode.terms).addOut([ae.resultSeverity],[this.severity]).addOut([ae.sourceConstraint],this.source).addOut([ae.sourceConstraintComponent],[this.constraintComponent]).addOut([ae.sourceShape],this.shape.ptr.terms),this.message&&e.addOut([ae.resultMessage],this.message);const n=t=>"one"===t.quantifier?t.predicates.length>1?e.node([this.factory.blankNode()]).addList([ae.alternativePath],t.predicates):"object"===t.start?e.node([this.factory.blankNode()]).addOut([ae.inversePath],[t.predicates[0]]):e.node([t.predicates[0]]):"oneOrMore"===t.quantifier?e.node([this.factory.blankNode()]).addOut([ae.oneOrMorePath],[t.predicates[0]]):"zeroOrMore"===t.quantifier?e.node([this.factory.blankNode()]).addOut([ae.zeroOrMorePath],[t.predicates[0]]):"zeroOrOne"===t.quantifier?e.node([this.factory.blankNode()]).addOut([ae.zeroOrOnePath],[t.predicates[0]]):void 0;if(this.path&&(1===this.path.length?e.addOut([ae.resultPath],n(this.path[0]).terms):e.addList([ae.resultPath],this.path.map(e=>n(e).term))),typeof this.value<"u"&&e.addOut([ae.value],this.value.terms),t)for(const n of this.results)e.addOut([ae.detail],[this.factory.blankNode()],e=>{n.build(e,{details:t})})}coverage(){return[...this.valuePaths.flatMap(e=>[...e.quads()]),...this.results.flatMap(e=>e.coverage())]}};class Va{constructor({factory:e,focusNode:t,options:n={debug:!1,details:!1},processed:r=new Set,report:i=new Ou({factory:e,options:n}),results:s=new Map,shape:o,value:a,valueOrNode:l,valuePaths:c,values:u}={}){this.factory=e,this.focusNode=t,this.options=n,this.processed=r,this.report=i,this.results=s,this.shape=o,this.value=a,this.valuePaths=c,this.valueOrNode=l,this.values=u}create({child:e,focusNode:t=this.focusNode,shape:n=this.shape,value:r=this.value,valueOrNode:i=this.valueOrNode,valuePaths:s=this.valuePaths,values:o=this.values}={}){return new Va({factory:this.factory,focusNode:t,options:this.options,processed:this.processed,report:e?new Ou({factory:this.factory,options:this.options}):this.report,results:this.results,shape:n,value:r,valueOrNode:i,valuePaths:s,values:o})}id({shape:e=this.shape}={}){return`${ot(e.ptr.term)} - ${ot(this.focusNode.term)} - ${cp(this.valuePaths)}`}result(e){const t=new Tp({factory:this.factory,focusNode:this.focusNode,shape:this.shape,value:this.value,valuePaths:this.valuePaths,...e}),n=this.id();this.results.has(n)?this.results.get(n).add(t):this.results.set(n,new Set([t])),this.report.results.push(t)}debug(e,t){this.options.debug&&this.result({severity:ha.Debug,constraintComponent:e,...t})}trace(e,t){this.options.trace&&this.result({severity:ha.Trace,constraintComponent:e,...t})}test(e,t,n){e?this.debug(t,n):this.violation(t,n)}violation(e,t){this.result({constraintComponent:e,severity:this.shape.severity||ae.Violation,...t})}}function Ap(){return{generic:Dp()}}function Dp(){return e=>{e.trace(ha.TraversalConstraintComponent,{args:{},message:[e.factory.literal("Traversal")],value:e.valueOrNode})}}class Lp{constructor(e){this.validations=new $r(e)}compile(e){const t=e.validator.options.coverage;if(e.deactivated)return[];let n=!1;const r=new Set;for(const t of e.ptr.execute({start:"subject",end:"predicate"})){const e=this.validations.get(t.term);e&&(r.add(e),t.term.equals(ae.property)&&(n=!0))}return t&&e.isPropertyShape&&!n&&r.add(Ap),[...r].map(t=>t(e)).filter(Boolean)}}var Cu,ju,ir={},sr={},sn={},an={};function Lr(){return Cu||(Cu=1,Object.defineProperty(an,"__esModule",{value:!0}),an.Translator=void 0,an.Translator=class{constructor(){this.supportedRdfDatatypes=[],this.fromRdfHandlers={},this.toRdfHandlers={}}static incorrectRdfDataType(e){throw new Error(`Invalid RDF ${e.datatype.value} value: '${e.value}'`)}registerHandler(e,t,n){for(const n of t)this.supportedRdfDatatypes.push(n),this.fromRdfHandlers[n.value]=e;for(const t of n){let n=this.toRdfHandlers[t];n||(this.toRdfHandlers[t]=n=[]),n.push(e)}}fromRdf(e,t){const n=this.fromRdfHandlers[e.datatype.value];return n?n.fromRdf(e,t):e.value}toRdf(e,t){const n=this.toRdfHandlers[typeof e];if(n)for(const r of n){const n=r.toRdf(e,t);if(n)return n}throw new Error(`Invalid JavaScript value: '${e}'`)}getSupportedRdfDatatypes(){return this.supportedRdfDatatypes}getSupportedJavaScriptPrimitives(){return Object.keys(this.toRdfHandlers)}}),an}function Op(){if(ju)return sn;ju=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.TypeHandlerBoolean=void 0;const e=Lr();let t=class t{fromRdf(t,n){switch(t.value){case"true":case"1":return!0;case"false":case"0":return!1}return n&&e.Translator.incorrectRdfDataType(t),!1}toRdf(e,{datatype:n,dataFactory:r}){return r.literal(e?"true":"false",n||r.namedNode(t.TYPE))}};return sn.TypeHandlerBoolean=t,t.TYPE="http://www.w3.org/2001/XMLSchema#boolean",sn}var $u,on={};function Cp(){if($u)return on;$u=1,Object.defineProperty(on,"__esModule",{value:!0}),on.TypeHandlerDate=void 0;const e=Lr();let t=class t{fromRdf(n,r){switch(r&&!n.value.match(t.VALIDATORS[n.datatype.value.substr(33,n.datatype.value.length)])&&e.Translator.incorrectRdfDataType(n),n.datatype.value){case"http://www.w3.org/2001/XMLSchema#gDay":return new Date(0,0,parseInt(n.value,10));case"http://www.w3.org/2001/XMLSchema#gMonthDay":const e=n.value.split("-");return new Date(0,parseInt(e[0],10)-1,parseInt(e[1],10));case"http://www.w3.org/2001/XMLSchema#gYear":return new Date(n.value+"-01-01");case"http://www.w3.org/2001/XMLSchema#gYearMonth":return new Date(n.value+"-01");default:return new Date(n.value)}}toRdf(e,{datatype:n,dataFactory:r}){if(n=n||r.namedNode(t.TYPES[0]),!(e instanceof Date))return null;const i=e;let s;switch(n.value){case"http://www.w3.org/2001/XMLSchema#gDay":s=String(i.getUTCDate());break;case"http://www.w3.org/2001/XMLSchema#gMonthDay":s=i.getUTCMonth()+1+"-"+i.getUTCDate();break;case"http://www.w3.org/2001/XMLSchema#gYear":s=String(i.getUTCFullYear());break;case"http://www.w3.org/2001/XMLSchema#gYearMonth":s=i.getUTCFullYear()+"-"+(i.getUTCMonth()+1);break;case"http://www.w3.org/2001/XMLSchema#date":s=i.toISOString().replace(/T.*$/,"");break;default:s=i.toISOString()}return r.literal(s,n)}};return on.TypeHandlerDate=t,t.TYPES=["http://www.w3.org/2001/XMLSchema#dateTime","http://www.w3.org/2001/XMLSchema#date","http://www.w3.org/2001/XMLSchema#gDay","http://www.w3.org/2001/XMLSchema#gMonthDay","http://www.w3.org/2001/XMLSchema#gYear","http://www.w3.org/2001/XMLSchema#gYearMonth"],t.VALIDATORS={date:/^[0-9]+-[0-9][0-9]-[0-9][0-9]Z?$/,dateTime:/^[0-9]+-[0-9][0-9]-[0-9][0-9]T[0-9][0-9]:[0-9][0-9]:[0-9][0-9](\.[0-9][0-9][0-9])?((Z?)|([\+-][0-9][0-9]:[0-9][0-9]))$/,gDay:/^[0-9]+$/,gMonthDay:/^[0-9]+-[0-9][0-9]$/,gYear:/^[0-9]+$/,gYearMonth:/^[0-9]+-[0-9][0-9]$/},on}var Fu,ln={};function jp(){if(Fu)return ln;Fu=1,Object.defineProperty(ln,"__esModule",{value:!0}),ln.TypeHandlerNumberDouble=void 0;const e=Lr();let t=class t{fromRdf(t,n){const r=parseFloat(t.value);return n&&isNaN(r)&&e.Translator.incorrectRdfDataType(t),r}toRdf(e,{datatype:n,dataFactory:r}){return n=n||r.namedNode(t.TYPES[0]),isNaN(e)?r.literal("NaN",n):isFinite(e)?e%1==0?null:r.literal(e.toExponential(15).replace(/(\d)0*e\+?/,"$1E"),n):r.literal(e>0?"INF":"-INF",n)}};return ln.TypeHandlerNumberDouble=t,t.TYPES=["http://www.w3.org/2001/XMLSchema#double","http://www.w3.org/2001/XMLSchema#decimal","http://www.w3.org/2001/XMLSchema#float"],ln}var ku,un={};function $p(){if(ku)return un;ku=1,Object.defineProperty(un,"__esModule",{value:!0}),un.TypeHandlerNumberInteger=void 0;const e=Lr();let t=class t{fromRdf(t,n){const r=parseInt(t.value,10);return n&&(isNaN(r)||t.value.indexOf(".")>=0)&&e.Translator.incorrectRdfDataType(t),r}toRdf(e,{datatype:n,dataFactory:r}){return r.literal(String(e),n||(e<=t.MAX_INT&&e>=t.MIN_INT?r.namedNode(t.TYPES[0]):r.namedNode(t.TYPES[1])))}};return un.TypeHandlerNumberInteger=t,t.TYPES=["http://www.w3.org/2001/XMLSchema#integer","http://www.w3.org/2001/XMLSchema#long","http://www.w3.org/2001/XMLSchema#int","http://www.w3.org/2001/XMLSchema#byte","http://www.w3.org/2001/XMLSchema#short","http://www.w3.org/2001/XMLSchema#negativeInteger","http://www.w3.org/2001/XMLSchema#nonNegativeInteger","http://www.w3.org/2001/XMLSchema#nonPositiveInteger","http://www.w3.org/2001/XMLSchema#positiveInteger","http://www.w3.org/2001/XMLSchema#unsignedByte","http://www.w3.org/2001/XMLSchema#unsignedInt","http://www.w3.org/2001/XMLSchema#unsignedLong","http://www.w3.org/2001/XMLSchema#unsignedShort"],t.MAX_INT=2147483647,t.MIN_INT=-2147483648,un}var Pu,Mu,cn={};function Fp(){if(Pu)return cn;Pu=1,Object.defineProperty(cn,"__esModule",{value:!0}),cn.TypeHandlerString=void 0;let e=class{fromRdf(e){return e.value}toRdf(e,{datatype:t,dataFactory:n}){return n.literal(e,t)}};return cn.TypeHandlerString=e,e.TYPES=["http://www.w3.org/2001/XMLSchema#string","http://www.w3.org/2001/XMLSchema#normalizedString","http://www.w3.org/2001/XMLSchema#anyURI","http://www.w3.org/2001/XMLSchema#base64Binary","http://www.w3.org/2001/XMLSchema#language","http://www.w3.org/2001/XMLSchema#Name","http://www.w3.org/2001/XMLSchema#NCName","http://www.w3.org/2001/XMLSchema#NMTOKEN","http://www.w3.org/2001/XMLSchema#token","http://www.w3.org/2001/XMLSchema#hexBinary","http://www.w3.org/1999/02/22-rdf-syntax-ns#langString","http://www.w3.org/1999/02/22-rdf-syntax-ns#dirLangString","http://www.w3.org/2001/XMLSchema#time","http://www.w3.org/2001/XMLSchema#duration"],cn}function Bu(){return Mu||(Mu=1,e=sr,t=sr&&sr.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=sr&&sr.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)},Object.defineProperty(e,"__esModule",{value:!0}),n(Op(),e),n(Cp(),e),n(jp(),e),n($p(),e),n(Fp(),e)),sr;var e,t,n}var qu,Uu,ra={};function kp(){return qu||(qu=1,Object.defineProperty(ra,"__esModule",{value:!0})),ra}function Pp(){return Uu||(Uu=1,function(e){var t=ir&&ir.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var i=Object.getOwnPropertyDescriptor(t,n);(!i||("get"in i?!t.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,i)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),n=ir&&ir.__exportStar||function(e,n){for(var r in e)"default"!==r&&!Object.prototype.hasOwnProperty.call(n,r)&&t(n,e,r)};Object.defineProperty(e,"__esModule",{value:!0}),e.fromRdf=l,e.toRdf=function(e,t){return t&&"namedNode"in t&&(t={dataFactory:t}),(t=t||{})&&!t.dataFactory&&(t.dataFactory=o),a.toRdf(e,t)},e.getTermRaw=function(e,t){return"Literal"===e.termType?l(e,t):e.value},e.getSupportedRdfDatatypes=function(){return a.getSupportedRdfDatatypes()},e.getSupportedJavaScriptPrimitives=function(){return a.getSupportedJavaScriptPrimitives()};const r=Fc(),i=Bu(),s=Lr();n(Bu(),e),n(kp(),e),n(Lr(),e);const o=new r.DataFactory,a=new s.Translator;function l(e,t){return a.fromRdf(e,t)}a.registerHandler(new i.TypeHandlerString,i.TypeHandlerString.TYPES.map(e=>o.namedNode(e)),["string"]),a.registerHandler(new i.TypeHandlerBoolean,[i.TypeHandlerBoolean.TYPE].map(e=>o.namedNode(e)),["boolean"]),a.registerHandler(new i.TypeHandlerNumberDouble,i.TypeHandlerNumberDouble.TYPES.map(e=>o.namedNode(e)),["number"]),a.registerHandler(new i.TypeHandlerNumberInteger,i.TypeHandlerNumberInteger.TYPES.map(e=>o.namedNode(e)),["number"]),a.registerHandler(new i.TypeHandlerDate,i.TypeHandlerDate.TYPES.map(e=>o.namedNode(e)),["object"])}(ir)),ir}var In=Pp();function Hu(e){if("BlankNode"!==e.term.termType)return{quantifier:"one",start:"subject",end:"object",predicates:[e.term]};const t=e.out([ae.alternativePath]);if(1===t.ptrs.length&&t.ptrs[0].isList())return{quantifier:"one",start:"subject",end:"object",predicates:[...t.list()].map(e=>e.term)};const n=e.out([ae.inversePath]);if(n.term)return{quantifier:"one",start:"object",end:"subject",predicates:[n.term]};const r=e.out([ae.oneOrMorePath]);if(r.term)return{quantifier:"oneOrMore",start:"subject",end:"object",predicates:[r.term]};const i=e.out([ae.zeroOrMorePath]);if(i.term)return{quantifier:"zeroOrMore",start:"subject",end:"object",predicates:[i.term]};const s=e.out([ae.zeroOrOnePath]);return s.term?{quantifier:"zeroOrOne",start:"subject",end:"object",predicates:[s.term]}:void 0}function Mp(e){return 0===e.terms.length?null:e.ptrs[0].isList()?[...e.list()].map(e=>Hu(e)):[Hu(e)]}class Bp{constructor(e){this.shape=e,this._compiled=_t(()=>this.shape.validator.registry.compile(e))}get compiled(){return this._compiled()}async validate(e){return 0===e.focusNode.dataset.size||(this.shape.isPropertyShape?await this.validateProperty(e):await this.validateNode(e)),e}async validateNode(e){const t=e.create({shape:this.shape,valueOrNode:e.value||e.focusNode});for(const e of this.compiled)e.node&&await e.node(t),e.generic&&await e.generic(t)}async validateProperty(e){let t;t=this.shape.isSparqlShape?e.focusNode:e.focusNode.executeAll(this.shape.path);const n=t.node(new ft(t.terms)),r=[...t].reduce((e,n)=>{const r=n.term,i=t.node([r]);return e.has(r)||e.set(r,{value:i,valuePaths:[]}),e.get(r).valuePaths.push(n),e},new $r).values(),i=e.create({shape:this.shape,values:n});for(const e of this.compiled)e.property&&await e.property(i);for(const{value:t,valuePaths:n}of r){const r=e.create({shape:this.shape,value:t,valueOrNode:t,valuePaths:n});for(const e of this.compiled)e.generic&&await e.generic(r)}}}function pa(e){const t=new ft,n=new ni({dataset:e.dataset,terms:e.terms}).execute({quantifier:"zeroOrMore",start:"object",end:"subject",predicates:[lp.subClassOf]});for(const e of n.ptrs)for(const{term:n}of e.nodes())t.add(n);return t}class qp{constructor(e){this.targetClass=new ft([...pa(e.hasOut([fr.type],[ae.NodeShape])),...pa(e.out([ae.targetClass]))]),this.targetNode=e.out([ae.targetNode]).terms,this.targetObjectsOf=e.out([ae.targetObjectsOf]).terms,this.targetSubjectsOf=e.out([ae.targetSubjectsOf]).terms}resolve(e){const t=e.focusNode.node([null]),n=[...e.focusNode.hasOut([fr.type],this.targetClass).ptrs,...e.focusNode.node(this.targetNode).ptrs,...t.execute({start:"object",end:"object",predicates:this.targetObjectsOf}).ptrs,...t.execute({start:"subject",end:"subject",predicates:this.targetSubjectsOf}).ptrs],r=e.focusNode.clone({ptrs:n});return r.node([...new ft(r.terms)])}}class Up{constructor(e,{validator:t}){this.ptr=e,this.validator=t,this._deactivated=_t(()=>{const e=this.ptr.out([ae.deactivated]).term;return e&&In.fromRdf(e)}),this._message=_t(()=>this.ptr.out([ae.message]).terms),this._path=_t(()=>Mp(this.ptr.out([ae.path]))),this._severity=_t(()=>this.ptr.out([ae.severity]).term),this._shapeValidator=_t(()=>new Bp(this)),this._sparql=_t(()=>this.ptr.out([ae.sparql])),this._targetResolver=_t(()=>new qp(this.ptr))}get deactivated(){return this._deactivated()}get isPropertyShape(){return!!this.path}get isSparqlShape(){return this.sparql.terms.length>0}get path(){return this._path()}get targetResolver(){return this._targetResolver()}get message(){return this._message()}get severity(){return this._severity()}get shapeValidator(){return this._shapeValidator()}get sparql(){return this._sparql()}resolveTargets(e){return this.targetResolver.resolve(e)}async validate(e){const t=e.id({shape:this});if(e.processed.has(t)){if(e.results.has(t))for(const n of e.results.get(t))e.report.results.push(n);return e}return e.processed.add(t),this.shapeValidator.validate(e)}}function Hp(e){return{property:Vp(parseInt(e.ptr.out([ae.maxCount]).value))}}function Vp(e){return t=>{t.test(t.values.terms.length<=e,ae.MaxCountConstraintComponent,{args:{maxCount:e},message:[t.factory.literal("More than {$maxCount} values")]})}}function Gp(e){return{property:Wp(parseInt(e.ptr.out([ae.minCount]).value))}}function Wp(e){return t=>{t.test(t.values.terms.length>=e,ae.MinCountConstraintComponent,{args:{minCount:e},message:[t.factory.literal("Less than {$minCount} values")]})}}async function zp(e,t){for(const n of e)if(!await t(n))return!1;return!0}async function Qp(e,t){return(await Promise.all(e.map(e=>t(e)))).filter(Boolean)}async function mi(e,t){return Promise.all(e.map(t))}async function Xp(e,t){for(const n of e)if(await t(n))return!0;return!1}function Jp(e){return{generic:Kp([...e.ptr.out([ae.and])].flatMap(e=>[...e.list()]).map(t=>e.validator.shape(t)))}}function Kp(e){return async t=>{const n=await mi(e,async e=>(await e.validate(t.create({child:!0,focusNode:t.valueOrNode}))).report),r=n.every(e=>e.conforms);t.test(r,ae.AndConstraintComponent,{results:n.flatMap(e=>e.results),value:t.valueOrNode})}}function Yp(e){return{generic:Zp(e.validator.shape(e.ptr.out([ae.not])))}}function Zp(e){return async t=>{const n=(await e.validate(t.create({child:!0,focusNode:t.valueOrNode}))).report,r=!n.conforms;t.test(r,ae.NotConstraintComponent,{args:{not:e.ptr.term},message:[t.factory.literal("Value does have shape {$not}")],results:n.results,value:t.valueOrNode})}}function eg(e){return{generic:tg([...e.ptr.out([ae.or])].flatMap(e=>[...e.list()]).map(t=>e.validator.shape(t)))}}function tg(e){return async t=>{let n,r=[];if(t.options.debug||t.options.details){const i=await mi(e,async e=>(await e.validate(t.create({child:!0,focusNode:t.valueOrNode}))).report);r=i.flatMap(e=>e.results),n=i.some(e=>e.conforms)}else n=await Xp(e,async e=>(await e.validate(t.create({child:!0,focusNode:t.valueOrNode}))).report.conforms);t.test(n,ae.OrConstraintComponent,{results:r,value:t.valueOrNode})}}function rg(e){return{generic:ng([...e.ptr.out([ae.xone])].flatMap(e=>[...e.list()]).map(t=>e.validator.shape(t)))}}function ng(e){return async t=>{const n=await mi(e,async e=>(await e.validate(t.create({child:!0,focusNode:t.valueOrNode}))).report),r=1===n.filter(e=>e.conforms).length;t.test(r,ae.XoneConstraintComponent,{results:n.flatMap(e=>e.results),value:t.valueOrNode})}}function ig(e){if(!In.fromRdf(e.ptr.out([ae.closed]).term))return null;const t=e.ptr.out([ae.property]).map(t=>e.validator.shape(t));return{node:sg(new ft(t.filter(e=>!e.deactivated).map(e=>e.path[0].predicates[0])),new ft([...e.ptr.out([ae.ignoredProperties]).list()||[]].map(e=>e.term)))}}function sg(e,t){return n=>{const r=n.focusNode.execute({start:"subject",end:"predicate"}).filter(n=>!t.has(n.term)&&!e.has(n.term));if(r.ptrs.length>0)for(const e of r)n.violation(ae.ClosedConstraintComponent,{message:[n.factory.literal("Predicate is not allowed (closed shape)")],path:[{quantifier:"one",start:"subject",end:"object",predicates:[e.term]}],value:n.focusNode.node([[...e.quads()][0].object])});else n.debug(ae.ClosedConstraintComponent)}}function ag(e){const t=e.ptr.out([ae.hasValue]).term;return{node:og(t),property:lg(t)}}function og(e){return t=>{t.test(e.equals(t.valueOrNode.term),ae.HasValueConstraintComponent,{args:{hasValue:e},message:[t.factory.literal("Value must be {$hasValue}")]})}}function lg(e){return t=>{const n=[...t.values].some(t=>e.equals(t.term));t.test(n,ae.HasValueConstraintComponent,{args:{hasValue:e},message:[t.factory.literal("Missing expected value {$hasValue}")]})}}function ug(e){return{generic:cg(new ft([...e.ptr.out([ae.in]).list()].map(e=>e.term)))}}function cg(e){return t=>{t.test(e.has(t.valueOrNode.term),ae.InConstraintComponent,{args:{in:[...e].map(e=>e.value).join(", ")},message:[t.factory.literal("Value is not in {$in}")],value:t.valueOrNode})}}function Fr(e,t){if(!e||"Literal"!==e.termType||!t||"Literal"!==t.termType||Vu(e)!==Vu(t))return null;const n=In.fromRdf(e),r=In.fromRdf(t);return typeof n!=typeof r?null:"string"==typeof n?n.localeCompare(r):n-r}function Vu(e){return Ha.dateTime.equals(e.datatype)&&/^.*(((\+|-)\d{2}:\d{2})|Z)$/.test(e.value)}function dg(e){return{generic:hg(e.ptr.out([ae.disjoint]).term)}}function hg(e){return t=>{const n=t.focusNode.dataset.match(t.focusNode.term,e,t.valueOrNode.term);t.test(0===n.size,ae.DisjointConstraintComponent,{args:{disjoint:e},message:[t.factory.literal("Value node must not also be one of the values of {$disjoint}")],value:t.valueOrNode})}}function fg(e){const t=e.ptr.out([ae.equals]).term;return{node:pg(t),property:gg(t)}}function pg(e){return t=>{const n=t.focusNode.out([e]),r=n.filter(e=>!e.term.equals(t.focusNode.term)),i=0!==n.terms.length&&0===r.terms.length;t.test(i,ae.EqualsConstraintComponent,{args:{equals:e},message:[t.factory.literal("Must have same values as {$equals}")],value:r.terms[0]&&t.focusNode.node([r.terms[0]])||t.focusNode})}}function gg(e){return t=>{const n=new ft(t.focusNode.out([e]).terms),r=new ft(t.values.terms),i=[...[...r].filter(e=>!n.has(e)),...[...n].filter(e=>!r.has(e))];for(const n of i)t.violation(ae.EqualsConstraintComponent,{args:{equals:e},message:[t.factory.literal("Must have same values as {$equals}")],value:t.focusNode.node([n])});0===i.length&&t.debug(ae.EqualsConstraintComponent,{args:{equals:e},message:[t.factory.literal("Must have same values as {$equals}")]})}}function mg(e){return{property:yg(e.ptr.out([ae.lessThan]).term)}}function yg(e){return t=>{const n=t.focusNode.out([e]).terms;for(const r of t.values)for(const i of n){const n=Fr(r.term,i);null===n||n>=0?t.violation(ae.LessThanConstraintComponent,{args:{lessThan:e},message:[t.factory.literal("Value is not less than value of {$lessThan}")],value:r}):t.debug(ae.LessThanConstraintComponent,{args:{lessThan:e},message:[t.factory.literal("Value is not less than value of {$lessThan}")],value:r})}}}function bg(e){return{property:_g(e.ptr.out([ae.lessThanOrEquals]).term)}}function _g(e){return t=>{const n=t.focusNode.out([e]).terms;for(const r of t.values)for(const i of n){const n=Fr(r.term,i);null===n||n>0?t.violation(ae.LessThanOrEqualsConstraintComponent,{args:{lessThanOrEquals:e},message:[t.factory.literal("Value is not less than or equal to value of {$lessThanOrEquals}")],value:r}):t.debug(ae.LessThanOrEqualsConstraintComponent,{args:{lessThanOrEquals:e},message:[t.factory.literal("Value is not less than or equal to value of {$lessThanOrEquals}")],value:r})}}}function wg(e){return{generic:vg(e.ptr.out([ae.maxExclusive]).term)}}function vg(e){return t=>{const n=Fr(t.valueOrNode.term,e);t.test(null!==n&&n<0,ae.MaxExclusiveConstraintComponent,{args:{maxExclusive:e},message:[t.factory.literal("Value is not less than {$maxExclusive}")],value:t.valueOrNode})}}function xg(e){return{generic:Eg(e.ptr.out([ae.maxInclusive]).term)}}function Eg(e){return t=>{const n=Fr(t.valueOrNode.term,e);t.test(null!==n&&n<=0,ae.MaxInclusiveConstraintComponent,{args:{maxInclusive:e},message:[t.factory.literal("Value is not less than or equal to {$maxInclusive}")],value:t.valueOrNode})}}function Sg(e){return{generic:Ig(e.ptr.out([ae.minExclusive]).term)}}function Ig(e){return t=>{const n=Fr(t.valueOrNode.term,e);t.test(null!==n&&n>0,ae.MinExclusiveConstraintComponent,{args:{minExclusive:e},message:[t.factory.literal("Value is not greater than {$minExclusive}")],value:t.valueOrNode})}}function Ng(e){return{generic:Rg(e.ptr.out([ae.minInclusive]).term)}}function Rg(e){return t=>{const n=Fr(t.valueOrNode.term,e);t.test(null!==n&&n>=0,ae.MinInclusiveConstraintComponent,{args:{minInclusive:e},message:[t.factory.literal("Value is not greater than or equal to {$minInclusive}")],value:t.valueOrNode})}}function Tg(e){return{generic:Ag([...e.ptr.out([ae.node])].map(t=>e.validator.shape(t)))}}function Ag(e){return async t=>{for(const n of e){const e=await n.validate(t.create({child:!0,focusNode:t.valueOrNode}));t.test(e.report.conforms,ae.NodeConstraintComponent,{args:{node:n.ptr.term},message:[t.factory.literal("Value does not have shape {$node}")],results:e.report.results,value:t.valueOrNode})}}}function Dg(e){return{generic:Lg([...e.ptr.out([ae.property])].map(t=>e.validator.shape(t)))}}function Lg(e){return async t=>{const n=t.create({focusNode:t.valueOrNode});for(const t of e)await t.validate(n)}}function Og(e){const t=e.validator.shape(e.ptr.out([ae.qualifiedValueShape])),n=e.ptr.out([ae.qualifiedValueShapesDisjoint]).term,r=!!n&&In.fromRdf(n),i=e.ptr.out([ae.qualifiedMaxCount]).term,s=i?parseInt(i.value):null,o=e.ptr.out([ae.qualifiedMinCount]).term;return{property:Cg(t,r,s,o?parseInt(o.value):null)}}function Cg(e,t,n,r){return async i=>{const s=[];let o=[];t&&(o=new Set(i.shape.ptr.in([ae.property]).out([ae.property]).out([ae.qualifiedValueShape]).filter(t=>!t.term.equals(e.ptr.term)).map(e=>i.shape.validator.shape(e))));const a=(await Qp(i.values,async t=>{const n=(await e.validate(i.create({child:!0,focusNode:t}))).report;if(s.push(n.results),!n.conforms)return!1;if(0===o.length)return!0;if(i.options.debug||i.options.details){const e=await mi([...o],async e=>(await e.validate(i.create({child:!0,focusNode:t}))).report);return s.push(e.flatMap(e=>e.results)),!e.every(e=>e.conforms)}return!await zp([...o],async e=>(await e.validate(i.create({child:!0,focusNode:t}))).report.conforms)})).length;null!==n&&i.test(a<=n,ae.QualifiedMaxCountConstraintComponent,{args:{qualifiedMaxCount:n,qualifiedValueShape:e.ptr.term,qualifiedValueShapesDisjoint:t},message:[i.factory.literal("More than {$qualifiedMaxCount} values have shape {$qualifiedValueShape}")],results:s.flat()}),null!==r&&i.test(a>=r,ae.QualifiedMinCountConstraintComponent,{args:{qualifiedMinCount:r,qualifiedValueShape:e.ptr.term,qualifiedValueShapesDisjoint:t},message:[i.factory.literal("Less than {$qualifiedMinCount} values have shape {$qualifiedValueShape}")],results:s.flat()})}}function jg(e,t){return!!t&&t.slice(0,e.length)===e}function $g(e){return{generic:Fg([...new Set([...e.ptr.out([ae.languageIn]).list()].map(e=>e.value))])}}function Fg(e){return t=>{const n=e.some(e=>jg(e,t.valueOrNode.term.language));t.test(n,ae.LanguageInConstraintComponent,{args:{languageIn:e.join(", ")},message:[t.factory.literal("Language does not match any of {$languageIn}")],value:t.valueOrNode})}}function kg(e){return{generic:Pg(parseInt(e.ptr.out([ae.maxLength]).value))}}function Pg(e){return t=>{const n="BlankNode"!==t.valueOrNode.term.termType&&t.valueOrNode.value.length<=e;t.test(n,ae.MaxLengthConstraintComponent,{args:{maxLength:e},message:[t.factory.literal("Value has more than {$maxLength} characters")],value:t.valueOrNode})}}function Mg(e){return{generic:Bg(parseInt(e.ptr.out([ae.minLength]).value))}}function Bg(e){return t=>{const n="BlankNode"!==t.valueOrNode.term.termType&&t.valueOrNode.value.length>=e;t.test(n,ae.MinLengthConstraintComponent,{args:{minLength:e},message:[t.factory.literal("Value has less than {$minLength} characters")],value:t.valueOrNode})}}function qg(e){const t=e.ptr.out([ae.pattern]).value,n=e.ptr.out([ae.flags]).value;return{generic:Ug(t,n,new RegExp(t,n))}}function Ug(e,t,n){return r=>{r.test(n.test(r.valueOrNode.term.value),ae.PatternConstraintComponent,{args:{flags:t,pattern:e},message:[r.factory.literal('Value does not match pattern "{$pattern}"')],value:r.valueOrNode})}}function Hg(e){const t=e.ptr.out([ae.uniqueLang]).term;return"true"===t.value&&Ha.boolean.equals(t.datatype)?{property:Vg()}:null}function Vg(){return e=>{const t=Object.entries(e.values.terms.reduce((e,t)=>(t.language&&(e[t.language]=(e[t.language]||0)+1),e),{})).filter(([,e])=>e>1);for(const[n]of t)e.violation(ae.UniqueLangConstraintComponent,{args:{lang:n},message:[e.factory.literal('Language "{?lang}" used more than once')]});0===t.length&&e.debug(ae.UniqueLangConstraintComponent)}}const Yn=mt("http://www.w3.org/ns/shacl#"),Jc=mt("https://schemas.link/shacl-next#");class Or{constructor({results:e=[]}={}){this.results=e}get conforms(){return!this.results.some(e=>e.severity.equals(Yn.Info)||e.severity.equals(Yn.Violation)||e.severity.equals(Yn.Warning))}}function Gg(e,t){return Object.entries(t).reduce((e,[t,n])=>(n&&n.termType&&(n=ot(n)),e.replace(`{$${t}}`,n).replace(`{?${t}}`,n)),e)}class ii{constructor({args:e={},factory:t,message:n=[],severity:r=Yn.Violation}={}){this.severity=r,this.message=n.map(n=>t.literal(Gg(n.value,e),n.language||null))}}class Ga{constructor({factory:e=Ua}={}){this.factory=e}clone({factory:e}={}){return new Ga({factory:e||this.factory})}validate(){return new Or}validateSimple(){return!0}}class kr extends Ga{constructor({datatypes:e,factory:t}={}){super({factory:t}),this.datatypes=[];for(const t of Array.isArray(e)?e:[e])t&&this.datatypes.push(this.factory.fromTerm(t))}clone({factory:e}={}){return new kr({datatypes:this.datatypes,factory:e||this.factory})}}class Wg{constructor({factory:e=Ua,validations:t}={}){if(this.factory=e,this.validations=new $r,t)for(const e of Object.values(t)){const t=e.clone({factory:this.factory});for(const e of t.datatypes)this.validations.set(e,t)}}validate(e){const t=this.validations.get(e.datatype);return t?t.validate(e):new Or}validateSimple(e){const t=this.validations.get(e.datatype);return!t||t.validateSimple(e)}}class Pe extends kr{constructor(e,t,{factory:n}={}){super({datatypes:t,factory:n}),this.message=[this.factory.literal("term value {$this} matches pattern {$pattern}")],this.patterns=Array.isArray(e)?e:[e]}clone({factory:e}={}){return new Pe(this.patterns,this.datatypes,{factory:e||this.factory})}validate(e){const t=this.patterns.map(t=>{let n;t.test(e.value)&&(n=Jc.Debug);const r={pattern:this.factory.literal(t.toString()),this:e};return new ii({args:r,factory:this.factory,message:this.message,severity:n})});return new Or({results:t})}validateSimple(e){return this.patterns.every(t=>t.test(e.value))}}const zg=/^([-+]?[0-9]+)$/;class st extends Pe{constructor(e=null,t=null,n,{factory:r}={}){super(zg,n,{factory:r}),this.maxInclusive=null,this.minInclusive=null,"string"==typeof t&&(this.maxInclusive=BigInt(t)),"string"==typeof e&&(this.minInclusive=BigInt(e))}clone({factory:e}={}){return new st(this.minInclusive?.toString(),this.maxInclusive?.toString(),this.datatypes,{factory:e||this.factory})}validate(e){const t=super.validate(e).results;if(!Jc.Debug.equals(t[0].severity))return new Or({results:t});const n=BigInt(e.value);if(null!==this.minInclusive&&n<this.minInclusive){const n=`term value "${e.value}" is less than "${this.minInclusive.toString()}"`,r=[this.factory.literal(n)];t.push(new ii({factory:this.factory,message:r}))}if(null!==this.maxInclusive&&n>this.maxInclusive){const n=`term value "${e.value}" is greater than "${this.maxInclusive.toString()}"`,r=[this.factory.literal(n)];t.push(new ii({factory:this.factory,message:r}))}return new Or({results:t})}validateSimple(e){if(!super.validateSimple(e))return!1;const t=BigInt(e.value);return!(null!==this.minInclusive&&t<this.minInclusive||null!==this.maxInclusive&&t>this.maxInclusive)}}class Wa extends kr{constructor(e,t,{factory:n}={}){super({datatypes:t,factory:n}),this.values=new Set(e)}clone({factory:e}={}){return new Wa(this.values,this.datatypes,{factory:e||this.factory})}validate(e){const t=[];if(!this.values.has(e.value)){const n=`term value "${e.value}" is not included in the list: ${[...this.values].join(",")}`,r=[this.factory.literal(n)];t.push(new ii({factory:this.factory,message:r}))}return new Or({results:t})}validateSimple(e){return this.values.has(e.value)}}const Te={xsd:mt("http://www.w3.org/2001/XMLSchema#")},Qg=new kr({datatypes:Te.xsd.anySimpleType}),Xg=new kr({datatypes:Te.xsd.anyAtomicType}),yi=/^([^\ud8ff-\udfff\ufffe-\uffff]*)$/,Jg=/^((\+|-)?([0-9]+(\.[0-9]*)?|\.[0-9]+))$/,Kc=/^((\+|-)?([0-9]+(\.[0-9]*)?|\.[0-9]+)([Ee](\+|-)?[0-9]+)?|(\+|-)?INF|NaN)$/,za=/^(-?P((([0-9]+Y([0-9]+M)?([0-9]+D)?|([0-9]+M)([0-9]+D)?|([0-9]+D))(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))?)|(T(([0-9]+H)([0-9]+M)?([0-9]+(\.[0-9]+)?S)?|([0-9]+M)([0-9]+(\.[0-9]+)?S)?|([0-9]+(\.[0-9]+)?S)))))$/,Yc=/^(-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])T(([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,Kg=/^((([01][0-9]|2[0-3]):[0-5][0-9]:[0-5][0-9](\.[0-9]+)?|(24:00:00(\.0+)?))(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,Yg=/^(-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,Zg=/^(-?([1-9][0-9]{3,}|0[0-9]{3})-(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,em=/^(-?([1-9][0-9]{3,}|0[0-9]{3})(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,tm=/^(--(0[1-9]|1[0-2])-(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,rm=/^(---(0[1-9]|[12][0-9]|3[01])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,nm=/^(--(0[1-9]|1[0-2])(Z|(\+|-)((0[0-9]|1[0-3]):[0-5][0-9]|14:00))?)$/,im=/^(([0-9a-fA-F]{2})*)$/,sm=/^(((([A-Za-z0-9+/] ?){4})*(([A-Za-z0-9+/] ?){3}[A-Za-z0-9+/]|([A-Za-z0-9+/] ?){2}[AEIMQUYcgkosw048] ?=|[A-Za-z0-9+/] ?[AQgw] ?= ?=))?)$/,am=new Pe(yi,Te.xsd.string),om=new Wa(["1","true","0","false"],Te.xsd.boolean),lm=new Pe(Jg,Te.xsd.decimal),um=new Pe(Kc,Te.xsd.float),cm=new Pe(Kc,Te.xsd.double),dm=new Pe(za,Te.xsd.duration),hm=new Pe(Yc,Te.xsd.dateTime),fm=new Pe(Kg,Te.xsd.time),pm=new Pe(Yg,Te.xsd.date),gm=new Pe(Zg,Te.xsd.gYearMonth),mm=new Pe(em,Te.xsd.gYear),ym=new Pe(tm,Te.xsd.gMonthDay),bm=new Pe(rm,Te.xsd.gDay),_m=new Pe(nm,Te.xsd.gMonth),wm=new Pe(im,Te.xsd.hexBinary),vm=new Pe(sm,Te.xsd.base64Binary),xm=new Pe(yi,Te.xsd.anyURI),Zc=/^([^\u000d\u000a\u0009]*)$/,Em=/^([^ ]+( [^ ]+)*)*$/,Sm=/^([a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*)$/,Im=/^([^DT]*)$/,Nm=/^([^YM]*[DT].*)$/,Rm=/^(.*(Z|(\+|-)[0-9][0-9]:[0-9][0-9]))$/,Tm=new Pe([yi,Zc],Te.xsd.normalizedString),Am=new Pe([yi,Zc,Em],Te.xsd.token),Dm=new Pe(Sm,Te.xsd.language),Lm=new st(null,null,Te.xsd.integer),Om=new st(null,"0",Te.xsd.nonPositiveInteger),Cm=new st(null,"-1",Te.xsd.negativeInteger),jm=new st("-9223372036854775808","9223372036854775807",Te.xsd.long),$m=new st("-2147483648","2147483647",Te.xsd.int),Fm=new st("-32768","32767",Te.xsd.short),km=new st("-128","127",Te.xsd.byte),Pm=new st("0",null,Te.xsd.nonNegativeInteger),Mm=new st("0","18446744073709551615",Te.xsd.unsignedLong),Bm=new st("0","4294967295",Te.xsd.unsignedInt),qm=new st("0","65535",Te.xsd.unsignedShort),Um=new st("0","255",Te.xsd.unsignedByte),Hm=new st("1",null,Te.xsd.positiveInteger),Vm=new Pe([za,Im],Te.xsd.yearMonthDuration),Gm=new Pe([za,Nm],Te.xsd.dayTimeDuration),Wm=new Pe([Yc,Rm],Te.xsd.dateTimeStamp),zm=Object.freeze(Object.defineProperty({__proto__:null,anyAtomicType:Xg,anySimpleType:Qg,anyURI:xm,base64Binary:vm,boolean:om,byte:km,date:pm,dateTime:hm,dateTimeStamp:Wm,dayTimeDuration:Gm,decimal:lm,double:cm,duration:dm,float:um,gDay:bm,gMonth:_m,gMonthDay:ym,gYear:mm,gYearMonth:gm,hexBinary:wm,int:$m,integer:Lm,language:Dm,long:jm,negativeInteger:Cm,nonNegativeInteger:Pm,nonPositiveInteger:Om,normalizedString:Tm,positiveInteger:Hm,short:Fm,string:am,time:fm,token:Am,unsignedByte:Um,unsignedInt:Bm,unsignedLong:Mm,unsignedShort:qm,yearMonthDuration:Vm},Symbol.toStringTag,{value:"Module"}));class Qm extends Wg{constructor({factory:e}={}){super({factory:e,validations:{...zm}})}}const Xm=new $r([[ae.BlankNode,new Set(["BlankNode"])],[ae.BlankNodeOrIRI,new Set(["BlankNode","NamedNode"])],[ae.BlankNodeOrLiteral,new Set(["BlankNode","Literal"])],[ae.IRI,new Set(["NamedNode"])],[ae.IRIOrLiteral,new Set(["NamedNode","Literal"])],[ae.Literal,new Set(["Literal"])]]);function Jm(e){return{generic:Km(e.ptr.out([ae.class]).map(e=>pa(e)))}}function Km(e){return t=>{const n=new ft(t.valueOrNode.out([fr.type]).terms);for(const r of e){const e=[...n].some(e=>r.has(e));t.test(e,ae.ClassConstraintComponent,{value:t.valueOrNode})}}}function Ym(e){return{generic:Zm(e.ptr.out([ae.datatype]).term,new Qm)}}function Zm(e,t){return n=>{const r=e.equals(n.valueOrNode.term.datatype)&&t.validateSimple(n.valueOrNode.term);n.test(r,ae.DatatypeConstraintComponent,{args:{datatype:e},message:[n.factory.literal("Value does not have datatype {$datatype}")],value:n.valueOrNode})}}function ey(e){const t=e.ptr.out([ae.nodeKind]).term;return{generic:ty(t,Xm.get(t))}}function ty(e,t){return n=>{n.test(t.has(n.valueOrNode.term.termType),ae.NodeKindConstraintComponent,{args:{nodeKind:e},message:[n.factory.literal("Value does not have node kind {$nodeKind}")],value:n.valueOrNode})}}const ry=new $r([[ae.maxCount,Hp],[ae.minCount,Gp],[ae.and,Jp],[ae.not,Yp],[ae.or,eg],[ae.xone,rg],[ae.closed,ig],[ae.hasValue,ag],[ae.in,ug],[ae.disjoint,dg],[ae.equals,fg],[ae.lessThan,mg],[ae.lessThanOrEquals,bg],[ae.maxExclusive,wg],[ae.maxInclusive,xg],[ae.minExclusive,Sg],[ae.minInclusive,Ng],[ae.node,Tg],[ae.property,Dg],[ae.qualifiedValueShape,Og],[ae.languageIn,$g],[ae.maxLength,kg],[ae.minLength,Mg],[ae.pattern,qg],[ae.uniqueLang,Hg],[ae.class,Jm],[ae.datatype,Ym],[ae.nodeKind,ey]]);class ny{constructor(e,{factory:t,...n}){if(this.factory=t,this.options=n,this.registry=new Lp(ry),this.shapesPtr=new ni({dataset:e,factory:t}),this.shapes=new $r,this.options.coverage&&(this.options.debug=!0,this.options.details=!0,this.options.trace=!0),this.options.validations)for(const[e,t]of this.options.validations)this.registry.validations.set(e,t);const r=[...this.shapesPtr.hasOut([ae.targetClass]),...this.shapesPtr.hasOut([ae.targetNode]),...this.shapesPtr.hasOut([ae.targetObjectsOf]),...this.shapesPtr.hasOut([ae.targetSubjectsOf]),...this.shapesPtr.hasOut([fr.type],[ae.NodeShape]),...this.shapesPtr.hasOut([fr.type],[ae.PropertyShape])];for(const e of r)this.shape(e)}shape(e){if(!e.term)return null;let t=this.shapes.get(e.term);return t||(t=new Up(e,{validator:this}),this.shapes.set(e.term,t)),t}async validate(e,t){const n=new ni({...e,factory:this.factory}),r=new Va({factory:this.factory,focusNode:n,options:this.options,validator:this});t=t?t.map(e=>this.shape(this.shapesPtr.node(e.terms))):this.shapes.values();for(const e of t){const t=r.create({shape:e});let i;i=n.isAny()?e.resolveTargets(t):n;for(const n of i)await e.validate(t.create({focusNode:n}))}return r.report}}let iy=class extends HTMLElement{constructor(e){super(),this.shape=null,this.attachShadow({mode:"open"}),this.form=document.createElement("form"),this.config=new ou(e,this.form),this.form.addEventListener("change",e=>{e.stopPropagation(),this.config.editMode&&this.validate(!0).then(e=>{this.dispatchEvent(new CustomEvent("change",{bubbles:!0,cancelable:!1,composed:!0,detail:{valid:e.conforms,report:e}}))}).catch(e=>{console.warn(e)})})}static get observedAttributes(){return ou.dataAttributes()}connectedCallback(){this.shadowRoot.prepend(this.form)}attributeChangedCallback(){this.config.updateAttributes(this),this.initialize()}initialize(){clearTimeout(this.initDebounceTimeout),this.initDebounceTimeout=setTimeout(async()=>{this.form.replaceChildren(document.createTextNode(this.config.attributes.loading));try{await this.config.loader.loadGraphs(),this.form.replaceChildren(),this.config.renderedNodes.clear();const e=this.findRootShaclShapeSubject();if(e){this.form.classList.forEach(e=>{this.form.classList.remove(e)}),this.form.classList.toggle("mode-edit",this.config.editMode),this.form.classList.toggle("mode-view",!this.config.editMode),this.config.theme.apply(this.form);const t=[this.config.theme.stylesheet];for(const e of Zd())e.stylesheet&&t.push(e.stylesheet);if(this.shadowRoot.adoptedStyleSheets=t,this.shape=new Wt(e,this.config,this.config.attributes.valuesSubject?Ne.namedNode(this.config.attributes.valuesSubject):void 0),this.form.appendChild(this.shape),this.config.editMode){if(null!==this.config.attributes.submitButton){const e=this.config.theme.createButton(this.config.attributes.submitButton||"Submit",!0);e.addEventListener("click",e=>{e.preventDefault(),this.form.reportValidity()&&this.validate().then(e=>{if(e?.conforms)this.dispatchEvent(new Event("submit",{bubbles:!0,cancelable:!0}));else{let e=this.form.querySelector(":scope .invalid > .editor");e?e.focus():this.form.querySelector(":scope .invalid")?.scrollIntoView()}})}),this.form.appendChild(e)}this.config.attributes.valuesSubject&&this.removeFromDataGraph(Ne.namedNode(this.config.attributes.valuesSubject)),await this.validate(!0)}}else if(this.config.store.countQuads(null,null,null,mn)>0)throw new Error("shacl root node shape not found")}catch(e){console.error(e);const t=document.createElement("div");t.innerText=String(e),this.form.replaceChildren(t)}},200)}serialize(e="text/turtle",t=this.toRDF()){return Xd(t.getQuads(null,null,null,null),e,this.config.prefixes)}toRDF(e=new et){return this.shape?.toRDF(e),e}registerPlugin(e){Yd(e),this.initialize()}setTheme(e){this.config.theme=e,this.initialize()}setClassInstanceProvider(e){this.config.classInstanceProvider=e,this.initialize()}async validate(e=!1){for(const e of this.form.querySelectorAll(":scope .validation-error"))e.remove();for(const e of this.form.querySelectorAll(":scope .property-instance"))e.classList.remove("invalid"),e.querySelector(":scope > .editor")?.value?e.classList.add("valid"):e.classList.remove("valid");this.config.store.deleteGraph(this.config.valuesGraphId||""),this.shape&&(this.shape.toRDF(this.config.store),this.config.store.add(new si(this.shape.shaclSubject,Ne.namedNode(xe+"targetNode"),this.shape.nodeId,this.config.valuesGraphId)));try{const t=this.config.store,n=await new ny(t,{details:!0,factory:Ne}).validate({dataset:t});for(const t of n.results)if(t.focusNode?.ptrs?.length)for(const n of t.focusNode.ptrs){const r=n._term;if(t.path?.length){const n=t.path[0].predicates[0];let i=this.form.querySelectorAll(`\n                                :scope shacl-node[data-node-id='${r.id}'] > shacl-property > .property-instance[data-path='${n.id}'] > .editor,\n                                :scope shacl-node[data-node-id='${r.id}'] > shacl-property > .shacl-group > .property-instance[data-path='${n.id}'] > .editor,\n                                :scope shacl-node[data-node-id='${r.id}'] > .shacl-group > shacl-property > .property-instance[data-path='${n.id}'] > .editor,\n                                :scope shacl-node[data-node-id='${r.id}'] > .shacl-group > shacl-property > .shacl-group > .property-instance[data-path='${n.id}'] > .editor`);0===i.length&&(i=this.form.querySelectorAll(`\n                                    :scope [data-node-id='${r.id}']  > shacl-property > .property-instance[data-path='${n.id}'],\n                                    :scope [data-node-id='${r.id}']  > shacl-property > .shacl-group > .property-instance[data-path='${n.id}']`));for(const n of i)if(n.classList.contains("editor")){if(!e||n.value){let e=n.parentElement;e.classList.add("invalid"),e.classList.remove("valid"),e.appendChild(this.createValidationErrorDisplay(t));do{e instanceof nt&&(e.open=!0),e=e.parentElement}while(e)}}else e||(n.classList.add("invalid"),n.classList.remove("valid"),n.appendChild(this.createValidationErrorDisplay(t,"node")))}else e||this.form.querySelector(`:scope [data-node-id='${r.id}']`)?.prepend(this.createValidationErrorDisplay(t,"node"))}return n}catch(e){return console.error(e),!1}}createValidationErrorDisplay(e,t){const n=document.createElement("span");if(n.classList.add("validation-error"),t&&n.classList.add(t),e)if(e.message?.length>0)for(const t of e.message)n.title+=t.value+"\n";else n.title=e.sourceConstraintComponent?.value;return n}findRootShaclShapeSubject(){let e=null;if(this.config.attributes.shapeSubject){if(e=Ne.namedNode(this.config.attributes.shapeSubject),0===this.config.store.getQuads(e,tt,Un,null).length)return void console.warn(`shapes graph does not contain requested root shape ${this.config.attributes.shapeSubject}`)}else if(this.config.attributes.valuesSubject&&this.config.store.countQuads(null,null,null,Dt)>0){const t=Ne.namedNode(this.config.attributes.valuesSubject),n=[...this.config.store.getQuads(t,tt,null,Dt),...this.config.store.getQuads(t,sa,null,Dt)];if(0===n.length)return void console.warn(`value subject '${this.config.attributes.valuesSubject}' has neither ${tt.id} nor ${sa.id} statement`);for(const t of n)if(this.config.store.getQuads(t.object,tt,Un,null).length>0){e=t.object;break}if(!e){const t=this.config.store.getQuads(null,Nr,n[0].object,null);if(0===t.length)return void console.error(`value subject '${this.config.attributes.valuesSubject}' has no shacl shape definition in the shapes graph`);if(t.length>1&&console.warn(`value subject '${this.config.attributes.valuesSubject}' has multiple shacl shape definitions in the shapes graph, choosing the first found (${t[0].subject})`),0===this.config.store.getQuads(t[0].subject,tt,Un,null).length)return void console.error(`value subject '${this.config.attributes.valuesSubject}' references a shape which is not a NodeShape (${t[0].subject})`);e=t[0].subject}}else{const t=this.config.store.getQuads(null,tt,Un,null);if(0==t.length)return void console.warn("shapes graph does not contain any root shapes");t.length>1&&(console.warn("shapes graph contains",t.length,"root shapes. choosing first found which is",t[0].subject.value),console.info('hint: set the shape to use with attribute "data-shape-subject"')),e=t[0].subject}return e}removeFromDataGraph(e){this.config.attributes.valuesSubject;for(const t of this.config.store.getQuads(e,null,null,Dt))this.config.store.delete(t),("NamedNode"===t.object.termType||"BlankNode"===t.object.termType)&&this.removeFromDataGraph(t.object)}};const sy=".editor:not([type='checkbox']) { border: 1px solid #DDD; }\n.property-instance label { display: inline-flex; word-break: break-word; line-height: 1em; padding-top: 0.15em; padding-right: 1em; flex-shrink: 0; position: relative; }\n.property-instance:not(:first-child) > label:not(.persistent) { visibility: hidden; max-height: 0; }\n.mode-edit .property-instance label { width: var(--label-width); }\n";class ay extends zd{constructor(e){super(e||sy),this.idCtr=0}createDefaultTemplate(e,t,n,r,i){r.id="e"+this.idCtr++,r.classList.add("editor"),i?.datatype?r.shaclDatatype=i.datatype:t instanceof ct&&(r.shaclDatatype=t.datatype),void 0!==i?.minCount&&(r.dataset.minCount=String(i.minCount)),i?.class&&(r.dataset.class=i.class.value),i?.nodeKind?r.dataset.nodeKind=i.nodeKind.value:t instanceof vn&&(r.dataset.nodeKind=xe+"IRI"),(i?.hasValue||i?.readonly)&&(r.disabled=!0),r.value=t?.value||i?.defaultValue?.value||"";const s=document.createElement("label");s.htmlFor=r.id,s.innerText=e,i?.description&&s.setAttribute("title",i.description.value);const o=i?.description?i.description.value:i?.pattern?i.pattern:null;o&&r.setAttribute("placeholder",o),n&&(r.setAttribute("required","true"),s.classList.add("required"));const a=document.createElement("div");return a.appendChild(s),a.appendChild(r),a}createDateEditor(e,t,n,r){const i=new Ue;r.datatype?.value===Gt+"dateTime"?(i.type="datetime-local",i.setAttribute("step","1")):i.type="date",i.clearable=!0,i.dense=!0,i.classList.add("pr-0");const s=this.createDefaultTemplate(e,null,n,i,r);if(t)try{let e=new Date(t.value).toISOString();e=r.datatype?.value===Gt+"dateTime"?e.slice(0,19):e.slice(0,10),i.value=e}catch(e){console.error(e,t)}return s}createTextEditor(e,t,n,r){let i;return!1===r.singleLine?(i=new cr,i.resize="auto"):i=new Ue,i.dense=!0,r.pattern&&(i.pattern=r.pattern),r.minLength&&(i.minLength=r.minLength),r.maxLength&&(i.maxLength=r.maxLength),this.createDefaultTemplate(e,t,n,i,r)}createLangStringEditor(e,t,n,r){const i=this.createTextEditor(e,t,n,r),s=i.querySelector(":scope .editor");let o;if(r.languageIn?.length){o=document.createElement("select");for(const e of r.languageIn){const t=document.createElement("option");t.innerText=e.value,o.appendChild(t)}}else o=document.createElement("input"),o.maxLength=5,o.size=5,o.placeholder="lang?";return o.title="Language of the text",o.classList.add("lang-chooser"),o.slot="suffix",o.addEventListener("change",e=>{e.stopPropagation(),s&&(s.dataset.lang=o.value,s.dispatchEvent(new Event("change",{bubbles:!0})))}),t instanceof ct&&(o.value=t.language),s.dataset.lang=o.value,s.appendChild(o),i}createBooleanEditor(e,t,n,r){const i=document.createElement("input");i.type="checkbox",i.classList.add("ml-0");const s=this.createDefaultTemplate(e,null,n,i,r);return i.removeAttribute("required"),s.querySelector(":scope label")?.classList.remove("required"),t instanceof ct&&(i.checked="true"===t.value),s}createFileEditor(e,t,n,r){const i=document.createElement("input");return i.type="file",i.addEventListener("change",e=>{if(i.files?.length){e.stopPropagation();const t=new FileReader;t.readAsDataURL(i.files[0]),t.onload=()=>{i.binaryData=btoa(t.result),i.parentElement?.dispatchEvent(new Event("change",{bubbles:!0}))}}else i.binaryData=void 0}),this.createDefaultTemplate(e,t,n,i,r)}createNumberEditor(e,t,n,r){const i=new Ue;i.type="number",i.clearable=!0,i.dense=!0,i.classList.add("pr-0");const s=void 0!==r.minInclusive?r.minInclusive:void 0!==r.minExclusive?r.minExclusive+1:void 0,o=void 0!==r.maxInclusive?r.maxInclusive:void 0!==r.maxExclusive?r.maxExclusive-1:void 0;return void 0!==s&&(i.min=String(s)),void 0!==o&&(i.max=String(o)),r.datatype?.value!==Gt+"integer"&&(i.step="0.1"),this.createDefaultTemplate(e,t,n,i,r)}createListEditor(e,t,n,r,i){const s=new Ge;s.clearable=!0,s.dense=!0;const o=this.createDefaultTemplate(e,null,n,s,i),a=document.createElement("ul");let l=!0;const c=(e,t)=>{const n=document.createElement("li");if("string"==typeof e.value?(n.dataset.value=e.value,n.innerText=e.label?e.label:e.value):(e.value instanceof ct&&e.value.datatype.equals(Pd)?n.dataset.value=e.value.value:e.value instanceof vn?n.dataset.value="<"+e.value.value+">":n.dataset.value=e.value.id,n.innerText=e.label?e.label:e.value.value),t.appendChild(n),e.children?.length){l=!1;const t=document.createElement("ul");n.appendChild(t);for(const n of e.children)c(n,t)}};for(const e of r)c(e,a);return l||(s.collapse=!0),s.appendChild(a),t&&(s.value=t.value),o}createButton(e,t){const n=document.createElement("button");return n.type="button",n.innerHTML=e,n}}class oy extends iy{constructor(){super(new ay)}}window.customElements.define("shacl-form",oy);export{ou as Config,Wf as Loader,gy as Plugin,oy as ShaclForm,Gd as ShaclPropertyTemplate,zd as Theme,Rn as findLabel,Yd as registerPlugin};